<!DOCTYPE html>
<!-- Generated by Cython 0.29.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: _hole_combine_cython.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.21</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="_hole_combine_cython.c">_hole_combine_cython.c</a></p>
<div class="cython"><pre class="cython line score-0">&#xA0;<span class="">0001</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0002</span>: <span class="k">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0003</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0006</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0010</span>: <span class="n">np</span><span class="o">.</span><span class="n">import_array</span><span class="p">()</span>  <span class="c"># required in order to use C-API</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_5numpy_import_array();<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 10, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>: <span class="k">from</span> <span class="nn">typedefs</span> <span class="k">cimport</span> <span class="n">DTYPE_CP128_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0014</span>:                       <span class="n">DTYPE_CP64_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0015</span>:                       <span class="n">DTYPE_F64_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0016</span>:                       <span class="n">DTYPE_F32_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>:                       <span class="n">DTYPE_B_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0018</span>:                       <span class="n">ITYPE_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>:                       <span class="n">DTYPE_INT32_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>:                       <span class="n">DTYPE_INT64_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>:                       <span class="n">DTYPE_INT8_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>:                       <span class="n">CELL_ID_t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>: <span class="k">from</span> <span class="nn">numpy.math</span> <span class="k">cimport</span> <span class="n">NAN</span><span class="p">,</span> <span class="n">INFINITY</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">fabs</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">asin</span><span class="p">,</span> <span class="n">atan</span><span class="p">,</span> <span class="n">ceil</span><span class="c">#, exp, pow, cos, sin, asin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0028</span>: <span class="k">from</span> <span class="nn">._voidfinder</span> <span class="k">import</span> <span class="n">find_next_prime</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_find_next_prime);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_find_next_prime);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_find_next_prime);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_voidfinder, __pyx_t_1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_find_next_prime);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_find_next_prime, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0029</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: <span class="k">from</span> <span class="nn">._voidfinder_cython_find_next</span> <span class="k">cimport</span> <span class="n">GalaxyMapCustomDict</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>:                                            <span class="n">Cell_ID_Memory</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>:                                            <span class="n">_gen_cube</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>:                                            <span class="n">OffsetNumPair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0037</span>: <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_4 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_4vast_10voidfinder_20_hole_combine_cython_pi = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">0038</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0039</span>: <span class="k">import</span> <span class="nn">time</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_time, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_time, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0040</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0046</span>: <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">remove_duplicates_2</span><span class="p">(</span><span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">x_y_z_r_array</span><span class="p">,</span></pre>
<pre class='cython code score-48 '>static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_1remove_duplicates_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_f_4vast_10voidfinder_20_hole_combine_cython_remove_duplicates_2(__Pyx_memviewslice __pyx_v_x_y_z_r_array, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_tolerance, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_holes;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_last_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_diff[3];
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_last_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_separation;
  PyObject *__pyx_v_out_index = NULL;
  __Pyx_memviewslice __pyx_v_out_index_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("remove_duplicates_2", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.remove_duplicates_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_index);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out_index_memview, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_1remove_duplicates_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4vast_10voidfinder_20_hole_combine_cython_remove_duplicates_2[] = "\n    Description\n    ===========\n    \n    This function is not intuitive - it serves the unique purpose of removing\n    only a small subset of duplicate hole candidates.  It is assumes the\n    x_y_z_r_array is sorted such that the largest hole is at index 0, and we\n    compare pairwise adjacent holes to remove duplicates only from that \n    selection.\n    \n    Note that we do not check for holes which are completely contained within\n    other holes, because the main voidfinder will continue growing any sphere\n    until it is bounded by galaxies - so the only way for a hole to be\n    completely contained within another hole is to have the exact same bounding\n    galaxies - so the centers will have a separation distance of less than\n    the provided tolerance.\n    \n    Parameters\n    ==========\n    \n    x-y_z_r_array : numpy.ndarray of shape (N,4)\n    \n    tolerance : float\n        absolute tolerance (ex: Mpc/h) beyond which holes are \n        considered unique\n    \n    ";
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_1remove_duplicates_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_x_y_z_r_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_tolerance;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("remove_duplicates_2 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x_y_z_r_array,&amp;__pyx_n_s_tolerance,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x_y_z_r_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_tolerance)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("remove_duplicates_2", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "remove_duplicates_2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_x_y_z_r_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x_y_z_r_array.memview)) __PYX_ERR(0, 46, __pyx_L3_error)</span>
    __pyx_v_tolerance = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_tolerance == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("remove_duplicates_2", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.remove_duplicates_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4vast_10voidfinder_20_hole_combine_cython_remove_duplicates_2(__pyx_self, __pyx_v_x_y_z_r_array, __pyx_v_tolerance);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_20_hole_combine_cython_remove_duplicates_2(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_x_y_z_r_array, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_tolerance) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("remove_duplicates_2", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_x_y_z_r_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("x_y_z_r_array"); <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L1_error)</span> }
  __pyx_t_1 = ((PyObject *)__pyx_f_4vast_10voidfinder_20_hole_combine_cython_remove_duplicates_2(__pyx_v_x_y_z_r_array, __pyx_v_tolerance, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.remove_duplicates_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x_y_z_r_array, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0047</span>:                                      <span class="n">DTYPE_F64_t</span> <span class="n">tolerance</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: <span class="sd">    Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: <span class="sd">    ===========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: <span class="sd">    This function is not intuitive - it serves the unique purpose of removing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: <span class="sd">    only a small subset of duplicate hole candidates.  It is assumes the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: <span class="sd">    x_y_z_r_array is sorted such that the largest hole is at index 0, and we</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>: <span class="sd">    compare pairwise adjacent holes to remove duplicates only from that </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0056</span>: <span class="sd">    selection.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0058</span>: <span class="sd">    Note that we do not check for holes which are completely contained within</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>: <span class="sd">    other holes, because the main voidfinder will continue growing any sphere</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0060</span>: <span class="sd">    until it is bounded by galaxies - so the only way for a hole to be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0061</span>: <span class="sd">    completely contained within another hole is to have the exact same bounding</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>: <span class="sd">    galaxies - so the centers will have a separation distance of less than</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0063</span>: <span class="sd">    the provided tolerance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0065</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0066</span>: <span class="sd">    ==========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>: <span class="sd">    x-y_z_r_array : numpy.ndarray of shape (N,4)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>: <span class="sd">    tolerance : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>: <span class="sd">        absolute tolerance (ex: Mpc/h) beyond which holes are </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>: <span class="sd">        considered unique</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0073</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0075</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0076</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">num_holes</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_holes = (__pyx_v_x_y_z_r_array.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0077</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0078</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">idx</span><span class="p">,</span> <span class="nf">last_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0080</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[3] <span class="nf">diff</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">curr_radius</span><span class="p">,</span> <span class="nf">last_radius</span><span class="p">,</span> <span class="nf">separation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0083</span>:     <span class="n">out_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_holes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_holes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out_index = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0084</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0085</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span>[<span class="p">:]</span> <span class="n">out_index_memview</span> <span class="o">=</span> <span class="n">out_index</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t(__pyx_v_out_index, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  __pyx_v_out_index_memview = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0086</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0087</span>:     <span class="n">out_index</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-2 '>  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_out_index, 0, Py_True, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0088</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0089</span>:     <span class="n">last_idx</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_last_idx = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0090</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0091</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0092</span>:     <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">num_holes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_num_holes;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 1; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_idx = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">0093</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0094</span>:         <span class="n">curr_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_idx;
    __pyx_t_11 = 3;
    __pyx_v_curr_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0095</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0096</span>:         <span class="n">last_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">last_idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_last_idx;
    __pyx_t_10 = 3;
    __pyx_v_last_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0097</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0098</span>:         <span class="n">diff</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">last_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_idx;
    __pyx_t_11 = 0;
    __pyx_t_12 = __pyx_v_last_idx;
    __pyx_t_13 = 0;
    (__pyx_v_diff[0]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_12 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_13 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0099</span>:         <span class="n">diff</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">last_idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_idx;
    __pyx_t_12 = 1;
    __pyx_t_11 = __pyx_v_last_idx;
    __pyx_t_10 = 1;
    (__pyx_v_diff[1]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_13 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_12 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0100</span>:         <span class="n">diff</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">last_idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_idx;
    __pyx_t_11 = 2;
    __pyx_t_12 = __pyx_v_last_idx;
    __pyx_t_13 = 2;
    (__pyx_v_diff[2]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_12 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_13 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0101</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0102</span>:         <span class="n">separation</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">diff</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">diff</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">diff</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">diff</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">diff</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>    __pyx_v_separation = sqrt(((((__pyx_v_diff[0]) * (__pyx_v_diff[0])) + ((__pyx_v_diff[1]) * (__pyx_v_diff[1]))) + ((__pyx_v_diff[2]) * (__pyx_v_diff[2]))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0103</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0104</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">separation</span> <span class="o">&gt;</span> <span class="n">tolerance</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">last_radius</span> <span class="o">-</span> <span class="n">curr_radius</span> <span class="o">&gt;</span> <span class="n">tolerance</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = ((__pyx_v_separation &gt; __pyx_v_tolerance) != 0);
    if (!__pyx_t_15) {
    } else {
      __pyx_t_14 = __pyx_t_15;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_15 = (((__pyx_v_last_radius - __pyx_v_curr_radius) &gt; __pyx_v_tolerance) != 0);
    __pyx_t_14 = __pyx_t_15;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_14) {
/* â€¦ */
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0105</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0106</span>:             <span class="n">out_index_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t *) ( /* dim=0 */ (__pyx_v_out_index_memview.data + __pyx_t_13 * __pyx_v_out_index_memview.strides[0]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0107</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0108</span>:             <span class="n">last_idx</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>      __pyx_v_last_idx = __pyx_v_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">0109</span>: </pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0110</span>:     <span class="k">return</span> <span class="n">out_index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_out_index, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0115</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0116</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0118</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0119</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0120</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0121</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0122</span>: <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">cap_height</span><span class="p">(</span><span class="n">DTYPE_F64_t</span> <span class="n">R</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_f_4vast_10voidfinder_20_hole_combine_cython_cap_height(__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_R, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_r, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_d) {
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_h;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cap_height", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0123</span>:                             <span class="n">DTYPE_F64_t</span> <span class="n">r</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0124</span>:                             <span class="n">DTYPE_F64_t</span> <span class="n">d</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0125</span>:     <span class="sd">&#39;&#39;&#39;Calculate the height of a spherical cap.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0126</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0128</span>: <span class="sd">    __________</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0129</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>: <span class="sd">    R : radius of sphere</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>: <span class="sd">    r : radius of other sphere</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0133</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>: <span class="sd">    d : distance between sphere centers</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0135</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0136</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0137</span>: <span class="sd">    Output</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0138</span>: <span class="sd">    ______</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0139</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>: <span class="sd">    h : height of cap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>: <span class="sd">    &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0142</span>:     <span class="sd">&#39;&#39;&#39;for elem in d:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0143</span>: <span class="sd">        if np.isnan(elem) or elem == 0:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0144</span>: <span class="sd">            print(d)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0145</span>: <span class="sd">            print(&#39;:(&#39;)&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0146</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0147</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">h</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0149</span>:     <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">R</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">R</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">d</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_h = ((((__pyx_v_r - __pyx_v_R) + __pyx_v_d) * ((__pyx_v_r + __pyx_v_R) - __pyx_v_d)) / (2.0 * __pyx_v_d));
</pre><pre class="cython line score-0">&#xA0;<span class="">0150</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0151</span>:     <span class="k">return</span> <span class="n">h</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_h;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0152</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0155</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0156</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0157</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0158</span>: <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">spherical_cap_volume</span><span class="p">(</span><span class="n">DTYPE_F64_t</span> <span class="n">radius</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_f_4vast_10voidfinder_20_hole_combine_cython_spherical_cap_volume(__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_radius, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_height) {
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_volume;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("spherical_cap_volume", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0159</span>:                                       <span class="n">DTYPE_F64_t</span> <span class="n">height</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0160</span>:     <span class="sd">&#39;&#39;&#39;Calculate the volume of a spherical cap&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">volume</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0163</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0164</span>:     <span class="n">volume</span> <span class="o">=</span> <span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">height</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">3</span><span class="o">*</span><span class="n">radius</span> <span class="o">-</span> <span class="n">height</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_volume = (((__pyx_v_4vast_10voidfinder_20_hole_combine_cython_pi * pow(__pyx_v_height, 2.0)) * ((3.0 * __pyx_v_radius) - __pyx_v_height)) / 3.);
</pre><pre class="cython line score-0">&#xA0;<span class="">0165</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0166</span>:     <span class="k">return</span> <span class="n">volume</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_volume;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0167</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0168</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0169</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0172</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0173</span>: <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">find_maximals_2</span><span class="p">(</span><span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">x_y_z_r_array</span><span class="p">,</span></pre>
<pre class='cython code score-64 '>static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_3find_maximals_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_f_4vast_10voidfinder_20_hole_combine_cython_find_maximals_2(__Pyx_memviewslice __pyx_v_x_y_z_r_array, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_radius, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_out_maximals_index = NULL;
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_out_index_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_diffs[3];
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_separation;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_maximal_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_cap_height;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_maximal_cap_height;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_overlap_volume;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_sphere_volume_thresh;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_N_voids;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_jdx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_maximal_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_holes;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_is_maximal;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_maximals_2", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.find_maximals_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_maximals_index);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out_index_memview, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_3find_maximals_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4vast_10voidfinder_20_hole_combine_cython_2find_maximals_2[] = "\n    \n    DEPRECATED BY find_maximals_3 REMOVE AFTER TESTING\n    \n    Description\n    ===========\n    \n    Build an array of the indices which correspond to maximal\n    holes in the input x_y_z_r_array.  Since x_y_z_r_array is sorted by radius,\n    we can assume the hole at index 0 is the first maximal hole.\n    \n    Parameters\n    =========\n    \n    x_y_z_r_array : ndarray of shape (N,4)\n        must be sorted such that index 0 corresponds to the largest hole radius.\n        \n    frac : float in [0, 1)\n        any 2 potential maximals which overlap\n        by more than this percentage means the smaller hole will not be\n        considered a maximal\n    \n    min_radius : float\n    \n    \n    Returns\n    =======\n    \n    out_maximals_index : ndarray of shape (N,)\n    ";
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_3find_maximals_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_x_y_z_r_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_radius;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_maximals_2 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x_y_z_r_array,&amp;__pyx_n_s_frac,&amp;__pyx_n_s_min_radius,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x_y_z_r_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_frac)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_maximals_2", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_radius)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_maximals_2", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_maximals_2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_x_y_z_r_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x_y_z_r_array.memview)) __PYX_ERR(0, 173, __pyx_L3_error)</span>
    __pyx_v_frac = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_frac == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L3_error)</span>
    __pyx_v_min_radius = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_min_radius == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 175, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_maximals_2", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.find_maximals_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4vast_10voidfinder_20_hole_combine_cython_2find_maximals_2(__pyx_self, __pyx_v_x_y_z_r_array, __pyx_v_frac, __pyx_v_min_radius);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_20_hole_combine_cython_2find_maximals_2(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_x_y_z_r_array, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_radius) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_maximals_2", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_x_y_z_r_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("x_y_z_r_array"); <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L1_error)</span> }
  __pyx_t_1 = ((PyObject *)__pyx_f_4vast_10voidfinder_20_hole_combine_cython_find_maximals_2(__pyx_v_x_y_z_r_array, __pyx_v_frac, __pyx_v_min_radius, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.find_maximals_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x_y_z_r_array, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0174</span>:                                  <span class="n">DTYPE_F64_t</span> <span class="n">frac</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0175</span>:                                  <span class="n">DTYPE_F64_t</span> <span class="n">min_radius</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0176</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0177</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0178</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0179</span>: <span class="sd">    DEPRECATED BY find_maximals_3 REMOVE AFTER TESTING</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0180</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0181</span>: <span class="sd">    Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0182</span>: <span class="sd">    ===========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0183</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0184</span>: <span class="sd">    Build an array of the indices which correspond to maximal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0185</span>: <span class="sd">    holes in the input x_y_z_r_array.  Since x_y_z_r_array is sorted by radius,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0186</span>: <span class="sd">    we can assume the hole at index 0 is the first maximal hole.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0187</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0188</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0189</span>: <span class="sd">    =========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0190</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0191</span>: <span class="sd">    x_y_z_r_array : ndarray of shape (N,4)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0192</span>: <span class="sd">        must be sorted such that index 0 corresponds to the largest hole radius.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0193</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0194</span>: <span class="sd">    frac : float in [0, 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0195</span>: <span class="sd">        any 2 potential maximals which overlap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0196</span>: <span class="sd">        by more than this percentage means the smaller hole will not be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0197</span>: <span class="sd">        considered a maximal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0198</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0199</span>: <span class="sd">    min_radius : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0200</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0201</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0202</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0203</span>: <span class="sd">    =======</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0204</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0205</span>: <span class="sd">    out_maximals_index : ndarray of shape (N,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0206</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0208</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0209</span>:     <span class="c"># Create the output array and add a memview for fast access to it.  Since</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0210</span>:     <span class="c"># x_y_z_r_array is sorted by size we set the first element to be a maximal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0211</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0212</span>:     <span class="n">out_maximals_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">x_y_z_r_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x_y_z_r_array.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out_maximals_index = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0213</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0214</span>:     <span class="n">out_maximals_index</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_out_maximals_index, 0, __pyx_int_0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 214, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0215</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0216</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">out_index_memview</span> <span class="o">=</span> <span class="n">out_maximals_index</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_v_out_maximals_index, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 216, __pyx_L1_error)</span>
  __pyx_v_out_index_memview = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0217</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0218</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0219</span>:     <span class="c"># Set up some memory, again we have at least 1 maximal to start with</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0220</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0221</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[3] <span class="nf">diffs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0222</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">separation</span><span class="p">,</span> <span class="nf">curr_radius</span><span class="p">,</span> <span class="nf">curr_maximal_radius</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0223</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">curr_cap_height</span><span class="p">,</span> <span class="nf">maximal_cap_height</span><span class="p">,</span> <span class="nf">overlap_volume</span><span class="p">,</span> <span class="nf">curr_sphere_volume_thresh</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">N_voids</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N_voids = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0225</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">idx</span><span class="p">,</span> <span class="nf">jdx</span><span class="p">,</span> <span class="nf">maximal_idx</span><span class="p">,</span> <span class="nf">num_holes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0226</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">is_maximal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0227</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0228</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0229</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0230</span>:     <span class="c"># Iterate through all our holes, starting from index 1 since we assume</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0231</span>:     <span class="c"># index 0 is already a maximal due to sorting.  Check to ensure each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0232</span>:     <span class="c"># hole radius is larger than the minimum size required to be a maximal, and if</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0233</span>:     <span class="c"># it is a candidate, compare it against every existing maximal for overlap, and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>:     <span class="c"># if it doesn&#39;t overlap with any other existing maximals, then it too gets</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0235</span>:     <span class="c"># to be a maximal and is added to the output index. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0236</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0237</span>:     <span class="n">num_holes</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_holes = (__pyx_v_x_y_z_r_array.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0238</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0239</span>:     <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">num_holes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_num_holes;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 1; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_idx = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">0240</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0241</span>:         <span class="k">if</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">min_radius</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_idx;
    __pyx_t_11 = 3;
    __pyx_t_12 = (((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))) &lt;= __pyx_v_min_radius) != 0);
    if (__pyx_t_12) {
/* â€¦ */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0242</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0243</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">0244</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0245</span>:         <span class="n">is_maximal</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>    __pyx_v_is_maximal = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0246</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0247</span>:         <span class="n">curr_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_10 = 3;
    __pyx_v_curr_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0248</span>: </pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0249</span>:         <span class="n">curr_sphere_volume_thresh</span> <span class="o">=</span> <span class="n">frac</span><span class="o">*</span><span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">curr_radius</span><span class="o">*</span><span class="n">curr_radius</span><span class="o">*</span><span class="n">curr_radius</span></pre>
<pre class='cython code score-64 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_frac * (4.0 / 3.0)));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_curr_radius);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_curr_radius);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_curr_radius);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_5); if (unlikely((__pyx_t_13 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 249, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_curr_sphere_volume_thresh = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">0250</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0251</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0252</span>:         <span class="c"># If the current sphere is large enough to be a maximal candidate, compare </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0253</span>:         <span class="c"># it against all the previously marked maximals.  When we compare, we basically</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0254</span>:         <span class="c"># have 3 cases - the centers are very far apart (no overlap)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0255</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0256</span>:         <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_voids</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_N_voids;
    __pyx_t_15 = __pyx_t_14;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
      __pyx_v_jdx = __pyx_t_16;
</pre><pre class="cython line score-0">&#xA0;<span class="">0257</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0258</span>:             <span class="n">maximal_idx</span> <span class="o">=</span> <span class="n">out_maximals_index</span><span class="p">[</span><span class="n">jdx</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_out_maximals_index, __pyx_v_jdx, __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t, 1, __Pyx_PyInt_From_Py_intptr_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_5); if (unlikely((__pyx_t_17 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 258, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_v_maximal_idx = __pyx_t_17;
</pre><pre class="cython line score-0">&#xA0;<span class="">0259</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0260</span>:             <span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_idx;
      __pyx_t_11 = 0;
      __pyx_t_18 = __pyx_v_maximal_idx;
      __pyx_t_19 = 0;
      (__pyx_v_diffs[0]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_18 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_19 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0261</span>:             <span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_idx;
      __pyx_t_18 = 1;
      __pyx_t_11 = __pyx_v_maximal_idx;
      __pyx_t_10 = 1;
      (__pyx_v_diffs[1]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_19 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_18 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0262</span>:             <span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_idx;
      __pyx_t_11 = 2;
      __pyx_t_18 = __pyx_v_maximal_idx;
      __pyx_t_19 = 2;
      (__pyx_v_diffs[2]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_10 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_18 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_19 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0263</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0264</span>:             <span class="n">separation</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>      __pyx_v_separation = sqrt(((((__pyx_v_diffs[0]) * (__pyx_v_diffs[0])) + ((__pyx_v_diffs[1]) * (__pyx_v_diffs[1]))) + ((__pyx_v_diffs[2]) * (__pyx_v_diffs[2]))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0265</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0266</span>:             <span class="n">curr_maximal_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_maximal_idx;
      __pyx_t_18 = 3;
      __pyx_v_curr_maximal_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_19 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_18 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0267</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0268</span>:             <span class="k">if</span> <span class="n">curr_maximal_radius</span> <span class="o">-</span> <span class="n">curr_radius</span> <span class="o">&gt;=</span> <span class="n">separation</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = (((__pyx_v_curr_maximal_radius - __pyx_v_curr_radius) &gt;= __pyx_v_separation) != 0);
      if (__pyx_t_12) {
/* â€¦ */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0269</span>:                 <span class="c">#hole is fully contained in another hole, it is not a maximal</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0270</span>:                 <span class="n">is_maximal</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>        __pyx_v_is_maximal = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0271</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L7_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0272</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0273</span>:             <span class="k">elif</span> <span class="n">curr_maximal_radius</span> <span class="o">+</span> <span class="n">curr_radius</span> <span class="o">&gt;=</span> <span class="n">separation</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = (((__pyx_v_curr_maximal_radius + __pyx_v_curr_radius) &gt;= __pyx_v_separation) != 0);
      if (__pyx_t_12) {
/* â€¦ */
        goto __pyx_L8;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0274</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0275</span>:                 <span class="n">curr_cap_height</span> <span class="o">=</span> <span class="n">cap_height</span><span class="p">(</span><span class="n">curr_radius</span><span class="p">,</span> <span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">separation</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_curr_cap_height = __pyx_f_4vast_10voidfinder_20_hole_combine_cython_cap_height(__pyx_v_curr_radius, __pyx_v_curr_maximal_radius, __pyx_v_separation);
</pre><pre class="cython line score-0">&#xA0;<span class="">0276</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0277</span>:                 <span class="n">maximal_cap_height</span> <span class="o">=</span> <span class="n">cap_height</span><span class="p">(</span><span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">curr_radius</span><span class="p">,</span> <span class="n">separation</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_maximal_cap_height = __pyx_f_4vast_10voidfinder_20_hole_combine_cython_cap_height(__pyx_v_curr_maximal_radius, __pyx_v_curr_radius, __pyx_v_separation);
</pre><pre class="cython line score-0">&#xA0;<span class="">0278</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0279</span>:                 <span class="n">overlap_volume</span> <span class="o">=</span> <span class="n">spherical_cap_volume</span><span class="p">(</span><span class="n">curr_radius</span><span class="p">,</span> <span class="n">curr_cap_height</span><span class="p">)</span> <span class="o">+</span> <span class="n">spherical_cap_volume</span><span class="p">(</span><span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">maximal_cap_height</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_overlap_volume = (__pyx_f_4vast_10voidfinder_20_hole_combine_cython_spherical_cap_volume(__pyx_v_curr_radius, __pyx_v_curr_cap_height) + __pyx_f_4vast_10voidfinder_20_hole_combine_cython_spherical_cap_volume(__pyx_v_curr_maximal_radius, __pyx_v_maximal_cap_height));
</pre><pre class="cython line score-0">&#xA0;<span class="">0280</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0281</span>:                 <span class="k">if</span> <span class="n">overlap_volume</span> <span class="o">&gt;</span> <span class="n">curr_sphere_volume_thresh</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_12 = ((__pyx_v_overlap_volume &gt; __pyx_v_curr_sphere_volume_thresh) != 0);
        if (__pyx_t_12) {
/* â€¦ */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0282</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0283</span>:                     <span class="n">is_maximal</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>          __pyx_v_is_maximal = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0284</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0285</span>:                     <span class="k">break</span></pre>
<pre class='cython code score-0 '>          goto __pyx_L7_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0286</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0287</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0288</span>:                     <span class="c"># Didn&#39;t overlap too much with this maximal, but still</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0289</span>:                     <span class="c"># need to check all the others so keep going</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0290</span>:                     <span class="k">pass</span></pre>
<pre class='cython code score-0 '>        /*else*/ {
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0291</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0292</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0293</span>:                 <span class="c"># Didn&#39;t overlap with this maximal at all, but still need to check</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0294</span>:                 <span class="c"># all the others</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0295</span>:                 <span class="k">pass</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
      }
      __pyx_L8:;
    }
    __pyx_L7_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0296</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0297</span>:         <span class="k">if</span> <span class="n">is_maximal</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = (__pyx_v_is_maximal != 0);
    if (__pyx_t_12) {
/* â€¦ */
    }
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0299</span>:             <span class="c">#out_xyzr_memview[N_voids,:] = x_y_z_r_array[idx,:]</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:             <span class="n">out_maximals_index</span><span class="p">[</span><span class="n">N_voids</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-5 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_idx);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_out_maximals_index, __pyx_v_N_voids, __pyx_t_5, __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t, 1, __Pyx_PyInt_From_Py_intptr_t, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0301</span>:             <span class="n">N_voids</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_N_voids = (__pyx_v_N_voids + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0302</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0303</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0304</span>:     <span class="k">return</span> <span class="n">out_maximals_index</span><span class="p">[</span><span class="mf">0</span><span class="p">:</span><span class="n">N_voids</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_out_maximals_index, 0, __pyx_v_N_voids, NULL, NULL, NULL, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 304, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0306</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0308</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0310</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0311</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0312</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0315</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0316</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0317</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0318</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0319</span>: <span class="k">def</span> <span class="nf">find_maximals_3</span><span class="p">(</span><span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">x_y_z_r_array</span><span class="p">,</span></pre>
<pre class='cython code score-87 '>/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_5find_maximals_3(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4vast_10voidfinder_20_hole_combine_cython_4find_maximals_3[] = "\n    Description\n    ===========\n    \n    Build an array of the indices which correspond to maximal\n    holes in the input x_y_z_r_array.  Since x_y_z_r_array is sorted by radius,\n    we can assume the hole at index 0 is the first maximal hole.\n    \n    \n    Use a 2-pass scheme.  First, just eliminate holes which are too small.\n    \n    \n    Parameters\n    =========\n    \n    x_y_z_r_array : ndarray of shape (N,4)\n        must be sorted such that index 0 corresponds to the largest hole radius.\n        \n    frac : float in [0, 1)\n        any 2 potential maximals which overlap\n        by more than this percentage means the smaller hole will not be\n        considered a maximal\n    \n    min_radius : float\n    \n    \n    Returns\n    =======\n    \n    out_maximals_index : ndarray of shape (N,)\n    ";
static PyMethodDef __pyx_mdef_4vast_10voidfinder_20_hole_combine_cython_5find_maximals_3 = {"find_maximals_3", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_5find_maximals_3, METH_VARARGS|METH_KEYWORDS, __pyx_doc_4vast_10voidfinder_20_hole_combine_cython_4find_maximals_3};
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_5find_maximals_3(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_x_y_z_r_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_radius;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_maximals_3 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x_y_z_r_array,&amp;__pyx_n_s_frac,&amp;__pyx_n_s_min_radius,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x_y_z_r_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_frac)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_maximals_3", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_radius)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_maximals_3", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_maximals_3") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_x_y_z_r_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x_y_z_r_array.memview)) __PYX_ERR(0, 319, __pyx_L3_error)</span>
    __pyx_v_frac = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_frac == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L3_error)</span>
    __pyx_v_min_radius = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_min_radius == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 321, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_maximals_3", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.find_maximals_3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4vast_10voidfinder_20_hole_combine_cython_4find_maximals_3(__pyx_self, __pyx_v_x_y_z_r_array, __pyx_v_frac, __pyx_v_min_radius);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_20_hole_combine_cython_4find_maximals_3(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_x_y_z_r_array, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_radius) {
  PyObject *__pyx_v_out_maximals_index = NULL;
  __Pyx_memviewslice __pyx_v_out_index_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_candidate_maximals_index = NULL;
  __Pyx_memviewslice __pyx_v_candidate_index_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_diffs[3];
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_separation;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_maximal_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_largest_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_twice_largest_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_cap_height;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_maximal_cap_height;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_overlap_volume;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_sphere_volume_thresh;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_N_voids;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_jdx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_kdx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_maximal_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_holes;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_candidates;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_cell_ID_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_is_maximal;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_n_grid_x;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_n_grid_y;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_n_grid_z;
  __pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t __pyx_v_grid_i;
  __pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t __pyx_v_grid_j;
  __pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t __pyx_v_grid_k;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_x;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_y;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_z;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_max_x;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_max_y;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_max_z;
  struct __pyx_t_4vast_10voidfinder_28_voidfinder_cython_find_next_OffsetNumPair __pyx_v_curr_offset_num_pair;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_num_cell_IDs;
  __pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t __pyx_v_id1;
  __pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t __pyx_v_id2;
  __pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t __pyx_v_id3;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_offset;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_num_elements;
  PyObject *__pyx_v_galaxy_map = NULL;
  PyObject *__pyx_v_bin_ID = NULL;
  PyObject *__pyx_v_next_prime = NULL;
  PyObject *__pyx_v_lookup_memory = NULL;
  struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *__pyx_v_new_galaxy_map = NULL;
  PyObject *__pyx_v_curr_pqr = NULL;
  PyObject *__pyx_v_candidate_hole_map_array = NULL;
  __Pyx_memviewslice __pyx_v_candidate_hole_map_array_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory *__pyx_v_cell_ID_mem = NULL;
  PyObject *__pyx_v_reference_cell_ijk = NULL;
  __Pyx_memviewslice __pyx_v_reference_cell_ijk_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_maximals_info = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_maximals_3", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.find_maximals_3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_maximals_index);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_out_index_memview, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidate_maximals_index);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_candidate_index_memview, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_galaxy_map);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bin_ID);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_next_prime);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lookup_memory);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_new_galaxy_map);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_curr_pqr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidate_hole_map_array);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_candidate_hole_map_array_memview, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_cell_ID_mem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_reference_cell_ijk);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_reference_cell_ijk_memview, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_maximals_info);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x_y_z_r_array, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* â€¦ */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(57, __pyx_n_s_x_y_z_r_array, __pyx_n_s_frac, __pyx_n_s_min_radius, __pyx_n_s_out_maximals_index, __pyx_n_s_out_index_memview, __pyx_n_s_candidate_maximals_index, __pyx_n_s_candidate_index_memview, __pyx_n_s_diffs, __pyx_n_s_separation, __pyx_n_s_curr_radius, __pyx_n_s_curr_maximal_radius, __pyx_n_s_largest_radius, __pyx_n_s_twice_largest_radius, __pyx_n_s_curr_cap_height, __pyx_n_s_maximal_cap_height, __pyx_n_s_overlap_volume, __pyx_n_s_curr_sphere_volume_thresh, __pyx_n_s_N_voids, __pyx_n_s_idx, __pyx_n_s_jdx, __pyx_n_s_kdx, __pyx_n_s_maximal_idx, __pyx_n_s_num_holes, __pyx_n_s_num_candidates, __pyx_n_s_cell_ID_idx, __pyx_n_s_is_maximal, __pyx_n_s_n_grid_x, __pyx_n_s_n_grid_y, __pyx_n_s_n_grid_z, __pyx_n_s_grid_i, __pyx_n_s_grid_j, __pyx_n_s_grid_k, __pyx_n_s_min_x, __pyx_n_s_min_y, __pyx_n_s_min_z, __pyx_n_s_max_x, __pyx_n_s_max_y, __pyx_n_s_max_z, __pyx_n_s_curr_offset_num_pair, __pyx_n_s_num_cell_IDs, __pyx_n_s_id1, __pyx_n_s_id2, __pyx_n_s_id3, __pyx_n_s_offset, __pyx_n_s_num_elements, __pyx_n_s_galaxy_map, __pyx_n_s_bin_ID, __pyx_n_s_next_prime, __pyx_n_s_lookup_memory, __pyx_n_s_new_galaxy_map, __pyx_n_s_curr_pqr, __pyx_n_s_candidate_hole_map_array, __pyx_n_s_candidate_hole_map_array_memview, __pyx_n_s_cell_ID_mem, __pyx_n_s_reference_cell_ijk, __pyx_n_s_reference_cell_ijk_memview, __pyx_n_s_maximals_info);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
/* â€¦ */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_4vast_10voidfinder_20_hole_combine_cython_5find_maximals_3, NULL, __pyx_n_s_vast_voidfinder__hole_combine_cy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_find_maximals_3, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__27 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 57, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_hole_combine_cython_pyx, __pyx_n_s_find_maximals_3, 319, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0320</span>:                                  <span class="n">DTYPE_F64_t</span> <span class="n">frac</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0321</span>:                                  <span class="n">DTYPE_F64_t</span> <span class="n">min_radius</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0323</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0324</span>: <span class="sd">    Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0325</span>: <span class="sd">    ===========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0326</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>: <span class="sd">    Build an array of the indices which correspond to maximal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>: <span class="sd">    holes in the input x_y_z_r_array.  Since x_y_z_r_array is sorted by radius,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0329</span>: <span class="sd">    we can assume the hole at index 0 is the first maximal hole.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0330</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0331</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0332</span>: <span class="sd">    Use a 2-pass scheme.  First, just eliminate holes which are too small.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0333</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0334</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0336</span>: <span class="sd">    =========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0337</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0338</span>: <span class="sd">    x_y_z_r_array : ndarray of shape (N,4)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>: <span class="sd">        must be sorted such that index 0 corresponds to the largest hole radius.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0340</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0341</span>: <span class="sd">    frac : float in [0, 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0342</span>: <span class="sd">        any 2 potential maximals which overlap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0343</span>: <span class="sd">        by more than this percentage means the smaller hole will not be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>: <span class="sd">        considered a maximal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0345</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0346</span>: <span class="sd">    min_radius : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0347</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0348</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0349</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0350</span>: <span class="sd">    =======</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0351</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0352</span>: <span class="sd">    out_maximals_index : ndarray of shape (N,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0353</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0354</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0355</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0356</span>:     <span class="c"># Create the output array and add a memview for fast access to it, and an array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>:     <span class="c"># for the candidate maximals who are big enough holes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0358</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0359</span>:     <span class="n">out_maximals_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">x_y_z_r_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x_y_z_r_array.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out_maximals_index = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0360</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0361</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">out_index_memview</span> <span class="o">=</span> <span class="n">out_maximals_index</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_v_out_maximals_index, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  __pyx_v_out_index_memview = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0362</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0363</span>:     <span class="n">candidate_maximals_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">x_y_z_r_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x_y_z_r_array.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_candidate_maximals_index = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0364</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0365</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">candidate_index_memview</span> <span class="o">=</span> <span class="n">candidate_maximals_index</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_v_candidate_maximals_index, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 365, __pyx_L1_error)</span>
  __pyx_v_candidate_index_memview = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0366</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0367</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0368</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0369</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0370</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0371</span>:     <span class="c"># Set up some memory</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0372</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0373</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[3] <span class="nf">diffs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0374</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">separation</span><span class="p">,</span> <span class="nf">curr_radius</span><span class="p">,</span> <span class="nf">curr_maximal_radius</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0375</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">largest_radius</span><span class="p">,</span> <span class="nf">twice_largest_radius</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0376</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">curr_cap_height</span><span class="p">,</span> <span class="nf">maximal_cap_height</span><span class="p">,</span> <span class="nf">overlap_volume</span><span class="p">,</span> <span class="nf">curr_sphere_volume_thresh</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">N_voids</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_N_voids = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0378</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">idx</span><span class="p">,</span> <span class="nf">jdx</span><span class="p">,</span> <span class="nf">kdx</span><span class="p">,</span> <span class="nf">maximal_idx</span><span class="p">,</span> <span class="nf">num_holes</span><span class="p">,</span> <span class="nf">num_candidates</span><span class="p">,</span> <span class="nf">cell_ID_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0379</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">is_maximal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0380</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0381</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0382</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">n_grid_x</span><span class="p">,</span> <span class="nf">n_grid_y</span><span class="p">,</span> <span class="nf">n_grid_z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0383</span>:     <span class="k">cdef</span> <span class="kt">CELL_ID_t</span> <span class="nf">grid_i</span><span class="p">,</span> <span class="nf">grid_j</span><span class="p">,</span> <span class="nf">grid_k</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0384</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0385</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0386</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">min_x</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_v_min_x = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0387</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">min_y</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 0;
  __pyx_t_7 = 1;
  __pyx_v_min_y = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0388</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">min_z</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = 0;
  __pyx_t_8 = 2;
  __pyx_v_min_z = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0389</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0390</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">max_x</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 0;
  __pyx_t_7 = 0;
  __pyx_v_max_x = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0391</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">max_y</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = 0;
  __pyx_t_8 = 1;
  __pyx_v_max_y = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0392</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">max_z</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 0;
  __pyx_t_7 = 2;
  __pyx_v_max_z = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0393</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0394</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0395</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0396</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0397</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0398</span>:     <span class="k">cdef</span> <span class="kt">OffsetNumPair</span> <span class="nf">curr_offset_num_pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0399</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0400</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">num_cell_IDs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0401</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0402</span>:     <span class="k">cdef</span> <span class="kt">CELL_ID_t</span> <span class="nf">id1</span><span class="p">,</span> <span class="nf">id2</span><span class="p">,</span> <span class="nf">id3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0403</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0404</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">offset</span><span class="p">,</span> <span class="nf">num_elements</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0405</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0406</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0407</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0408</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>:     <span class="c"># Take a first pass through all the holes and filter out all the holes which</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0410</span>:     <span class="c"># are too small.  Also grab the largest radius for help building an index </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>:     <span class="c"># structure to help optimize maximal comparisons, and find the coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>:     <span class="c"># of the minimum corner of the candidates to help with that structure</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0414</span>:     <span class="n">num_holes</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_holes = (__pyx_v_x_y_z_r_array.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0415</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0416</span>:     <span class="n">num_candidates</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_candidates = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0417</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0418</span>:     <span class="n">largest_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = 0;
  __pyx_t_8 = 3;
  __pyx_v_largest_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0419</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0420</span>:     <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_holes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_num_holes;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0421</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0422</span>:         <span class="k">if</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">min_radius</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_idx;
    __pyx_t_7 = 3;
    __pyx_t_12 = (((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) ))) &lt;= __pyx_v_min_radius) != 0);
    if (__pyx_t_12) {
/* â€¦ */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0423</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0424</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">0425</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0428</span>:             <span class="n">candidate_index_memview</span><span class="p">[</span><span class="n">num_candidates</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_7 = __pyx_v_num_candidates;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_candidate_index_memview.data + __pyx_t_7 * __pyx_v_candidate_index_memview.strides[0]) )) = __pyx_v_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">0429</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0430</span>:             <span class="n">num_candidates</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_num_candidates = (__pyx_v_num_candidates + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0431</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0432</span>:             <span class="k">if</span> <span class="n">min_x</span> <span class="o">&gt;</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_idx;
      __pyx_t_8 = 0;
      __pyx_t_12 = ((__pyx_v_min_x &gt; (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )))) != 0);
      if (__pyx_t_12) {
/* â€¦ */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0433</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0434</span>:                 <span class="n">min_x</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_8 = __pyx_v_idx;
        __pyx_t_7 = 0;
        __pyx_v_min_x = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0435</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0436</span>:             <span class="k">if</span> <span class="n">min_y</span> <span class="o">&gt;</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_idx;
      __pyx_t_8 = 1;
      __pyx_t_12 = ((__pyx_v_min_y &gt; (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )))) != 0);
      if (__pyx_t_12) {
/* â€¦ */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0437</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0438</span>:                 <span class="n">min_y</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_8 = __pyx_v_idx;
        __pyx_t_7 = 1;
        __pyx_v_min_y = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0439</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0440</span>:             <span class="k">if</span> <span class="n">min_z</span> <span class="o">&gt;</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_idx;
      __pyx_t_8 = 2;
      __pyx_t_12 = ((__pyx_v_min_z &gt; (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )))) != 0);
      if (__pyx_t_12) {
/* â€¦ */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0441</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0442</span>:                 <span class="n">min_z</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_8 = __pyx_v_idx;
        __pyx_t_7 = 2;
        __pyx_v_min_z = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0443</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0444</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0445</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0446</span>:             <span class="k">if</span> <span class="n">max_x</span> <span class="o">&lt;</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_idx;
      __pyx_t_8 = 0;
      __pyx_t_12 = ((__pyx_v_max_x &lt; (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )))) != 0);
      if (__pyx_t_12) {
/* â€¦ */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0447</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0448</span>:                 <span class="n">max_x</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_8 = __pyx_v_idx;
        __pyx_t_7 = 0;
        __pyx_v_max_x = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0449</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:             <span class="k">if</span> <span class="n">max_y</span> <span class="o">&lt;</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_idx;
      __pyx_t_8 = 1;
      __pyx_t_12 = ((__pyx_v_max_y &lt; (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )))) != 0);
      if (__pyx_t_12) {
/* â€¦ */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0451</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:                 <span class="n">max_y</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_8 = __pyx_v_idx;
        __pyx_t_7 = 1;
        __pyx_v_max_y = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0453</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0454</span>:             <span class="k">if</span> <span class="n">max_z</span> <span class="o">&lt;</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_idx;
      __pyx_t_8 = 2;
      __pyx_t_12 = ((__pyx_v_max_z &lt; (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) )))) != 0);
      if (__pyx_t_12) {
/* â€¦ */
      }
    }
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0455</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0456</span>:                 <span class="n">max_z</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_8 = __pyx_v_idx;
        __pyx_t_7 = 2;
        __pyx_v_max_z = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0459</span>:     <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0460</span>: <span class="sd">    print(&quot;num holes: &quot;, num_holes)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0461</span>: <span class="sd">    print(&quot;Num candidates: &quot;, num_candidates)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>: <span class="sd">    print(&quot;largest radius: &quot;, largest_radius)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>: <span class="sd">    print(&quot;Mins: &quot;, min_x, min_y, min_z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>: <span class="sd">    print(&quot;Maxs: &quot;, max_x, max_y, max_z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>: <span class="sd">    &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0466</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0467</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0468</span>:     <span class="c"># Set up a cubical grid based on the galaxy positions with edge length of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>:     <span class="c"># twice the largest sphere radius to help us find maximals we need to do</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0470</span>:     <span class="c"># overlap comparisons on</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0471</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0472</span>:     <span class="n">min_x</span> <span class="o">=</span> <span class="n">min_x</span> <span class="o">-</span> <span class="n">largest_radius</span></pre>
<pre class='cython code score-0 '>  __pyx_v_min_x = (__pyx_v_min_x - __pyx_v_largest_radius);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0473</span>:     <span class="n">min_y</span> <span class="o">=</span> <span class="n">min_y</span> <span class="o">-</span> <span class="n">largest_radius</span></pre>
<pre class='cython code score-0 '>  __pyx_v_min_y = (__pyx_v_min_y - __pyx_v_largest_radius);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0474</span>:     <span class="n">min_z</span> <span class="o">=</span> <span class="n">min_z</span> <span class="o">-</span> <span class="n">largest_radius</span></pre>
<pre class='cython code score-0 '>  __pyx_v_min_z = (__pyx_v_min_z - __pyx_v_largest_radius);
</pre><pre class="cython line score-0">&#xA0;<span class="">0475</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0476</span>:     <span class="n">max_x</span> <span class="o">+=</span> <span class="n">largest_radius</span></pre>
<pre class='cython code score-0 '>  __pyx_v_max_x = (__pyx_v_max_x + __pyx_v_largest_radius);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0477</span>:     <span class="n">max_y</span> <span class="o">+=</span> <span class="n">largest_radius</span></pre>
<pre class='cython code score-0 '>  __pyx_v_max_y = (__pyx_v_max_y + __pyx_v_largest_radius);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0478</span>:     <span class="n">max_z</span> <span class="o">+=</span> <span class="n">largest_radius</span></pre>
<pre class='cython code score-0 '>  __pyx_v_max_z = (__pyx_v_max_z + __pyx_v_largest_radius);
</pre><pre class="cython line score-0">&#xA0;<span class="">0479</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0480</span>:     <span class="n">twice_largest_radius</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">largest_radius</span></pre>
<pre class='cython code score-0 '>  __pyx_v_twice_largest_radius = (2.0 * __pyx_v_largest_radius);
</pre><pre class="cython line score-0">&#xA0;<span class="">0481</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0482</span>:     <span class="n">n_grid_x</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">DTYPE_INT64_t</span><span class="o">&gt;</span><span class="n">ceil</span><span class="p">((</span><span class="n">max_x</span> <span class="o">-</span> <span class="n">min_x</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_grid_x = ((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t)ceil(((__pyx_v_max_x - __pyx_v_min_x) / __pyx_v_twice_largest_radius)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0483</span>:     <span class="n">n_grid_y</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">DTYPE_INT64_t</span><span class="o">&gt;</span><span class="n">ceil</span><span class="p">((</span><span class="n">max_y</span> <span class="o">-</span> <span class="n">min_y</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_grid_y = ((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t)ceil(((__pyx_v_max_y - __pyx_v_min_y) / __pyx_v_twice_largest_radius)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0484</span>:     <span class="n">n_grid_z</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">DTYPE_INT64_t</span><span class="o">&gt;</span><span class="n">ceil</span><span class="p">((</span><span class="n">max_z</span> <span class="o">-</span> <span class="n">min_z</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_grid_z = ((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t)ceil(((__pyx_v_max_z - __pyx_v_min_z) / __pyx_v_twice_largest_radius)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0485</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0486</span>:     <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0487</span>: <span class="sd">    print(&quot;Mins: &quot;, min_x, min_y, min_z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>: <span class="sd">    print(&quot;Maxs: &quot;, max_x, max_y, max_z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>: <span class="sd">    print(&quot;Twice radius: &quot;, twice_largest_radius)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>: <span class="sd">    print(&quot;Grid: &quot;, n_grid_x, n_grid_y, n_grid_z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>: <span class="sd">    &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>:     <span class="c"># Now convert all the candidate galaxies into grid cell locations, using the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>:     <span class="c"># same galaxy_map technique as in the main part of voidfinder, and count how</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>:     <span class="c"># many go into each bin, so we can allocate an array for dynamically updating</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>:     <span class="c"># how many maximals we have when querying the grid</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0500</span>:     <span class="n">galaxy_map</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_galaxy_map = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0501</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0502</span>:     <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_candidates</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_num_candidates;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_jdx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0503</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0504</span>:         <span class="n">idx</span> <span class="o">=</span> <span class="n">candidate_index_memview</span><span class="p">[</span><span class="n">jdx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_jdx;
    __pyx_v_idx = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_candidate_index_memview.data + __pyx_t_7 * __pyx_v_candidate_index_memview.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0505</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0506</span>:         <span class="n">grid_i</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CELL_ID_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_x</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_idx;
    __pyx_t_8 = 0;
    __pyx_v_grid_i = ((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t)(((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) ))) - __pyx_v_min_x) / __pyx_v_twice_largest_radius));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0507</span>:         <span class="n">grid_j</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CELL_ID_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_y</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_idx;
    __pyx_t_7 = 1;
    __pyx_v_grid_j = ((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t)(((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) ))) - __pyx_v_min_y) / __pyx_v_twice_largest_radius));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0508</span>:         <span class="n">grid_k</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CELL_ID_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_z</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_idx;
    __pyx_t_8 = 2;
    __pyx_v_grid_k = ((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t)(((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) ))) - __pyx_v_min_z) / __pyx_v_twice_largest_radius));
</pre><pre class="cython line score-0">&#xA0;<span class="">0509</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0510</span>:         <span class="n">bin_ID</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid_i</span><span class="p">,</span> <span class="n">grid_j</span><span class="p">,</span> <span class="n">grid_k</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_4 = __Pyx_PyInt_From_npy_int16(__pyx_v_grid_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = __Pyx_PyInt_From_npy_int16(__pyx_v_grid_j);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = __Pyx_PyInt_From_npy_int16(__pyx_v_grid_k);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_3);
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bin_ID, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0511</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0512</span>:         <span class="k">if</span> <span class="n">bin_ID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">galaxy_map</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_v_bin_ID, __pyx_v_galaxy_map, Py_NE)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
    __pyx_t_13 = (__pyx_t_12 != 0);
    if (__pyx_t_13) {
/* â€¦ */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0513</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0514</span>:             <span class="n">galaxy_map</span><span class="p">[</span><span class="n">bin_ID</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-5 '>      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_galaxy_map, __pyx_v_bin_ID, __pyx_int_0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 514, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0515</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0516</span>:         <span class="n">galaxy_map</span><span class="p">[</span><span class="n">bin_ID</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-13 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bin_ID);
    __pyx_t_1 = __pyx_v_bin_ID;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_galaxy_map, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_galaxy_map, __pyx_t_1, __pyx_t_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 516, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0517</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>:     <span class="c">#print(&quot;Num non-empty grid cells: &quot;, len(galaxy_map))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0520</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0521</span>:     <span class="n">next_prime</span> <span class="o">=</span> <span class="n">find_next_prime</span><span class="p">(</span><span class="mf">2</span><span class="o">*</span><span class="n">num_candidates</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_find_next_prime);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((2 * __pyx_v_num_candidates));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_next_prime = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0522</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0523</span>:     <span class="n">lookup_memory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">next_prime</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s">&quot;filled_flag&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="p">()),</span> <span class="c">#() indicates scalar, or length 1 shape</span></pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_next_prime);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_next_prime);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_next_prime);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_filled_flag);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_filled_flag);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s_filled_flag);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_empty_tuple);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_empty_tuple);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_empty_tuple);
  __pyx_t_2 = 0;
/* â€¦ */
  __pyx_t_18 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 2, __pyx_t_14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 3, __pyx_t_15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 4, __pyx_t_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_18, 5, __pyx_t_17);
  __pyx_t_4 = 0;
  __pyx_t_2 = 0;
  __pyx_t_14 = 0;
  __pyx_t_15 = 0;
  __pyx_t_16 = 0;
  __pyx_t_17 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_18) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_lookup_memory = __pyx_t_18;
  __pyx_t_18 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0524</span>:                                                 <span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="p">()),</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_p);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_p);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_p);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_empty_tuple);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_empty_tuple);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_empty_tuple);
  __pyx_t_14 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0525</span>:                                                 <span class="p">(</span><span class="s">&quot;q&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="p">()),</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 525, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 525, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 525, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_q);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_q);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_n_s_q);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_empty_tuple);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_empty_tuple);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2, __pyx_empty_tuple);
  __pyx_t_15 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0526</span>:                                                 <span class="p">(</span><span class="s">&quot;r&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="p">()),</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_15, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1, __pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_empty_tuple);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_empty_tuple);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 2, __pyx_empty_tuple);
  __pyx_t_16 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0527</span>:                                                 <span class="p">(</span><span class="s">&quot;offset&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="p">()),</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_16, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_16, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_offset);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_offset);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_n_s_offset);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, __pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_empty_tuple);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_empty_tuple);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 2, __pyx_empty_tuple);
  __pyx_t_17 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0528</span>:                                                 <span class="p">(</span><span class="s">&quot;num_elements&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="p">())])</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_17, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_17, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_num_elements);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_num_elements);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_n_s_num_elements);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_empty_tuple);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_empty_tuple);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 2, __pyx_empty_tuple);
  __pyx_t_18 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0529</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0530</span>:     <span class="n">new_galaxy_map</span> <span class="o">=</span> <span class="n">GalaxyMapCustomDict</span><span class="p">((</span><span class="n">n_grid_x</span><span class="p">,</span> <span class="n">n_grid_y</span><span class="p">,</span> <span class="n">n_grid_z</span><span class="p">),</span></pre>
<pre class='cython code score-19 '>  __pyx_t_18 = __Pyx_PyInt_From_npy_int64(__pyx_v_n_grid_x);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_3 = __Pyx_PyInt_From_npy_int64(__pyx_v_n_grid_y);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyInt_From_npy_int64(__pyx_v_n_grid_z);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_1);
  __pyx_t_18 = 0;
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
/* â€¦ */
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_lookup_memory);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_lookup_memory);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_lookup_memory);
  __pyx_t_5 = 0;
/* â€¦ */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_new_galaxy_map = ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0531</span>:                                          <span class="n">lookup_memory</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0532</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0533</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0534</span>:     <span class="n">offset</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_offset = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0535</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0536</span>:     <span class="k">for</span> <span class="n">curr_pqr</span> <span class="ow">in</span> <span class="n">galaxy_map</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_19 = 0;
  __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_galaxy_map, 1, ((PyObject *)NULL), (&amp;__pyx_t_20), (&amp;__pyx_t_21));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __pyx_t_5 = __pyx_t_1;
  __pyx_t_1 = 0;
  while (1) {
    __pyx_t_22 = __Pyx_dict_iter_next(__pyx_t_5, __pyx_t_20, &amp;__pyx_t_19, &amp;__pyx_t_1, NULL, NULL, __pyx_t_21);
    if (unlikely(__pyx_t_22 == 0)) break;
    if (unlikely(__pyx_t_22 == -1)) <span class='error_goto'>__PYX_ERR(0, 536, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_curr_pqr, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0537</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0538</span>:         <span class="n">new_galaxy_map</span><span class="o">.</span><span class="n">setitem</span><span class="p">(</span><span class="n">curr_pqr</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span></pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_curr_pqr, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_23 = __Pyx_PyInt_As_npy_int16(__pyx_t_1); if (unlikely((__pyx_t_23 == ((npy_int16)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 538, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* â€¦ */
    ((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_v_new_galaxy_map-&gt;__pyx_vtab)-&gt;setitem(__pyx_v_new_galaxy_map, __pyx_t_23, __pyx_t_24, __pyx_t_25, __pyx_v_offset, 0, 0);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0539</span>:                                <span class="n">curr_pqr</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span></pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_curr_pqr, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 539, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_24 = __Pyx_PyInt_As_npy_int16(__pyx_t_1); if (unlikely((__pyx_t_24 == ((npy_int16)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 539, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0540</span>:                                <span class="n">curr_pqr</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_curr_pqr, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_25 = __Pyx_PyInt_As_npy_int16(__pyx_t_1); if (unlikely((__pyx_t_25 == ((npy_int16)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 540, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0541</span>:                                <span class="n">offset</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>:                                <span class="mf">0</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0544</span>:         <span class="n">num_elements</span> <span class="o">=</span> <span class="n">galaxy_map</span><span class="p">[</span><span class="n">curr_pqr</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_galaxy_map, __pyx_v_curr_pqr);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_26 = __Pyx_PyInt_As_npy_int64(__pyx_t_1); if (unlikely((__pyx_t_26 == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 544, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_num_elements = __pyx_t_26;
</pre><pre class="cython line score-0">&#xA0;<span class="">0545</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0546</span>:         <span class="n">offset</span> <span class="o">+=</span> <span class="n">num_elements</span></pre>
<pre class='cython code score-1 '>    __pyx_v_offset = (__pyx_v_offset + __pyx_v_num_elements);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0547</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0550</span>:     <span class="n">candidate_hole_map_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_candidates</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_candidates);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_18, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_18, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_17) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 550, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_candidate_hole_map_array = __pyx_t_17;
  __pyx_t_17 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0551</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0552</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">candidate_hole_map_array_memview</span> <span class="o">=</span> <span class="n">candidate_hole_map_array</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_v_candidate_hole_map_array, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
  __pyx_v_candidate_hole_map_array_memview = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0553</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0554</span>:     <span class="n">cell_ID_mem</span> <span class="o">=</span> <span class="n">Cell_ID_Memory</span><span class="p">(</span><span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory), __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  __pyx_v_cell_ID_mem = ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory *)__pyx_t_17);
  __pyx_t_17 = 0;
/* â€¦ */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_10);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class="cython line score-0">&#xA0;<span class="">0555</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0556</span>:     <span class="n">reference_cell_ijk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_17, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_17, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
/* â€¦ */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_17, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__3, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_v_reference_cell_ijk = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__2);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0">&#xA0;<span class="">0557</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0558</span>:     <span class="k">cdef</span> <span class="kt">CELL_ID_t</span>[<span class="p">:,:]</span> <span class="n">reference_cell_ijk_memview</span> <span class="o">=</span> <span class="n">reference_cell_ijk</span></pre>
<pre class='cython code score-0 '>  __pyx_t_27 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t(__pyx_v_reference_cell_ijk, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_27.memview)) __PYX_ERR(0, 558, __pyx_L1_error)</span>
  __pyx_v_reference_cell_ijk_memview = __pyx_t_27;
  __pyx_t_27.memview = NULL;
  __pyx_t_27.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0559</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>:     <span class="c"># Iterate through all our holes, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0563</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0565</span>:     <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_candidates</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_num_candidates;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_jdx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0566</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0567</span>:         <span class="n">idx</span> <span class="o">=</span> <span class="n">candidate_index_memview</span><span class="p">[</span><span class="n">jdx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_jdx;
    __pyx_v_idx = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_candidate_index_memview.data + __pyx_t_8 * __pyx_v_candidate_index_memview.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0568</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0569</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0570</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>:         <span class="c"># Calculate some properties of the current candidate we&#39;re looking at</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0572</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:         <span class="n">is_maximal</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>    __pyx_v_is_maximal = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0574</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:         <span class="n">curr_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_idx;
    __pyx_t_7 = 3;
    __pyx_v_curr_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0576</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0577</span>:         <span class="n">curr_sphere_volume_thresh</span> <span class="o">=</span> <span class="n">frac</span><span class="o">*</span><span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">curr_radius</span><span class="o">*</span><span class="n">curr_radius</span><span class="o">*</span><span class="n">curr_radius</span></pre>
<pre class='cython code score-0 '>    __pyx_v_curr_sphere_volume_thresh = (((((__pyx_v_frac * (4.0 / 3.0)) * __pyx_v_4vast_10voidfinder_20_hole_combine_cython_pi) * __pyx_v_curr_radius) * __pyx_v_curr_radius) * __pyx_v_curr_radius);
</pre><pre class="cython line score-0">&#xA0;<span class="">0578</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0581</span>:         <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CELL_ID_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_x</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_idx;
    __pyx_t_8 = 0;
    __pyx_t_28 = 0;
    __pyx_t_29 = 0;
    *((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_28 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_29 * __pyx_v_reference_cell_ijk_memview.strides[1]) )) = ((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t)(((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) ))) - __pyx_v_min_x) / __pyx_v_twice_largest_radius));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0582</span>:         <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CELL_ID_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_y</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_idx;
    __pyx_t_7 = 1;
    __pyx_t_29 = 0;
    __pyx_t_28 = 1;
    *((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_29 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_28 * __pyx_v_reference_cell_ijk_memview.strides[1]) )) = ((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t)(((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) ))) - __pyx_v_min_y) / __pyx_v_twice_largest_radius));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0583</span>:         <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CELL_ID_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_z</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_idx;
    __pyx_t_8 = 2;
    __pyx_t_28 = 0;
    __pyx_t_29 = 2;
    *((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_28 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_29 * __pyx_v_reference_cell_ijk_memview.strides[1]) )) = ((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t)(((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) ))) - __pyx_v_min_z) / __pyx_v_twice_largest_radius));
</pre><pre class="cython line score-0">&#xA0;<span class="">0584</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>:         <span class="c"># Generate all the grid cell IDs that could potentially hold conflicting</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>:         <span class="c"># maximals</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0590</span>:         <span class="n">num_cell_IDs</span> <span class="o">=</span> <span class="n">_gen_cube</span><span class="p">(</span><span class="n">reference_cell_ijk_memview</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    __pyx_v_num_cell_IDs = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next__gen_cube(__pyx_v_reference_cell_ijk_memview, 1, __pyx_v_cell_ID_mem, __pyx_v_new_galaxy_map);
</pre><pre class="cython line score-0">&#xA0;<span class="">0591</span>:                                  <span class="mf">1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>:                                  <span class="n">cell_ID_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>:                                  <span class="n">new_galaxy_map</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0595</span>:         <span class="k">for</span> <span class="n">cell_ID_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ITYPE_t</span><span class="o">&gt;</span><span class="n">num_cell_IDs</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_30 = ((__pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t)__pyx_v_num_cell_IDs);
    __pyx_t_31 = __pyx_t_30;
    for (__pyx_t_32 = 0; __pyx_t_32 &lt; __pyx_t_31; __pyx_t_32+=1) {
      __pyx_v_cell_ID_idx = __pyx_t_32;
</pre><pre class="cython line score-0">&#xA0;<span class="">0596</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0597</span>:             <span class="n">id1</span> <span class="o">=</span> <span class="n">cell_ID_mem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="n">cell_ID_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_id1 = (__pyx_v_cell_ID_mem-&gt;data[(3 * __pyx_v_cell_ID_idx)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0598</span>:             <span class="n">id2</span> <span class="o">=</span> <span class="n">cell_ID_mem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="n">cell_ID_idx</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_id2 = (__pyx_v_cell_ID_mem-&gt;data[((3 * __pyx_v_cell_ID_idx) + 1)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0599</span>:             <span class="n">id3</span> <span class="o">=</span> <span class="n">cell_ID_mem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="n">cell_ID_idx</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_id3 = (__pyx_v_cell_ID_mem-&gt;data[((3 * __pyx_v_cell_ID_idx) + 2)]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0600</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0601</span>:             <span class="k">if</span> <span class="ow">not</span> <span class="n">new_galaxy_map</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">id3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = ((!(((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_v_new_galaxy_map-&gt;__pyx_vtab)-&gt;contains(__pyx_v_new_galaxy_map, __pyx_v_id1, __pyx_v_id2, __pyx_v_id3, 0) != 0)) != 0);
      if (__pyx_t_13) {
/* â€¦ */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0602</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0603</span>:                 <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L19_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">0604</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0605</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0607</span>:             <span class="n">curr_offset_num_pair</span> <span class="o">=</span> <span class="n">new_galaxy_map</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">id3</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_curr_offset_num_pair = ((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_v_new_galaxy_map-&gt;__pyx_vtab)-&gt;getitem(__pyx_v_new_galaxy_map, __pyx_v_id1, __pyx_v_id2, __pyx_v_id3, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">0608</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0609</span>:             <span class="n">offset</span> <span class="o">=</span> <span class="n">curr_offset_num_pair</span><span class="o">.</span><span class="n">offset</span></pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_curr_offset_num_pair.offset;
      __pyx_v_offset = __pyx_t_26;
</pre><pre class="cython line score-0">&#xA0;<span class="">0610</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0611</span>:             <span class="n">num_elements</span> <span class="o">=</span> <span class="n">curr_offset_num_pair</span><span class="o">.</span><span class="n">num_elements</span></pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_curr_offset_num_pair.num_elements;
      __pyx_v_num_elements = __pyx_t_26;
</pre><pre class="cython line score-0">&#xA0;<span class="">0612</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0614</span>:             <span class="k">for</span> <span class="n">kdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_elements</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_num_elements;
      __pyx_t_33 = __pyx_t_26;
      for (__pyx_t_34 = 0; __pyx_t_34 &lt; __pyx_t_33; __pyx_t_34+=1) {
        __pyx_v_kdx = __pyx_t_34;
</pre><pre class="cython line score-0">&#xA0;<span class="">0615</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>:                 <span class="n">maximal_idx</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ITYPE_t</span><span class="o">&gt;</span><span class="n">candidate_hole_map_array_memview</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="n">kdx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_35 = (__pyx_v_offset + __pyx_v_kdx);
        __pyx_v_maximal_idx = ((__pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t)(*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_candidate_hole_map_array_memview.data + __pyx_t_35 * __pyx_v_candidate_hole_map_array_memview.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0617</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0618</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0619</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0620</span>:                 <span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_8 = __pyx_v_idx;
        __pyx_t_7 = 0;
        __pyx_t_29 = __pyx_v_maximal_idx;
        __pyx_t_28 = 0;
        (__pyx_v_diffs[0]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_29 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_28 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0621</span>:                 <span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_idx;
        __pyx_t_29 = 1;
        __pyx_t_7 = __pyx_v_maximal_idx;
        __pyx_t_8 = 1;
        (__pyx_v_diffs[1]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_28 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_29 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0622</span>:                 <span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_8 = __pyx_v_idx;
        __pyx_t_7 = 2;
        __pyx_t_29 = __pyx_v_maximal_idx;
        __pyx_t_28 = 2;
        (__pyx_v_diffs[2]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_8 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_7 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_29 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_28 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0623</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0624</span>:                 <span class="n">separation</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>        __pyx_v_separation = sqrt(((((__pyx_v_diffs[0]) * (__pyx_v_diffs[0])) + ((__pyx_v_diffs[1]) * (__pyx_v_diffs[1]))) + ((__pyx_v_diffs[2]) * (__pyx_v_diffs[2]))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0625</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0626</span>:                 <span class="n">curr_maximal_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_maximal_idx;
        __pyx_t_29 = 3;
        __pyx_v_curr_maximal_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_28 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_29 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0627</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>:                 <span class="k">if</span> <span class="n">curr_maximal_radius</span> <span class="o">-</span> <span class="n">curr_radius</span> <span class="o">&gt;=</span> <span class="n">separation</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_13 = (((__pyx_v_curr_maximal_radius - __pyx_v_curr_radius) &gt;= __pyx_v_separation) != 0);
        if (__pyx_t_13) {
/* â€¦ */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0629</span>:                     <span class="c">#hole is fully contained in another hole, it is not a maximal</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0630</span>:                     <span class="n">is_maximal</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>          __pyx_v_is_maximal = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0631</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0632</span>:                     <span class="k">break</span></pre>
<pre class='cython code score-0 '>          goto __pyx_L23_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0633</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0634</span>:                 <span class="k">elif</span> <span class="n">curr_maximal_radius</span> <span class="o">+</span> <span class="n">curr_radius</span> <span class="o">&gt;=</span> <span class="n">separation</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_13 = (((__pyx_v_curr_maximal_radius + __pyx_v_curr_radius) &gt;= __pyx_v_separation) != 0);
        if (__pyx_t_13) {
/* â€¦ */
          goto __pyx_L24;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0635</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0636</span>:                     <span class="n">curr_cap_height</span> <span class="o">=</span> <span class="n">cap_height</span><span class="p">(</span><span class="n">curr_radius</span><span class="p">,</span> <span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">separation</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_curr_cap_height = __pyx_f_4vast_10voidfinder_20_hole_combine_cython_cap_height(__pyx_v_curr_radius, __pyx_v_curr_maximal_radius, __pyx_v_separation);
</pre><pre class="cython line score-0">&#xA0;<span class="">0637</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0638</span>:                     <span class="n">maximal_cap_height</span> <span class="o">=</span> <span class="n">cap_height</span><span class="p">(</span><span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">curr_radius</span><span class="p">,</span> <span class="n">separation</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_maximal_cap_height = __pyx_f_4vast_10voidfinder_20_hole_combine_cython_cap_height(__pyx_v_curr_maximal_radius, __pyx_v_curr_radius, __pyx_v_separation);
</pre><pre class="cython line score-0">&#xA0;<span class="">0639</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0640</span>:                     <span class="n">overlap_volume</span> <span class="o">=</span> <span class="n">spherical_cap_volume</span><span class="p">(</span><span class="n">curr_radius</span><span class="p">,</span> <span class="n">curr_cap_height</span><span class="p">)</span> <span class="o">+</span> <span class="n">spherical_cap_volume</span><span class="p">(</span><span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">maximal_cap_height</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_overlap_volume = (__pyx_f_4vast_10voidfinder_20_hole_combine_cython_spherical_cap_volume(__pyx_v_curr_radius, __pyx_v_curr_cap_height) + __pyx_f_4vast_10voidfinder_20_hole_combine_cython_spherical_cap_volume(__pyx_v_curr_maximal_radius, __pyx_v_maximal_cap_height));
</pre><pre class="cython line score-0">&#xA0;<span class="">0641</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0642</span>:                     <span class="k">if</span> <span class="n">overlap_volume</span> <span class="o">&gt;</span> <span class="n">curr_sphere_volume_thresh</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = ((__pyx_v_overlap_volume &gt; __pyx_v_curr_sphere_volume_thresh) != 0);
          if (__pyx_t_13) {
/* â€¦ */
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">0643</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0644</span>:                         <span class="n">is_maximal</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>            __pyx_v_is_maximal = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0645</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0646</span>:                         <span class="k">break</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L23_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0647</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0648</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0649</span>:                         <span class="c"># Didn&#39;t overlap too much with this maximal, but still</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0650</span>:                         <span class="c"># need to check all the others so keep going</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0651</span>:                         <span class="k">pass</span></pre>
<pre class='cython code score-0 '>          /*else*/ {
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">0652</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0653</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0654</span>:                     <span class="c"># Didn&#39;t overlap with this maximal at all, but still need to check</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>:                     <span class="c"># all the others</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0656</span>:                     <span class="k">pass</span></pre>
<pre class='cython code score-0 '>        /*else*/ {
        }
        __pyx_L24:;
      }
      __pyx_L23_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0657</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0658</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0659</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0660</span>:             <span class="k">if</span> <span class="ow">not</span> <span class="n">is_maximal</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = ((!(__pyx_v_is_maximal != 0)) != 0);
      if (__pyx_t_13) {
/* â€¦ */
      }
      __pyx_L19_continue:;
    }
    __pyx_L20_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0661</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L20_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0662</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0663</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0664</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0665</span>:         <span class="c"># The jth candidate was a maximal!  Add its idx to the output index, update</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0666</span>:         <span class="c"># the number of maximals (N_voids), and also insert this maximal idx into the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0667</span>:         <span class="c"># array holding the lists of maximals which correspond to a given cell</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0668</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0669</span>:         <span class="k">if</span> <span class="n">is_maximal</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = (__pyx_v_is_maximal != 0);
    if (__pyx_t_13) {
/* â€¦ */
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0670</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0671</span>:             <span class="n">out_index_memview</span><span class="p">[</span><span class="n">N_voids</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_29 = __pyx_v_N_voids;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_out_index_memview.data + __pyx_t_29 * __pyx_v_out_index_memview.strides[0]) )) = __pyx_v_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">0672</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0673</span>:             <span class="n">N_voids</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_N_voids = (__pyx_v_N_voids + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0674</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>:             <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0677</span>: <span class="sd">            #Shouldnt need to do this check since our current hole should always</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0678</span>: <span class="sd">            #have a valid grid cell</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0679</span>: <span class="sd">            if not new_galaxy_map.contains(reference_cell_ijk[0,0], </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0680</span>: <span class="sd">                                           reference_cell_ijk[0,1],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0681</span>: <span class="sd">                                           reference_cell_ijk[0,2]):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0682</span>: <span class="sd">                </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0683</span>: <span class="sd">                print(min_x, min_y, min_z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0684</span>: <span class="sd">                </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0685</span>: <span class="sd">                print(x_y_z_r_array[idx,0], x_y_z_r_array[idx,1], x_y_z_r_array[idx,2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0686</span>: <span class="sd">                </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0687</span>: <span class="sd">                raise ValueError(&quot;GalaxymapCustomDict doesnt contain valid key&quot;+str(reference_cell_ijk))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0688</span>: <span class="sd">            &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0690</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0691</span>:             <span class="n">curr_offset_num_pair</span> <span class="o">=</span> <span class="n">new_galaxy_map</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span><span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span></pre>
<pre class='cython code score-0 '>      __pyx_t_29 = 0;
      __pyx_t_28 = 0;
/* â€¦ */
      __pyx_v_curr_offset_num_pair = ((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_v_new_galaxy_map-&gt;__pyx_vtab)-&gt;getitem(__pyx_v_new_galaxy_map, (*((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_29 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_28 * __pyx_v_reference_cell_ijk_memview.strides[1]) ))), (*((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_7 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_8 * __pyx_v_reference_cell_ijk_memview.strides[1]) ))), (*((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_36 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_37 * __pyx_v_reference_cell_ijk_memview.strides[1]) ))), 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0692</span>:                                                           <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = 0;
      __pyx_t_8 = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0693</span>:                                                           <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>      __pyx_t_36 = 0;
      __pyx_t_37 = 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0694</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>:             <span class="n">offset</span> <span class="o">=</span> <span class="n">curr_offset_num_pair</span><span class="o">.</span><span class="n">offset</span></pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_curr_offset_num_pair.offset;
      __pyx_v_offset = __pyx_t_26;
</pre><pre class="cython line score-0">&#xA0;<span class="">0696</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0697</span>:             <span class="n">num_elements</span> <span class="o">=</span> <span class="n">curr_offset_num_pair</span><span class="o">.</span><span class="n">num_elements</span></pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_curr_offset_num_pair.num_elements;
      __pyx_v_num_elements = __pyx_t_26;
</pre><pre class="cython line score-0">&#xA0;<span class="">0698</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0699</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0700</span>:             <span class="n">candidate_hole_map_array_memview</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="n">num_elements</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_26 = (__pyx_v_offset + __pyx_v_num_elements);
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_candidate_hole_map_array_memview.data + __pyx_t_26 * __pyx_v_candidate_hole_map_array_memview.strides[0]) )) = __pyx_v_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">0701</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0702</span>:             <span class="n">new_galaxy_map</span><span class="o">.</span><span class="n">setitem</span><span class="p">(</span><span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">],</span></pre>
<pre class='cython code score-0 '>      __pyx_t_37 = 0;
      __pyx_t_36 = 0;
/* â€¦ */
      ((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_v_new_galaxy_map-&gt;__pyx_vtab)-&gt;setitem(__pyx_v_new_galaxy_map, (*((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_37 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_36 * __pyx_v_reference_cell_ijk_memview.strides[1]) ))), (*((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_8 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_7 * __pyx_v_reference_cell_ijk_memview.strides[1]) ))), (*((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_28 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_29 * __pyx_v_reference_cell_ijk_memview.strides[1]) ))), __pyx_v_offset, (__pyx_v_num_elements + 1), 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0703</span>:                                    <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">],</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = 0;
      __pyx_t_7 = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0704</span>:                                    <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-0 '>      __pyx_t_28 = 0;
      __pyx_t_29 = 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">0705</span>:                                    <span class="n">offset</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>:                                    <span class="n">num_elements</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0708</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0709</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0710</span>:     <span class="n">maximals_info</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;maximals_map&quot;</span> <span class="p">:</span> <span class="n">new_galaxy_map</span><span class="p">,</span></pre>
<pre class='cython code score-7 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_maximals_map, ((PyObject *)__pyx_v_new_galaxy_map)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0711</span>:                    <span class="s">&quot;maximals_cell_array&quot;</span> <span class="p">:</span> <span class="n">candidate_hole_map_array</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_maximals_cell_array, __pyx_v_candidate_hole_map_array) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0712</span>:                    <span class="s">&quot;min_x&quot;</span> <span class="p">:</span> <span class="n">min_x</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_min_x);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 712, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_min_x, __pyx_t_17) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0713</span>:                    <span class="s">&quot;min_y&quot;</span> <span class="p">:</span> <span class="n">min_y</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_min_y);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 713, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_min_y, __pyx_t_17) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0714</span>:                    <span class="s">&quot;min_z&quot;</span> <span class="p">:</span> <span class="n">min_z</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_min_z);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_min_z, __pyx_t_17) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0715</span>:                    <span class="s">&quot;twice_largest_radius&quot;</span> <span class="p">:</span> <span class="n">twice_largest_radius</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_twice_largest_radius);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 715, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_twice_largest_radius, __pyx_t_17) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  __pyx_v_maximals_info = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0716</span>:                   <span class="p">}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0717</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0718</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0719</span>:     <span class="k">return</span> <span class="n">out_maximals_index</span><span class="p">[</span><span class="mf">0</span><span class="p">:</span><span class="n">N_voids</span><span class="p">],</span> <span class="n">maximals_info</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_out_maximals_index, 0, __pyx_v_N_voids, NULL, NULL, NULL, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_maximals_info);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_maximals_info);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1, __pyx_v_maximals_info);
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_17;
  __pyx_t_17 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0720</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0729</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0730</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0731</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0733</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0734</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0735</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0736</span>: <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">find_holes_2</span><span class="p">(</span><span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">x_y_z_r_array</span><span class="p">,</span></pre>
<pre class='cython code score-58 '>static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_7find_holes_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_f_4vast_10voidfinder_20_hole_combine_cython_find_holes_2(__Pyx_memviewslice __pyx_v_x_y_z_r_array, __Pyx_memviewslice __pyx_v_maximals_index, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_jdx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_maximal_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_holes;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_maximals;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_out_holes;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_matches;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_last_maximal_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_diffs[3];
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_separation;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_maximal_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_sphere_volume_thresh;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_cap_height;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_maximal_cap_height;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_overlap_volume;
  CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_is_hole;
  PyObject *__pyx_v_holes_index = NULL;
  PyObject *__pyx_v_flag_column = NULL;
  __Pyx_memviewslice __pyx_v_holes_index_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_flag_column_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_is_maximal_col = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_maximal_IDs = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_out = NULL;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_holes_2", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.find_holes_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_holes_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flag_column);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_holes_index_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_flag_column_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_is_maximal_col, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_maximal_IDs, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_7find_holes_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4vast_10voidfinder_20_hole_combine_cython_6find_holes_2[] = "\n    \n    Rename this to 'build_void_groups'\n    \n    We have found the maximals, so intuitively one might think the 'holes' would\n    just be all the remaining rows in the table.  However, some may be discarded \n    still because they are completely contained within another hole.  Also,\n    the maximals themselves are also holes, so they get included in the \n    holes index.\n    ";
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_7find_holes_2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_x_y_z_r_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_maximals_index = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_holes_2 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x_y_z_r_array,&amp;__pyx_n_s_maximals_index,&amp;__pyx_n_s_frac,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x_y_z_r_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_maximals_index)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_holes_2", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_frac)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_holes_2", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find_holes_2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_x_y_z_r_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x_y_z_r_array.memview)) __PYX_ERR(0, 736, __pyx_L3_error)</span>
    __pyx_v_maximals_index = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_maximals_index.memview)) __PYX_ERR(0, 737, __pyx_L3_error)</span>
    __pyx_v_frac = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_frac == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 738, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_holes_2", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.find_holes_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4vast_10voidfinder_20_hole_combine_cython_6find_holes_2(__pyx_self, __pyx_v_x_y_z_r_array, __pyx_v_maximals_index, __pyx_v_frac);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_20_hole_combine_cython_6find_holes_2(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_x_y_z_r_array, __Pyx_memviewslice __pyx_v_maximals_index, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_holes_2", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_x_y_z_r_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("x_y_z_r_array"); <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_maximals_index.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("maximals_index"); <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L1_error)</span> }
  __pyx_t_1 = ((PyObject *)__pyx_f_4vast_10voidfinder_20_hole_combine_cython_find_holes_2(__pyx_v_x_y_z_r_array, __pyx_v_maximals_index, __pyx_v_frac, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.find_holes_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x_y_z_r_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_maximals_index, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0737</span>:                                             <span class="n">DTYPE_INT64_t</span><span class="p">[:]</span> <span class="n">maximals_index</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0738</span>:                                             <span class="n">DTYPE_F64_t</span> <span class="n">frac</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0739</span>:                                             <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0740</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0741</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0742</span>: <span class="sd">    Rename this to &#39;build_void_groups&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0743</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0744</span>: <span class="sd">    We have found the maximals, so intuitively one might think the &#39;holes&#39; would</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0745</span>: <span class="sd">    just be all the remaining rows in the table.  However, some may be discarded </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0746</span>: <span class="sd">    still because they are completely contained within another hole.  Also,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0747</span>: <span class="sd">    the maximals themselves are also holes, so they get included in the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0748</span>: <span class="sd">    holes index.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0749</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0750</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0751</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">idx</span><span class="p">,</span> <span class="nf">jdx</span><span class="p">,</span> <span class="nf">maximal_idx</span><span class="p">,</span> <span class="nf">num_holes</span><span class="p">,</span> <span class="nf">num_maximals</span><span class="p">,</span> <span class="nf">num_out_holes</span><span class="p">,</span> <span class="nf">num_matches</span><span class="p">,</span> <span class="nf">last_maximal_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0752</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0753</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[3] <span class="nf">diffs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0754</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">separation</span><span class="p">,</span> <span class="nf">curr_radius</span><span class="p">,</span> <span class="nf">curr_maximal_radius</span><span class="p">,</span> <span class="nf">curr_sphere_volume_thresh</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0755</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">curr_cap_height</span><span class="p">,</span> <span class="nf">maximal_cap_height</span><span class="p">,</span> <span class="nf">overlap_volume</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0756</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0757</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">is_hole</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0758</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0759</span>:     <span class="n">num_holes</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_holes = (__pyx_v_x_y_z_r_array.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0760</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0761</span>:     <span class="n">num_maximals</span> <span class="o">=</span> <span class="n">maximals_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_maximals = (__pyx_v_maximals_index.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0762</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0763</span>:     <span class="n">holes_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_holes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_holes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_holes_index = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0764</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0765</span>:     <span class="n">flag_column</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_holes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_holes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_flag_column = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0766</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">holes_index_memview</span> <span class="o">=</span> <span class="n">holes_index</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_v_holes_index, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 767, __pyx_L1_error)</span>
  __pyx_v_holes_index_memview = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0768</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0769</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">flag_column_memview</span> <span class="o">=</span> <span class="n">flag_column</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_v_flag_column, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 769, __pyx_L1_error)</span>
  __pyx_v_flag_column_memview = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0770</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0771</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0772</span>:     <span class="c"># Set up some mappings for convenience</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0773</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span>[<span class="p">:]</span> <span class="n">is_maximal_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_holes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_holes);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_is_maximal_col = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0775</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0776</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">maximal_IDs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_holes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_holes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_maximal_IDs = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0777</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0778</span>:     <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_maximals</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_num_maximals;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_idx = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0779</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0780</span>:         <span class="n">is_maximal_col</span><span class="p">[</span><span class="n">maximals_index</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_12 = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximals_index.data + __pyx_t_11 * __pyx_v_maximals_index.strides[0]) )));
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t *) ( /* dim=0 */ (__pyx_v_is_maximal_col.data + __pyx_t_12 * __pyx_v_is_maximal_col.strides[0]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0781</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0782</span>:         <span class="n">maximal_IDs</span><span class="p">[</span><span class="n">maximals_index</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_12 = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximals_index.data + __pyx_t_11 * __pyx_v_maximals_index.strides[0]) )));
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximal_IDs.data + __pyx_t_12 * __pyx_v_maximal_IDs.strides[0]) )) = __pyx_v_idx;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0783</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0784</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0785</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0786</span>:     <span class="c"># Iterate through all the holes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0788</span>:     <span class="n">num_out_holes</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_out_holes = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0789</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0790</span>:     <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_holes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_num_holes;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_idx = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0791</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0792</span>:         <span class="k">if</span> <span class="n">is_maximal_col</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_13 = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t *) ( /* dim=0 */ (__pyx_v_is_maximal_col.data + __pyx_t_11 * __pyx_v_is_maximal_col.strides[0]) ))) != 0);
    if (__pyx_t_13) {
/* â€¦ */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0793</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0794</span>:             <span class="n">holes_index_memview</span><span class="p">[</span><span class="n">num_out_holes</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_num_out_holes;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_holes_index_memview.data + __pyx_t_11 * __pyx_v_holes_index_memview.strides[0]) )) = __pyx_v_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">0795</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0796</span>:             <span class="n">flag_column_memview</span><span class="p">[</span><span class="n">num_out_holes</span><span class="p">]</span> <span class="o">=</span> <span class="n">maximal_IDs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_idx;
      __pyx_t_14 = __pyx_v_num_out_holes;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_flag_column_memview.data + __pyx_t_14 * __pyx_v_flag_column_memview.strides[0]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximal_IDs.data + __pyx_t_11 * __pyx_v_maximal_IDs.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0797</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0798</span>:             <span class="n">num_out_holes</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_num_out_holes = (__pyx_v_num_out_holes + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0799</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0800</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L5_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">0801</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0802</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0803</span>:         <span class="n">curr_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_14 = 3;
    __pyx_v_curr_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_14 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0804</span>: </pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0805</span>:         <span class="n">curr_sphere_volume_thresh</span> <span class="o">=</span> <span class="n">frac</span><span class="o">*</span><span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">curr_radius</span><span class="o">*</span><span class="n">curr_radius</span><span class="o">*</span><span class="n">curr_radius</span></pre>
<pre class='cython code score-64 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_frac * (4.0 / 3.0)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_curr_radius);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_curr_radius);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_curr_radius);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_15 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_15 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 805, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_curr_sphere_volume_thresh = __pyx_t_15;
</pre><pre class="cython line score-0">&#xA0;<span class="">0806</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0807</span>:         <span class="n">is_hole</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_v_is_hole = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0808</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0809</span>:         <span class="n">num_matches</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_num_matches = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0810</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0811</span>:         <span class="k">for</span> <span class="n">jdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_maximals</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_num_maximals;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
      __pyx_v_jdx = __pyx_t_18;
</pre><pre class="cython line score-0">&#xA0;<span class="">0812</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0813</span>:             <span class="n">maximal_idx</span> <span class="o">=</span> <span class="n">maximals_index</span><span class="p">[</span><span class="n">jdx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_jdx;
      __pyx_v_maximal_idx = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximals_index.data + __pyx_t_14 * __pyx_v_maximals_index.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0814</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0815</span>:             <span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_idx;
      __pyx_t_11 = 0;
      __pyx_t_19 = __pyx_v_maximal_idx;
      __pyx_t_20 = 0;
      (__pyx_v_diffs[0]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_14 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_19 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_20 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0816</span>:             <span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_idx;
      __pyx_t_19 = 1;
      __pyx_t_11 = __pyx_v_maximal_idx;
      __pyx_t_14 = 1;
      (__pyx_v_diffs[1]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_20 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_19 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_14 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0817</span>:             <span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_idx;
      __pyx_t_11 = 2;
      __pyx_t_19 = __pyx_v_maximal_idx;
      __pyx_t_20 = 2;
      (__pyx_v_diffs[2]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_14 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_19 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_20 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0818</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0819</span>:             <span class="n">curr_maximal_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_maximal_idx;
      __pyx_t_19 = 3;
      __pyx_v_curr_maximal_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_20 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_19 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0820</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0822</span>:             <span class="n">separation</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>      __pyx_v_separation = sqrt(((((__pyx_v_diffs[0]) * (__pyx_v_diffs[0])) + ((__pyx_v_diffs[1]) * (__pyx_v_diffs[1]))) + ((__pyx_v_diffs[2]) * (__pyx_v_diffs[2]))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0823</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0824</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0825</span>:             <span class="k">if</span> <span class="p">(</span><span class="n">curr_maximal_radius</span> <span class="o">-</span> <span class="n">curr_radius</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">separation</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = (((__pyx_v_curr_maximal_radius - __pyx_v_curr_radius) &gt;= __pyx_v_separation) != 0);
      if (__pyx_t_13) {
/* â€¦ */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0826</span>:                 <span class="c">#current sphere is completely contained within another,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>:                 <span class="c">#throw it away</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0828</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L9_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0829</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0830</span>:             <span class="k">elif</span> <span class="p">(</span><span class="n">curr_maximal_radius</span> <span class="o">+</span> <span class="n">curr_radius</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">separation</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = (((__pyx_v_curr_maximal_radius + __pyx_v_curr_radius) &gt;= __pyx_v_separation) != 0);
      if (__pyx_t_13) {
/* â€¦ */
      }
    }
    __pyx_L9_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0831</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0832</span>:                 <span class="n">curr_cap_height</span> <span class="o">=</span> <span class="n">cap_height</span><span class="p">(</span><span class="n">curr_radius</span><span class="p">,</span> <span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">separation</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_curr_cap_height = __pyx_f_4vast_10voidfinder_20_hole_combine_cython_cap_height(__pyx_v_curr_radius, __pyx_v_curr_maximal_radius, __pyx_v_separation);
</pre><pre class="cython line score-0">&#xA0;<span class="">0833</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0834</span>:                 <span class="n">maximal_cap_height</span> <span class="o">=</span> <span class="n">cap_height</span><span class="p">(</span><span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">curr_radius</span><span class="p">,</span> <span class="n">separation</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_maximal_cap_height = __pyx_f_4vast_10voidfinder_20_hole_combine_cython_cap_height(__pyx_v_curr_maximal_radius, __pyx_v_curr_radius, __pyx_v_separation);
</pre><pre class="cython line score-0">&#xA0;<span class="">0835</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0836</span>:                 <span class="n">overlap_volume</span> <span class="o">=</span> <span class="n">spherical_cap_volume</span><span class="p">(</span><span class="n">curr_radius</span><span class="p">,</span> <span class="n">curr_cap_height</span><span class="p">)</span> <span class="o">+</span> <span class="n">spherical_cap_volume</span><span class="p">(</span><span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">maximal_cap_height</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_overlap_volume = (__pyx_f_4vast_10voidfinder_20_hole_combine_cython_spherical_cap_volume(__pyx_v_curr_radius, __pyx_v_curr_cap_height) + __pyx_f_4vast_10voidfinder_20_hole_combine_cython_spherical_cap_volume(__pyx_v_curr_maximal_radius, __pyx_v_maximal_cap_height));
</pre><pre class="cython line score-0">&#xA0;<span class="">0837</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0838</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0839</span>:                 <span class="k">if</span> <span class="n">overlap_volume</span> <span class="o">&gt;</span> <span class="n">curr_sphere_volume_thresh</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_13 = ((__pyx_v_overlap_volume &gt; __pyx_v_curr_sphere_volume_thresh) != 0);
        if (__pyx_t_13) {
/* â€¦ */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0840</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0841</span>:                     <span class="n">num_matches</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_v_num_matches = (__pyx_v_num_matches + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0842</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0843</span>:                     <span class="n">last_maximal_idx</span> <span class="o">=</span> <span class="n">maximal_idx</span></pre>
<pre class='cython code score-0 '>          __pyx_v_last_maximal_idx = __pyx_v_maximal_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">0844</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0845</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0846</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0848</span>:         <span class="c"># To match reference implementation, we need to only attach holes who</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0849</span>:         <span class="c"># match up with exactly 1 maximal.  Future schemes may include assigning a hole</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0850</span>:         <span class="c"># who matches more than 1 maximal based on the larger volume overlap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0851</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0852</span>:         <span class="k">if</span> <span class="n">num_matches</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = ((__pyx_v_num_matches == 1) != 0);
    if (__pyx_t_13) {
/* â€¦ */
    }
    __pyx_L5_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0853</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0854</span>:             <span class="n">holes_index_memview</span><span class="p">[</span><span class="n">num_out_holes</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_num_out_holes;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_holes_index_memview.data + __pyx_t_19 * __pyx_v_holes_index_memview.strides[0]) )) = __pyx_v_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">0855</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0856</span>:             <span class="n">flag_column_memview</span><span class="p">[</span><span class="n">num_out_holes</span><span class="p">]</span> <span class="o">=</span> <span class="n">maximal_IDs</span><span class="p">[</span><span class="n">last_maximal_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_last_maximal_idx;
      __pyx_t_20 = __pyx_v_num_out_holes;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_flag_column_memview.data + __pyx_t_20 * __pyx_v_flag_column_memview.strides[0]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximal_IDs.data + __pyx_t_19 * __pyx_v_maximal_IDs.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0857</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0858</span>:             <span class="n">num_out_holes</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_num_out_holes = (__pyx_v_num_out_holes + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0859</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>:     <span class="c"># Cython complained about returning a type (np.ndarray, np.ndarray). instead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>:     <span class="c"># return an (N,2) array since we&#39;re lucky that both return items have the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>:     <span class="c"># same dtype.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0865</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_out_holes</span><span class="p">,</span><span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_out_holes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_2);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0866</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0867</span>:     <span class="n">out</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">holes_index</span><span class="p">[</span><span class="mf">0</span><span class="p">:</span><span class="n">num_out_holes</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_holes_index, 0, __pyx_v_num_out_holes, NULL, NULL, NULL, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* â€¦ */
  __pyx_slice__4 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__4)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_tuple__5, __pyx_t_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__4, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class="cython line score-0">&#xA0;<span class="">0868</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0869</span>:     <span class="n">out</span><span class="p">[:,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag_column</span><span class="p">[</span><span class="mf">0</span><span class="p">:</span><span class="n">num_out_holes</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_flag_column, 0, __pyx_v_num_out_holes, NULL, NULL, NULL, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 869, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_tuple__6, __pyx_t_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 869, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* â€¦ */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__4, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 869, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class="cython line score-0">&#xA0;<span class="">0870</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0871</span>:     <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  if (!(likely(((__pyx_v_out) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_out, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 871, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = ((PyArrayObject *)__pyx_v_out);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0872</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0873</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0874</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0875</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0876</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0879</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0880</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0881</span>: <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">join_holes_to_maximals</span><span class="p">(</span><span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">x_y_z_r_array</span><span class="p">,</span></pre>
<pre class='cython code score-69 '>static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_9join_holes_to_maximals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_f_4vast_10voidfinder_20_hole_combine_cython_join_holes_to_maximals(__Pyx_memviewslice __pyx_v_x_y_z_r_array, __Pyx_memviewslice __pyx_v_maximals_index, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac, PyObject *__pyx_v_maximals_info, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_kdx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_maximal_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_holes;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_maximals;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_out_holes;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_matches;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_last_maximal_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_diffs[3];
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_separation;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_maximal_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_sphere_volume_thresh;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_curr_cap_height;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_maximal_cap_height;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_overlap_volume;
  PyObject *__pyx_v_holes_index = NULL;
  PyObject *__pyx_v_flag_column = NULL;
  __Pyx_memviewslice __pyx_v_holes_index_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_flag_column_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_is_maximal_col = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_maximal_IDs = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_x;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_y;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_z;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_twice_largest_radius;
  struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *__pyx_v_maximals_map = 0;
  __Pyx_memviewslice __pyx_v_maximals_map_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory *__pyx_v_cell_ID_mem = 0;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_cell_ID_idx;
  struct __pyx_t_4vast_10voidfinder_28_voidfinder_cython_find_next_OffsetNumPair __pyx_v_curr_offset_num_pair;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_num_cell_IDs;
  __pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t __pyx_v_id1;
  __pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t __pyx_v_id2;
  __pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t __pyx_v_id3;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_offset;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_num_elements;
  PyObject *__pyx_v_reference_cell_ijk = NULL;
  __Pyx_memviewslice __pyx_v_reference_cell_ijk_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_out = NULL;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("join_holes_to_maximals", 0);
/* â€¦ */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.join_holes_to_maximals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_holes_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flag_column);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_holes_index_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_flag_column_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_is_maximal_col, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_maximal_IDs, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_maximals_map);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_maximals_map_array, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_cell_ID_mem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_reference_cell_ijk);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_reference_cell_ijk_memview, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_9join_holes_to_maximals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4vast_10voidfinder_20_hole_combine_cython_8join_holes_to_maximals[] = "\n    \n    \n    \n    We have found the maximals, so intuitively one might think the 'holes' would\n    just be all the remaining rows in the table.  However, some may be discarded \n    still because they are completely contained within another hole.  Also,\n    the maximals themselves are also holes, so they get included in the \n    holes index.\n    ";
static PyObject *__pyx_pw_4vast_10voidfinder_20_hole_combine_cython_9join_holes_to_maximals(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_x_y_z_r_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_maximals_index = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac;
  PyObject *__pyx_v_maximals_info = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("join_holes_to_maximals (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x_y_z_r_array,&amp;__pyx_n_s_maximals_index,&amp;__pyx_n_s_frac,&amp;__pyx_n_s_maximals_info,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x_y_z_r_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_maximals_index)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("join_holes_to_maximals", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 881, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_frac)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("join_holes_to_maximals", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 881, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_maximals_info)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("join_holes_to_maximals", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 881, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "join_holes_to_maximals") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 881, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_x_y_z_r_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x_y_z_r_array.memview)) __PYX_ERR(0, 881, __pyx_L3_error)</span>
    __pyx_v_maximals_index = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_maximals_index.memview)) __PYX_ERR(0, 882, __pyx_L3_error)</span>
    __pyx_v_frac = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_frac == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 883, __pyx_L3_error)</span>
    __pyx_v_maximals_info = ((PyObject*)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("join_holes_to_maximals", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 881, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.join_holes_to_maximals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_maximals_info), (&amp;PyDict_Type), 1, "maximals_info", 1))) <span class='error_goto'>__PYX_ERR(0, 884, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4vast_10voidfinder_20_hole_combine_cython_8join_holes_to_maximals(__pyx_self, __pyx_v_x_y_z_r_array, __pyx_v_maximals_index, __pyx_v_frac, __pyx_v_maximals_info);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_20_hole_combine_cython_8join_holes_to_maximals(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_x_y_z_r_array, __Pyx_memviewslice __pyx_v_maximals_index, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_frac, PyObject *__pyx_v_maximals_info) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("join_holes_to_maximals", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_x_y_z_r_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("x_y_z_r_array"); <span class='error_goto'>__PYX_ERR(0, 881, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_maximals_index.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("maximals_index"); <span class='error_goto'>__PYX_ERR(0, 881, __pyx_L1_error)</span> }
  __pyx_t_1 = ((PyObject *)__pyx_f_4vast_10voidfinder_20_hole_combine_cython_join_holes_to_maximals(__pyx_v_x_y_z_r_array, __pyx_v_maximals_index, __pyx_v_frac, __pyx_v_maximals_info, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._hole_combine_cython.join_holes_to_maximals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x_y_z_r_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_maximals_index, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0882</span>:                                         <span class="n">DTYPE_INT64_t</span><span class="p">[:]</span> <span class="n">maximals_index</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0883</span>:                                         <span class="n">DTYPE_F64_t</span> <span class="n">frac</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0884</span>:                                         <span class="nb">dict</span> <span class="n">maximals_info</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0885</span>:                                         <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0886</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0887</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0888</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0889</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0890</span>: <span class="sd">    We have found the maximals, so intuitively one might think the &#39;holes&#39; would</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0891</span>: <span class="sd">    just be all the remaining rows in the table.  However, some may be discarded </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0892</span>: <span class="sd">    still because they are completely contained within another hole.  Also,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>: <span class="sd">    the maximals themselves are also holes, so they get included in the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0894</span>: <span class="sd">    holes index.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">idx</span><span class="p">,</span> <span class="nf">jdx</span><span class="p">,</span> <span class="nf">kdx</span><span class="p">,</span> <span class="nf">maximal_idx</span><span class="p">,</span> <span class="nf">num_holes</span><span class="p">,</span> <span class="nf">num_maximals</span><span class="p">,</span> <span class="nf">num_out_holes</span><span class="p">,</span> <span class="nf">num_matches</span><span class="p">,</span> <span class="nf">last_maximal_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0898</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[3] <span class="nf">diffs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">separation</span><span class="p">,</span> <span class="nf">curr_radius</span><span class="p">,</span> <span class="nf">curr_maximal_radius</span><span class="p">,</span> <span class="nf">curr_sphere_volume_thresh</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">curr_cap_height</span><span class="p">,</span> <span class="nf">maximal_cap_height</span><span class="p">,</span> <span class="nf">overlap_volume</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0903</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0904</span>:     <span class="n">num_holes</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_holes = (__pyx_v_x_y_z_r_array.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0905</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0906</span>:     <span class="n">num_maximals</span> <span class="o">=</span> <span class="n">maximals_index</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_maximals = (__pyx_v_maximals_index.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0907</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0908</span>:     <span class="n">holes_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_holes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_holes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_holes_index = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0909</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0910</span>:     <span class="n">flag_column</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_holes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_holes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_flag_column = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0911</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0912</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">holes_index_memview</span> <span class="o">=</span> <span class="n">holes_index</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_v_holes_index, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
  __pyx_v_holes_index_memview = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0913</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0914</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">flag_column_memview</span> <span class="o">=</span> <span class="n">flag_column</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_v_flag_column, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 914, __pyx_L1_error)</span>
  __pyx_v_flag_column_memview = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0915</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0916</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0917</span>:     <span class="c"># Set up some mappings for convenience</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0918</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0919</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span>[<span class="p">:]</span> <span class="n">is_maximal_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_holes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_holes);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 919, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_is_maximal_col = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0920</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0921</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">maximal_IDs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_holes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_holes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 921, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_maximal_IDs = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0922</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0923</span>:     <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_maximals</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_num_maximals;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_idx = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0924</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0925</span>:         <span class="n">is_maximal_col</span><span class="p">[</span><span class="n">maximals_index</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_12 = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximals_index.data + __pyx_t_11 * __pyx_v_maximals_index.strides[0]) )));
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t *) ( /* dim=0 */ (__pyx_v_is_maximal_col.data + __pyx_t_12 * __pyx_v_is_maximal_col.strides[0]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0926</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0927</span>:         <span class="n">maximal_IDs</span><span class="p">[</span><span class="n">maximals_index</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_12 = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximals_index.data + __pyx_t_11 * __pyx_v_maximals_index.strides[0]) )));
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximal_IDs.data + __pyx_t_12 * __pyx_v_maximal_IDs.strides[0]) )) = __pyx_v_idx;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0928</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>:     <span class="c"># Boop Boop a shoop</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0937</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0938</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0939</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">min_x</span> <span class="o">=</span> <span class="n">maximals_info</span><span class="p">[</span><span class="s">&quot;min_x&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>  if (unlikely(__pyx_v_maximals_info == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 939, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_maximals_info, __pyx_n_s_min_x);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 939, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_min_x = __pyx_t_13;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0940</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">min_y</span> <span class="o">=</span> <span class="n">maximals_info</span><span class="p">[</span><span class="s">&quot;min_y&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>  if (unlikely(__pyx_v_maximals_info == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_maximals_info, __pyx_n_s_min_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 940, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 940, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_min_y = __pyx_t_13;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0941</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">min_z</span> <span class="o">=</span> <span class="n">maximals_info</span><span class="p">[</span><span class="s">&quot;min_z&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>  if (unlikely(__pyx_v_maximals_info == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 941, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_maximals_info, __pyx_n_s_min_z);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 941, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_min_z = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">0942</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0943</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">twice_largest_radius</span> <span class="o">=</span> <span class="n">maximals_info</span><span class="p">[</span><span class="s">&quot;twice_largest_radius&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>  if (unlikely(__pyx_v_maximals_info == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 943, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_maximals_info, __pyx_n_s_twice_largest_radius);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 943, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_twice_largest_radius = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">0944</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0945</span>:     <span class="k">cdef</span> <span class="kt">GalaxyMapCustomDict</span> <span class="nf">maximals_map</span> <span class="o">=</span> <span class="n">maximals_info</span><span class="p">[</span><span class="s">&quot;maximals_map&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>  if (unlikely(__pyx_v_maximals_info == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 945, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_maximals_info, __pyx_n_s_maximals_map);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 945, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict))))) <span class='error_goto'>__PYX_ERR(0, 945, __pyx_L1_error)</span>
  __pyx_v_maximals_map = ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0946</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0947</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">maximals_map_array</span> <span class="o">=</span> <span class="n">maximals_info</span><span class="p">[</span><span class="s">&quot;maximals_cell_array&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>  if (unlikely(__pyx_v_maximals_info == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 947, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_maximals_info, __pyx_n_s_maximals_cell_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 947, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_maximals_map_array = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0948</span>:     <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>: <span class="sd">    maximals_info = {&quot;maximals_map&quot; : new_galaxy_map,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>: <span class="sd">                   &quot;maximals_cell_array&quot; : candidate_hole_map_array,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>: <span class="sd">                   &quot;min_x&quot; : min_x,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>: <span class="sd">                   &quot;min_y&quot; : min_y,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>: <span class="sd">                   &quot;min_z&quot; : min_z,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>: <span class="sd">                   &quot;twice_largest_radius&quot; : twice_largest_radius,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>: <span class="sd">                  }</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>: <span class="sd">    &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0958</span>:     <span class="k">cdef</span> <span class="kt">Cell_ID_Memory</span> <span class="nf">cell_ID_mem</span> <span class="o">=</span> <span class="n">Cell_ID_Memory</span><span class="p">(</span><span class="mf">10</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory), __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 958, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_cell_ID_mem = ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0959</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">cell_ID_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>:     <span class="k">cdef</span> <span class="kt">OffsetNumPair</span> <span class="nf">curr_offset_num_pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">num_cell_IDs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>:     <span class="k">cdef</span> <span class="kt">CELL_ID_t</span> <span class="nf">id1</span><span class="p">,</span> <span class="nf">id2</span><span class="p">,</span> <span class="nf">id3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0967</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0968</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">offset</span><span class="p">,</span> <span class="nf">num_elements</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0971</span>:     <span class="n">reference_cell_ijk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_reference_cell_ijk = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0972</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0973</span>:     <span class="k">cdef</span> <span class="kt">CELL_ID_t</span>[<span class="p">:,:]</span> <span class="n">reference_cell_ijk_memview</span> <span class="o">=</span> <span class="n">reference_cell_ijk</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t(__pyx_v_reference_cell_ijk, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 973, __pyx_L1_error)</span>
  __pyx_v_reference_cell_ijk_memview = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0974</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0975</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0976</span>:     <span class="c"># Iterate through all the holes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0977</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0978</span>:     <span class="c">#start_time = time.time()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0979</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0980</span>:     <span class="n">num_out_holes</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_out_holes = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0981</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0982</span>:     <span class="c">#print(&quot;Join holes to maximals&quot;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0983</span>:     <span class="c">#print(&quot;Total num holes: &quot;, num_holes)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>:     <span class="c">#print(&quot;Total num maximals: &quot;, maximals_index.shape[0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0986</span>:     <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_holes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_num_holes;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_idx = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0987</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0990</span>:         <span class="c">#if idx%10000 == 0:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0991</span>:         <span class="c">#    print(&quot;Working: &quot;, idx, &quot;at time: &quot;, time.time() - start_time, flush=True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0992</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0993</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0994</span>:         <span class="k">if</span> <span class="n">is_maximal_col</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_15 = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t *) ( /* dim=0 */ (__pyx_v_is_maximal_col.data + __pyx_t_11 * __pyx_v_is_maximal_col.strides[0]) ))) != 0);
    if (__pyx_t_15) {
/* â€¦ */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0995</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0996</span>:             <span class="n">holes_index_memview</span><span class="p">[</span><span class="n">num_out_holes</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_num_out_holes;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_holes_index_memview.data + __pyx_t_11 * __pyx_v_holes_index_memview.strides[0]) )) = __pyx_v_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">0997</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0998</span>:             <span class="n">flag_column_memview</span><span class="p">[</span><span class="n">num_out_holes</span><span class="p">]</span> <span class="o">=</span> <span class="n">maximal_IDs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_idx;
      __pyx_t_16 = __pyx_v_num_out_holes;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_flag_column_memview.data + __pyx_t_16 * __pyx_v_flag_column_memview.strides[0]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximal_IDs.data + __pyx_t_11 * __pyx_v_maximal_IDs.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0999</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1000</span>:             <span class="n">num_out_holes</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_num_out_holes = (__pyx_v_num_out_holes + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1001</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1002</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L5_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">1003</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1004</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1005</span>:         <span class="n">curr_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_16 = 3;
    __pyx_v_curr_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_16 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1006</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1007</span>:         <span class="n">curr_sphere_volume_thresh</span> <span class="o">=</span> <span class="n">frac</span><span class="o">*</span><span class="p">(</span><span class="mf">4.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">curr_radius</span><span class="o">*</span><span class="n">curr_radius</span><span class="o">*</span><span class="n">curr_radius</span></pre>
<pre class='cython code score-0 '>    __pyx_v_curr_sphere_volume_thresh = (((((__pyx_v_frac * (4.0 / 3.0)) * __pyx_v_4vast_10voidfinder_20_hole_combine_cython_pi) * __pyx_v_curr_radius) * __pyx_v_curr_radius) * __pyx_v_curr_radius);
</pre><pre class="cython line score-0">&#xA0;<span class="">1008</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1009</span>:         <span class="n">num_matches</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_num_matches = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1010</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1013</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1014</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1015</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1016</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1018</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1019</span>:         <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CELL_ID_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_x</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_idx;
    __pyx_t_11 = 0;
    __pyx_t_17 = 0;
    __pyx_t_18 = 0;
    *((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_17 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_18 * __pyx_v_reference_cell_ijk_memview.strides[1]) )) = ((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t)(((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_16 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))) - __pyx_v_min_x) / __pyx_v_twice_largest_radius));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1020</span>:         <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CELL_ID_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_y</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_idx;
    __pyx_t_16 = 1;
    __pyx_t_18 = 0;
    __pyx_t_17 = 1;
    *((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_18 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_17 * __pyx_v_reference_cell_ijk_memview.strides[1]) )) = ((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t)(((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_16 * __pyx_v_x_y_z_r_array.strides[1]) ))) - __pyx_v_min_y) / __pyx_v_twice_largest_radius));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1021</span>:         <span class="n">reference_cell_ijk_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">CELL_ID_t</span><span class="o">&gt;</span><span class="p">((</span><span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">min_z</span><span class="p">)</span><span class="o">/</span><span class="n">twice_largest_radius</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_idx;
    __pyx_t_11 = 2;
    __pyx_t_17 = 0;
    __pyx_t_18 = 2;
    *((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_reference_cell_ijk_memview.data + __pyx_t_17 * __pyx_v_reference_cell_ijk_memview.strides[0]) ) + __pyx_t_18 * __pyx_v_reference_cell_ijk_memview.strides[1]) )) = ((__pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t)(((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_16 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))) - __pyx_v_min_z) / __pyx_v_twice_largest_radius));
</pre><pre class="cython line score-0">&#xA0;<span class="">1022</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1024</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1025</span>:         <span class="c"># Generate all the grid cell IDs that could potentially hold conflicting</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1026</span>:         <span class="c"># maximals</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1027</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1028</span>:         <span class="n">num_cell_IDs</span> <span class="o">=</span> <span class="n">_gen_cube</span><span class="p">(</span><span class="n">reference_cell_ijk_memview</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    __pyx_v_num_cell_IDs = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next__gen_cube(__pyx_v_reference_cell_ijk_memview, 1, __pyx_v_cell_ID_mem, __pyx_v_maximals_map);
</pre><pre class="cython line score-0">&#xA0;<span class="">1029</span>:                                  <span class="mf">1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1030</span>:                                  <span class="n">cell_ID_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1031</span>:                                  <span class="n">maximals_map</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1032</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1033</span>:         <span class="k">for</span> <span class="n">cell_ID_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">&lt;</span><span class="n">ITYPE_t</span><span class="o">&gt;</span><span class="n">num_cell_IDs</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_19 = ((__pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t)__pyx_v_num_cell_IDs);
    __pyx_t_20 = __pyx_t_19;
    for (__pyx_t_21 = 0; __pyx_t_21 &lt; __pyx_t_20; __pyx_t_21+=1) {
      __pyx_v_cell_ID_idx = __pyx_t_21;
</pre><pre class="cython line score-0">&#xA0;<span class="">1034</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1035</span>:             <span class="n">id1</span> <span class="o">=</span> <span class="n">cell_ID_mem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="n">cell_ID_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_id1 = (__pyx_v_cell_ID_mem-&gt;data[(3 * __pyx_v_cell_ID_idx)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1036</span>:             <span class="n">id2</span> <span class="o">=</span> <span class="n">cell_ID_mem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="n">cell_ID_idx</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_id2 = (__pyx_v_cell_ID_mem-&gt;data[((3 * __pyx_v_cell_ID_idx) + 1)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1037</span>:             <span class="n">id3</span> <span class="o">=</span> <span class="n">cell_ID_mem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mf">3</span><span class="o">*</span><span class="n">cell_ID_idx</span><span class="o">+</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_id3 = (__pyx_v_cell_ID_mem-&gt;data[((3 * __pyx_v_cell_ID_idx) + 2)]);
</pre><pre class="cython line score-0">&#xA0;<span class="">1038</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1039</span>:             <span class="k">if</span> <span class="ow">not</span> <span class="n">maximals_map</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">id3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = ((!(((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_v_maximals_map-&gt;__pyx_vtab)-&gt;contains(__pyx_v_maximals_map, __pyx_v_id1, __pyx_v_id2, __pyx_v_id3, 0) != 0)) != 0);
      if (__pyx_t_15) {
/* â€¦ */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1040</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1041</span>:                 <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L8_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">1042</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1043</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1044</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1045</span>:             <span class="n">curr_offset_num_pair</span> <span class="o">=</span> <span class="n">maximals_map</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">id3</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_curr_offset_num_pair = ((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_v_maximals_map-&gt;__pyx_vtab)-&gt;getitem(__pyx_v_maximals_map, __pyx_v_id1, __pyx_v_id2, __pyx_v_id3, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">1046</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1047</span>:             <span class="n">offset</span> <span class="o">=</span> <span class="n">curr_offset_num_pair</span><span class="o">.</span><span class="n">offset</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_curr_offset_num_pair.offset;
      __pyx_v_offset = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">1048</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1049</span>:             <span class="n">num_elements</span> <span class="o">=</span> <span class="n">curr_offset_num_pair</span><span class="o">.</span><span class="n">num_elements</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_curr_offset_num_pair.num_elements;
      __pyx_v_num_elements = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">1050</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1051</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1052</span>:             <span class="k">for</span> <span class="n">kdx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_elements</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_num_elements;
      __pyx_t_22 = __pyx_t_12;
      for (__pyx_t_23 = 0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
        __pyx_v_kdx = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">1053</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1054</span>:                 <span class="n">maximal_idx</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ITYPE_t</span><span class="o">&gt;</span><span class="n">maximals_map_array</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="n">kdx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_24 = (__pyx_v_offset + __pyx_v_kdx);
        __pyx_v_maximal_idx = ((__pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t)(*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximals_map_array.data + __pyx_t_24 * __pyx_v_maximals_map_array.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1055</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1056</span>:                 <span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_11 = __pyx_v_idx;
        __pyx_t_16 = 0;
        __pyx_t_18 = __pyx_v_maximal_idx;
        __pyx_t_17 = 0;
        (__pyx_v_diffs[0]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_16 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_18 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_17 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1057</span>:                 <span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_17 = __pyx_v_idx;
        __pyx_t_18 = 1;
        __pyx_t_16 = __pyx_v_maximal_idx;
        __pyx_t_11 = 1;
        (__pyx_v_diffs[1]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_17 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_18 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_16 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1058</span>:                 <span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_11 = __pyx_v_idx;
        __pyx_t_16 = 2;
        __pyx_t_18 = __pyx_v_maximal_idx;
        __pyx_t_17 = 2;
        (__pyx_v_diffs[2]) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_11 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_16 * __pyx_v_x_y_z_r_array.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_18 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_17 * __pyx_v_x_y_z_r_array.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1059</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1060</span>:                 <span class="n">curr_maximal_radius</span> <span class="o">=</span> <span class="n">x_y_z_r_array</span><span class="p">[</span><span class="n">maximal_idx</span><span class="p">,</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_17 = __pyx_v_maximal_idx;
        __pyx_t_18 = 3;
        __pyx_v_curr_maximal_radius = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_x_y_z_r_array.data + __pyx_t_17 * __pyx_v_x_y_z_r_array.strides[0]) ) + __pyx_t_18 * __pyx_v_x_y_z_r_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1061</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1062</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1063</span>:                 <span class="n">separation</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">diffs</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>        __pyx_v_separation = sqrt(((((__pyx_v_diffs[0]) * (__pyx_v_diffs[0])) + ((__pyx_v_diffs[1]) * (__pyx_v_diffs[1]))) + ((__pyx_v_diffs[2]) * (__pyx_v_diffs[2]))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1065</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1066</span>:                 <span class="k">if</span> <span class="p">(</span><span class="n">curr_maximal_radius</span> <span class="o">-</span> <span class="n">curr_radius</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">separation</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = (((__pyx_v_curr_maximal_radius - __pyx_v_curr_radius) &gt;= __pyx_v_separation) != 0);
        if (__pyx_t_15) {
/* â€¦ */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1067</span>:                     <span class="c">#current sphere is completely contained within another,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1068</span>:                     <span class="c">#throw it away</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1069</span>:                     <span class="k">break</span></pre>
<pre class='cython code score-0 '>          goto __pyx_L12_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1070</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1071</span>:                 <span class="k">elif</span> <span class="p">(</span><span class="n">curr_maximal_radius</span> <span class="o">+</span> <span class="n">curr_radius</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">separation</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = (((__pyx_v_curr_maximal_radius + __pyx_v_curr_radius) &gt;= __pyx_v_separation) != 0);
        if (__pyx_t_15) {
/* â€¦ */
        }
      }
      __pyx_L12_break:;
      __pyx_L8_continue:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1072</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1073</span>:                     <span class="n">curr_cap_height</span> <span class="o">=</span> <span class="n">cap_height</span><span class="p">(</span><span class="n">curr_radius</span><span class="p">,</span> <span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">separation</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_curr_cap_height = __pyx_f_4vast_10voidfinder_20_hole_combine_cython_cap_height(__pyx_v_curr_radius, __pyx_v_curr_maximal_radius, __pyx_v_separation);
</pre><pre class="cython line score-0">&#xA0;<span class="">1074</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1075</span>:                     <span class="n">maximal_cap_height</span> <span class="o">=</span> <span class="n">cap_height</span><span class="p">(</span><span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">curr_radius</span><span class="p">,</span> <span class="n">separation</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_maximal_cap_height = __pyx_f_4vast_10voidfinder_20_hole_combine_cython_cap_height(__pyx_v_curr_maximal_radius, __pyx_v_curr_radius, __pyx_v_separation);
</pre><pre class="cython line score-0">&#xA0;<span class="">1076</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1077</span>:                     <span class="n">overlap_volume</span> <span class="o">=</span> <span class="n">spherical_cap_volume</span><span class="p">(</span><span class="n">curr_radius</span><span class="p">,</span> <span class="n">curr_cap_height</span><span class="p">)</span> <span class="o">+</span> <span class="n">spherical_cap_volume</span><span class="p">(</span><span class="n">curr_maximal_radius</span><span class="p">,</span> <span class="n">maximal_cap_height</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_v_overlap_volume = (__pyx_f_4vast_10voidfinder_20_hole_combine_cython_spherical_cap_volume(__pyx_v_curr_radius, __pyx_v_curr_cap_height) + __pyx_f_4vast_10voidfinder_20_hole_combine_cython_spherical_cap_volume(__pyx_v_curr_maximal_radius, __pyx_v_maximal_cap_height));
</pre><pre class="cython line score-0">&#xA0;<span class="">1078</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1079</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1080</span>:                     <span class="k">if</span> <span class="n">overlap_volume</span> <span class="o">&gt;</span> <span class="n">curr_sphere_volume_thresh</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = ((__pyx_v_overlap_volume &gt; __pyx_v_curr_sphere_volume_thresh) != 0);
          if (__pyx_t_15) {
/* â€¦ */
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1081</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1082</span>:                         <span class="n">num_matches</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>            __pyx_v_num_matches = (__pyx_v_num_matches + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1083</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1084</span>:                         <span class="n">last_maximal_idx</span> <span class="o">=</span> <span class="n">maximal_idx</span></pre>
<pre class='cython code score-0 '>            __pyx_v_last_maximal_idx = __pyx_v_maximal_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">1085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1086</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1087</span>:         <span class="c"># To match reference implementation, we need to only attach holes who</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1088</span>:         <span class="c"># match up with exactly 1 maximal.  Future schemes may include assigning a hole</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1089</span>:         <span class="c"># who matches more than 1 maximal based on the larger volume overlap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1090</span>:         <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1091</span>:         <span class="k">if</span> <span class="n">num_matches</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = ((__pyx_v_num_matches == 1) != 0);
    if (__pyx_t_15) {
/* â€¦ */
    }
    __pyx_L5_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1092</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1093</span>:             <span class="n">holes_index_memview</span><span class="p">[</span><span class="n">num_out_holes</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_num_out_holes;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_holes_index_memview.data + __pyx_t_18 * __pyx_v_holes_index_memview.strides[0]) )) = __pyx_v_idx;
</pre><pre class="cython line score-0">&#xA0;<span class="">1094</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>:             <span class="n">flag_column_memview</span><span class="p">[</span><span class="n">num_out_holes</span><span class="p">]</span> <span class="o">=</span> <span class="n">maximal_IDs</span><span class="p">[</span><span class="n">last_maximal_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_last_maximal_idx;
      __pyx_t_17 = __pyx_v_num_out_holes;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_flag_column_memview.data + __pyx_t_17 * __pyx_v_flag_column_memview.strides[0]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_maximal_IDs.data + __pyx_t_18 * __pyx_v_maximal_IDs.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1096</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1097</span>:             <span class="n">num_out_holes</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_num_out_holes = (__pyx_v_num_out_holes + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1099</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1100</span>:     <span class="c"># Cython complained about returning a type (np.ndarray, np.ndarray). instead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1101</span>:     <span class="c"># return an (N,2) array since we&#39;re lucky that both return items have the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1102</span>:     <span class="c"># same dtype.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1103</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>:     <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_out_holes</span><span class="p">,</span><span class="mf">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_num_out_holes);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_2);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_out = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1105</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1106</span>:     <span class="n">out</span><span class="p">[:,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">holes_index</span><span class="p">[</span><span class="mf">0</span><span class="p">:</span><span class="n">num_out_holes</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_holes_index, 0, __pyx_v_num_out_holes, NULL, NULL, NULL, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_tuple__5, __pyx_t_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1106, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1107</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1108</span>:     <span class="n">out</span><span class="p">[:,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag_column</span><span class="p">[</span><span class="mf">0</span><span class="p">:</span><span class="n">num_out_holes</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_flag_column, 0, __pyx_v_num_out_holes, NULL, NULL, NULL, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_tuple__6, __pyx_t_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1108, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1109</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1110</span>:     <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  if (!(likely(((__pyx_v_out) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_out, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = ((PyArrayObject *)__pyx_v_out);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1112</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1113</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1115</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1116</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1117</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1118</span>: </pre>
</div></body></html>
