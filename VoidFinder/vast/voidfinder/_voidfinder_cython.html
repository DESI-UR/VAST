<!DOCTYPE html>
<!-- Generated by Cython 0.29.21 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: _voidfinder_cython.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.21</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="_voidfinder_cython.c">_voidfinder_cython.c</a></p>
<div class="cython"><pre class="cython line score-0">&#xA0;<span class="">0001</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0006</span>: <span class="k">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0010</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0014</span>: <span class="n">np</span><span class="o">.</span><span class="n">import_array</span><span class="p">()</span>  <span class="c"># required in order to use C-API</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_5numpy_import_array();<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 14, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0015</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0016</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>: <span class="k">from</span> <span class="nn">typedefs</span> <span class="k">cimport</span> <span class="n">DTYPE_CP128_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0018</span>:                       <span class="n">DTYPE_CP64_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>:                       <span class="n">DTYPE_F64_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>:                       <span class="n">DTYPE_F32_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>:                       <span class="n">DTYPE_B_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>:                       <span class="n">ITYPE_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>:                       <span class="n">DTYPE_INT32_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>:                       <span class="n">DTYPE_INT64_t</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>:                       <span class="n">DTYPE_INT8_t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: <span class="k">from</span> <span class="nn">numpy.math</span> <span class="k">cimport</span> <span class="n">NAN</span><span class="p">,</span> <span class="n">INFINITY</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0029</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">fabs</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">asin</span><span class="p">,</span> <span class="n">atan</span><span class="c">#, exp, pow, cos, sin, asin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>: <span class="k">from</span> <span class="nn">_voidfinder_cython_find_next</span> <span class="k">cimport</span> <span class="n">find_next_galaxy</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>:                                           <span class="n">not_in_mask</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>:                                           <span class="n">_query_first</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>:                                           <span class="n">DistIdxPair</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>:                                           <span class="n">Cell_ID_Memory</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>:                                           <span class="n">GalaxyMapCustomDict</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>:                                           <span class="n">HoleGridCustomDict</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>:                                           <span class="n">FindNextReturnVal</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>:                                           <span class="n">NeighborMemory</span><span class="p">,</span> \</pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>:                                           <span class="n">MaskChecker</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0043</span>: <span class="k">import</span> <span class="nn">time</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_time, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_time, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0044</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="c">#Create a typedef for the type of pointer which can point</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>: <span class="c">#to the mask check function</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0048</span>: <span class="k">ctypedef</span> <span class="n">DTYPE_B_t</span> <span class="p">(</span><span class="o">*</span><span class="n">MASK_CHECK_FUNCTION_t</span><span class="p">)(</span><span class="n">DTYPE_F64_t</span><span class="p">[:,:],</span> <span class="n">DTYPE_B_t</span><span class="p">[:,:],</span> <span class="n">DTYPE_INT32_t</span><span class="p">,</span> <span class="n">DTYPE_F64_t</span><span class="p">,</span> <span class="n">DTYPE_F64_t</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t (*__pyx_t_4vast_10voidfinder_18_voidfinder_cython_MASK_CHECK_FUNCTION_t)(__Pyx_memviewslice, __Pyx_memviewslice, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT32_t, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">0049</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0055</span>: <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">test_function_woo</span><span class="p">(</span><span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">a</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_f_4vast_10voidfinder_18_voidfinder_cython_test_function_woo(CYTHON_UNUSED __Pyx_memviewslice __pyx_v_a, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_b, CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT32_t __pyx_v_c, CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_d, CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_e) {
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("test_function_woo", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0056</span>:                                  <span class="n">DTYPE_B_t</span><span class="p">[:,:]</span> <span class="n">b</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>:                                  <span class="n">DTYPE_INT32_t</span> <span class="n">c</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0058</span>:                                  <span class="n">DTYPE_F64_t</span> <span class="n">d</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>:                                  <span class="n">DTYPE_F64_t</span> <span class="n">e</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0060</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0061</span>:     <span class="k">return</span> <span class="o">&lt;</span><span class="n">DTYPE_B_t</span><span class="o">&gt;</span><span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t)0);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0063</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0065</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0072</span>: <span class="k">cpdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">fill_ijk_zig_zag</span><span class="p">(</span><span class="n">DTYPE_INT64_t</span><span class="p">[:,:]</span> <span class="n">i_j_k_array</span><span class="p">,</span></pre>
<pre class='cython code score-87 '>static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_1fill_ijk_zig_zag(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_f_4vast_10voidfinder_18_voidfinder_cython_fill_ijk_zig_zag(__Pyx_memviewslice __pyx_v_i_j_k_array, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_start_idx, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_batch_size, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i_lim, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j_lim, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k_lim, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *__pyx_v_cell_ID_dict, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_remainder;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT8_t __pyx_v_i_mod;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT8_t __pyx_v_j_mod;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_num_out;
  CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_num_attempt;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_skip_this_index;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fill_ijk_zig_zag", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_1fill_ijk_zig_zag(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4vast_10voidfinder_18_voidfinder_cython_fill_ijk_zig_zag[] = "\n    Description\n    ===========\n    \n    Given a starting index and a batch size, generate and fill in the (i,j,k) coordinates\n    into the provided i_j_k_array.\n    \n    This version of fill_ijk goes in zigzag/snake order in an attempt to preserve spatial locality of\n    the array data while processing.  That is to say, on a 3x3 grid, this functions goes:\n    (0,0,0), (0,0,1), (0,0,2), (0,1,2), (0,1,1), (0,1,0), (0,2,0), ...\n    whaeras a normal ordering would be:\n    (0,0,0), (0,0,1), (0,0,2), (0,1,0), (0,1,1), (0,1,2), (0,2,0)\n    so that the next cell grid returned is always adjacent to both its predecessor and\n    its antecedent\n    \n    Also filter out cell IDs which we don't want to grow a hole in (since there are galaxies\n    there) using the cell_ID_dict.\n    \n    \n    \n    Parameters\n    ==========\n    \n    i_j_k_array : memoryview onto a numpy array of shape (N, 3) where N is &gt;= batch_size\n        the array to fill in result values into\n        \n    start_idx : int\n        the sequential index into the grid to start at\n        \n    batch_size : int\n        the maximum number of (i,j,k) triplets to write\n    \n    i_lim, j_lim, k_lim : int\n        the number of cells in each i,j,k direction of the grid we're searching\n        \n    cell_ID_dict : custom dictionary/hash table\n        provides a contains() method that can check if a grid cell is in the\n        galaxy map\n        \n    Output\n    ======\n    \n    Writes i-j-k triplets into the i_j_k_array memory\n    \n    \n    Notes\n    =====\n    We are given a block of batch_size indices to attempt to put\n    into the ijk array.  In order to stay synced with the main\n    process-shared counter, we can ONLY return indices from this block\n    of batch_size.  This means we have 'batch_size' chances to generate\n    a cell ID, NOT that we have to generate until we get 'batch_size'\n    results.\n    \n    \n    ";
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_1fill_ijk_zig_zag(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_i_j_k_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_start_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_batch_size;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i_lim;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j_lim;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k_lim;
  struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *__pyx_v_cell_ID_dict = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fill_ijk_zig_zag (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_i_j_k_array,&amp;__pyx_n_s_start_idx,&amp;__pyx_n_s_batch_size,&amp;__pyx_n_s_i_lim,&amp;__pyx_n_s_j_lim,&amp;__pyx_n_s_k_lim,&amp;__pyx_n_s_cell_ID_dict,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_i_j_k_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_start_idx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk_zig_zag", 1, 7, 7, 1); <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_batch_size)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk_zig_zag", 1, 7, 7, 2); <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_i_lim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk_zig_zag", 1, 7, 7, 3); <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_j_lim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk_zig_zag", 1, 7, 7, 4); <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_k_lim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk_zig_zag", 1, 7, 7, 5); <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cell_ID_dict)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk_zig_zag", 1, 7, 7, 6); <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fill_ijk_zig_zag") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_i_j_k_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_i_j_k_array.memview)) __PYX_ERR(0, 72, __pyx_L3_error)</span>
    __pyx_v_start_idx = __Pyx_PyInt_As_npy_int64(values[1]); if (unlikely((__pyx_v_start_idx == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 73, __pyx_L3_error)</span>
    __pyx_v_batch_size = __Pyx_PyInt_As_npy_int64(values[2]); if (unlikely((__pyx_v_batch_size == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 74, __pyx_L3_error)</span>
    __pyx_v_i_lim = __Pyx_PyInt_As_npy_int64(values[3]); if (unlikely((__pyx_v_i_lim == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 75, __pyx_L3_error)</span>
    __pyx_v_j_lim = __Pyx_PyInt_As_npy_int64(values[4]); if (unlikely((__pyx_v_j_lim == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 76, __pyx_L3_error)</span>
    __pyx_v_k_lim = __Pyx_PyInt_As_npy_int64(values[5]); if (unlikely((__pyx_v_k_lim == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 77, __pyx_L3_error)</span>
    __pyx_v_cell_ID_dict = ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *)values[6]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk_zig_zag", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.fill_ijk_zig_zag", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_cell_ID_dict), __pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict, 1, "cell_ID_dict", 0))) <span class='error_goto'>__PYX_ERR(0, 78, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4vast_10voidfinder_18_voidfinder_cython_fill_ijk_zig_zag(__pyx_self, __pyx_v_i_j_k_array, __pyx_v_start_idx, __pyx_v_batch_size, __pyx_v_i_lim, __pyx_v_j_lim, __pyx_v_k_lim, __pyx_v_cell_ID_dict);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_18_voidfinder_cython_fill_ijk_zig_zag(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_i_j_k_array, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_start_idx, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_batch_size, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i_lim, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j_lim, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k_lim, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *__pyx_v_cell_ID_dict) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fill_ijk_zig_zag", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_i_j_k_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("i_j_k_array"); <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_PyInt_From_npy_int64(__pyx_f_4vast_10voidfinder_18_voidfinder_cython_fill_ijk_zig_zag(__pyx_v_i_j_k_array, __pyx_v_start_idx, __pyx_v_batch_size, __pyx_v_i_lim, __pyx_v_j_lim, __pyx_v_k_lim, __pyx_v_cell_ID_dict, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.fill_ijk_zig_zag", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_i_j_k_array, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0073</span>:                                      <span class="n">DTYPE_INT64_t</span> <span class="n">start_idx</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>:                                      <span class="n">DTYPE_INT64_t</span> <span class="n">batch_size</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0075</span>:                                      <span class="n">DTYPE_INT64_t</span> <span class="n">i_lim</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0076</span>:                                      <span class="n">DTYPE_INT64_t</span> <span class="n">j_lim</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>:                                      <span class="n">DTYPE_INT64_t</span> <span class="n">k_lim</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0078</span>:                                      <span class="n">HoleGridCustomDict</span> <span class="n">cell_ID_dict</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0079</span>:                                      <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0080</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>: <span class="sd">    Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>: <span class="sd">    ===========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0083</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0084</span>: <span class="sd">    Given a starting index and a batch size, generate and fill in the (i,j,k) coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>: <span class="sd">    into the provided i_j_k_array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0087</span>: <span class="sd">    This version of fill_ijk goes in zigzag/snake order in an attempt to preserve spatial locality of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0088</span>: <span class="sd">    the array data while processing.  That is to say, on a 3x3 grid, this functions goes:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0089</span>: <span class="sd">    (0,0,0), (0,0,1), (0,0,2), (0,1,2), (0,1,1), (0,1,0), (0,2,0), ...</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0090</span>: <span class="sd">    whaeras a normal ordering would be:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0091</span>: <span class="sd">    (0,0,0), (0,0,1), (0,0,2), (0,1,0), (0,1,1), (0,1,2), (0,2,0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0092</span>: <span class="sd">    so that the next cell grid returned is always adjacent to both its predecessor and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0093</span>: <span class="sd">    its antecedent</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0094</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0095</span>: <span class="sd">    Also filter out cell IDs which we don&#39;t want to grow a hole in (since there are galaxies</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>: <span class="sd">    there) using the cell_ID_dict.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0097</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0098</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0099</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0100</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0101</span>: <span class="sd">    ==========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0102</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0103</span>: <span class="sd">    i_j_k_array : memoryview onto a numpy array of shape (N, 3) where N is &gt;= batch_size</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0104</span>: <span class="sd">        the array to fill in result values into</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0105</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0106</span>: <span class="sd">    start_idx : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0107</span>: <span class="sd">        the sequential index into the grid to start at</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0108</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0109</span>: <span class="sd">    batch_size : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0110</span>: <span class="sd">        the maximum number of (i,j,k) triplets to write</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0111</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: <span class="sd">    i_lim, j_lim, k_lim : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>: <span class="sd">        the number of cells in each i,j,k direction of the grid we&#39;re searching</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0114</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0115</span>: <span class="sd">    cell_ID_dict : custom dictionary/hash table</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0116</span>: <span class="sd">        provides a contains() method that can check if a grid cell is in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>: <span class="sd">        galaxy map</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0118</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0119</span>: <span class="sd">    Output</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0120</span>: <span class="sd">    ======</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0121</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0122</span>: <span class="sd">    Writes i-j-k triplets into the i_j_k_array memory</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0123</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0124</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0125</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0126</span>: <span class="sd">    =====</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>: <span class="sd">    We are given a block of batch_size indices to attempt to put</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0128</span>: <span class="sd">    into the ijk array.  In order to stay synced with the main</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0129</span>: <span class="sd">    process-shared counter, we can ONLY return indices from this block</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>: <span class="sd">    of batch_size.  This means we have &#39;batch_size&#39; chances to generate</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>: <span class="sd">    a cell ID, NOT that we have to generate until we get &#39;batch_size&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>: <span class="sd">    results.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0133</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0135</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0136</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0137</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0138</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">remainder</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0139</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT8_t</span> <span class="nf">i_mod</span><span class="p">,</span> <span class="nf">j_mod</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0142</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">num_out</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_out = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0143</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0144</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">num_attempt</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_attempt = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0145</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0146</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">skip_this_index</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>:     <span class="c"># Make batch_size attempts, filtered by the cell_ID_dict.  Given the sequential</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>:     <span class="c"># &#39;start_idx&#39;, convert into an i,j,k location.  To zig-zag, we</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0151</span>:     <span class="c"># use the modulus of the 3 ijk values in order to convert from moving in a </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>:     <span class="c"># positive direction to a negative direction.  For example, if i=0 and j=0,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>:     <span class="c"># k moves in the &quot;positive&quot; direction, but if i=0 and j=1, k moves in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>:     <span class="c"># &quot;negative&quot; direction.  But if i=1 and j=1, k moves in the &quot;positive&quot; direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0155</span>:     <span class="c"># again.  So k depends on the modulus of i and j, j depends on the modulus of i,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0156</span>:     <span class="c"># and i always runs positive.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0157</span>:     <span class="c">################################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0158</span>:     <span class="k">for</span> <span class="n">num_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_batch_size;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_num_attempt = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">0159</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0160</span>:         <span class="k">if</span> <span class="n">start_idx</span> <span class="o">&gt;=</span> <span class="n">i_lim</span><span class="o">*</span><span class="n">j_lim</span><span class="o">*</span><span class="n">k_lim</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = ((__pyx_v_start_idx &gt;= ((__pyx_v_i_lim * __pyx_v_j_lim) * __pyx_v_k_lim)) != 0);
    if (__pyx_t_4) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0161</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0162</span>:             <span class="k">return</span> <span class="n">num_out</span></pre>
<pre class='cython code score-0 '>      __pyx_r = __pyx_v_num_out;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0163</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0164</span>:         <span class="n">i</span> <span class="o">=</span> <span class="n">start_idx</span><span class="o">/</span><span class="p">(</span><span class="n">j_lim</span><span class="o">*</span><span class="n">k_lim</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i = (__pyx_v_start_idx / (__pyx_v_j_lim * __pyx_v_k_lim));
</pre><pre class="cython line score-0">&#xA0;<span class="">0165</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0166</span>:         <span class="n">remainder</span> <span class="o">=</span> <span class="n">start_idx</span> <span class="o">%</span> <span class="p">(</span><span class="n">j_lim</span><span class="o">*</span><span class="n">k_lim</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_remainder = (__pyx_v_start_idx % (__pyx_v_j_lim * __pyx_v_k_lim));
</pre><pre class="cython line score-0">&#xA0;<span class="">0167</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>:         <span class="n">i_mod</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i_mod = (__pyx_v_i % 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0169</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0170</span>:         <span class="k">if</span> <span class="n">i_mod</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = ((__pyx_v_i_mod == 0) != 0);
    if (__pyx_t_4) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0171</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0172</span>:             <span class="n">j</span> <span class="o">=</span> <span class="n">remainder</span><span class="o">/</span><span class="n">k_lim</span></pre>
<pre class='cython code score-0 '>      __pyx_v_j = (__pyx_v_remainder / __pyx_v_k_lim);
</pre><pre class="cython line score-0">&#xA0;<span class="">0173</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0174</span>:             <span class="n">j_mod</span> <span class="o">=</span> <span class="n">j</span> <span class="o">%</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>      __pyx_v_j_mod = (__pyx_v_j % 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0175</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>:             <span class="k">if</span> <span class="n">j_mod</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_4 = ((__pyx_v_j_mod == 0) != 0);
      if (__pyx_t_4) {
/* … */
        goto __pyx_L7;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0177</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0178</span>:                 <span class="n">k</span> <span class="o">=</span> <span class="n">remainder</span> <span class="o">%</span> <span class="n">k_lim</span></pre>
<pre class='cython code score-0 '>        __pyx_v_k = (__pyx_v_remainder % __pyx_v_k_lim);
</pre><pre class="cython line score-0">&#xA0;<span class="">0179</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0180</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0181</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0182</span>:                 <span class="n">k</span> <span class="o">=</span> <span class="n">k_lim</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">remainder</span> <span class="o">%</span> <span class="n">k_lim</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_k = ((__pyx_v_k_lim - 1) - (__pyx_v_remainder % __pyx_v_k_lim));
      }
      __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0183</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0184</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0185</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0186</span>:             <span class="n">j</span> <span class="o">=</span> <span class="n">j_lim</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">remainder</span><span class="o">/</span><span class="n">k_lim</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_j = ((__pyx_v_j_lim - 1) - (__pyx_v_remainder / __pyx_v_k_lim));
</pre><pre class="cython line score-0">&#xA0;<span class="">0187</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:             <span class="n">j_mod</span> <span class="o">=</span> <span class="n">j</span> <span class="o">%</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>      __pyx_v_j_mod = (__pyx_v_j % 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0189</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0190</span>:             <span class="k">if</span> <span class="n">j_mod</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_4 = ((__pyx_v_j_mod == 0) != 0);
      if (__pyx_t_4) {
/* … */
        goto __pyx_L8;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0191</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0192</span>:                 <span class="n">k</span> <span class="o">=</span> <span class="n">k_lim</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">remainder</span> <span class="o">%</span> <span class="n">k_lim</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_k = ((__pyx_v_k_lim - 1) - (__pyx_v_remainder % __pyx_v_k_lim));
</pre><pre class="cython line score-0">&#xA0;<span class="">0193</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0194</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0195</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0196</span>:                 <span class="n">k</span> <span class="o">=</span> <span class="n">remainder</span> <span class="o">%</span> <span class="n">k_lim</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_k = (__pyx_v_remainder % __pyx_v_k_lim);
      }
      __pyx_L8:;
    }
    __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0197</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0198</span>:         <span class="n">skip_this_index</span> <span class="o">=</span> <span class="n">cell_ID_dict</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_skip_this_index = ((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *)__pyx_v_cell_ID_dict-&gt;__pyx_vtab)-&gt;contains(__pyx_v_cell_ID_dict, __pyx_v_i, __pyx_v_j, __pyx_v_k, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">0199</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0200</span>:         <span class="c">#skip_this_index = False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0201</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0202</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_this_index</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = ((!(__pyx_v_skip_this_index != 0)) != 0);
    if (__pyx_t_4) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0203</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0204</span>:             <span class="n">i_j_k_array</span><span class="p">[</span><span class="n">num_out</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_num_out;
      __pyx_t_6 = 0;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_j_k_array.data + __pyx_t_5 * __pyx_v_i_j_k_array.strides[0]) ) + __pyx_t_6 * __pyx_v_i_j_k_array.strides[1]) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0205</span>:             <span class="n">i_j_k_array</span><span class="p">[</span><span class="n">num_out</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span></pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_num_out;
      __pyx_t_6 = 1;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_j_k_array.data + __pyx_t_5 * __pyx_v_i_j_k_array.strides[0]) ) + __pyx_t_6 * __pyx_v_i_j_k_array.strides[1]) )) = __pyx_v_j;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0206</span>:             <span class="n">i_j_k_array</span><span class="p">[</span><span class="n">num_out</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span></pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_num_out;
      __pyx_t_6 = 2;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_j_k_array.data + __pyx_t_5 * __pyx_v_i_j_k_array.strides[0]) ) + __pyx_t_6 * __pyx_v_i_j_k_array.strides[1]) )) = __pyx_v_k;
</pre><pre class="cython line score-0">&#xA0;<span class="">0207</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0208</span>:             <span class="n">num_out</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_num_out = (__pyx_v_num_out + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0209</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0210</span>:         <span class="n">start_idx</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_start_idx = (__pyx_v_start_idx + 1);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0212</span>:         <span class="c">#num_attempt += 1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0213</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0214</span>:     <span class="k">return</span> <span class="n">num_out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_num_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0215</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0216</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0217</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0219</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0220</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0221</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0222</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0223</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-109" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>: <span class="k">cpdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">fill_ijk</span><span class="p">(</span><span class="n">DTYPE_INT64_t</span><span class="p">[:,:]</span> <span class="n">i_j_k_array</span><span class="p">,</span></pre>
<pre class='cython code score-109 '>static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_3fill_ijk(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_f_4vast_10voidfinder_18_voidfinder_cython_fill_ijk(__Pyx_memviewslice __pyx_v_i_j_k_array, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_batch_size, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i_lim, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j_lim, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k_lim, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *__pyx_v_cell_ID_dict, CYTHON_UNUSED int __pyx_skip_dispatch) {
  CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_num_attempt;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_num_out;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_inc_j;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_inc_i;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_skip_this_index;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fill_ijk", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_3fill_ijk(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4vast_10voidfinder_18_voidfinder_cython_2fill_ijk[] = "\n    POSSIBLE PROBLEM - SEE DOCSTRING FOR fill_ijk_zig_zag\n    \n    This fill_ijk goes in natural grid order, not zig-zag order.\n    ";
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_3fill_ijk(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_i_j_k_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_batch_size;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i_lim;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j_lim;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k_lim;
  struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *__pyx_v_cell_ID_dict = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fill_ijk (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_i_j_k_array,&amp;__pyx_n_s_i,&amp;__pyx_n_s_j,&amp;__pyx_n_s_k,&amp;__pyx_n_s_batch_size,&amp;__pyx_n_s_i_lim,&amp;__pyx_n_s_j_lim,&amp;__pyx_n_s_k_lim,&amp;__pyx_n_s_cell_ID_dict,0};
    PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_i_j_k_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_i)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk", 1, 9, 9, 1); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_j)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk", 1, 9, 9, 2); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk", 1, 9, 9, 3); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_batch_size)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk", 1, 9, 9, 4); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_i_lim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk", 1, 9, 9, 5); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_j_lim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk", 1, 9, 9, 6); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_k_lim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk", 1, 9, 9, 7); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cell_ID_dict)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk", 1, 9, 9, 8); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fill_ijk") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 9) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
    }
    __pyx_v_i_j_k_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_i_j_k_array.memview)) __PYX_ERR(0, 224, __pyx_L3_error)</span>
    __pyx_v_i = __Pyx_PyInt_As_npy_int64(values[1]); if (unlikely((__pyx_v_i == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 225, __pyx_L3_error)</span>
    __pyx_v_j = __Pyx_PyInt_As_npy_int64(values[2]); if (unlikely((__pyx_v_j == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 226, __pyx_L3_error)</span>
    __pyx_v_k = __Pyx_PyInt_As_npy_int64(values[3]); if (unlikely((__pyx_v_k == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 227, __pyx_L3_error)</span>
    __pyx_v_batch_size = __Pyx_PyInt_As_npy_int64(values[4]); if (unlikely((__pyx_v_batch_size == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L3_error)</span>
    __pyx_v_i_lim = __Pyx_PyInt_As_npy_int64(values[5]); if (unlikely((__pyx_v_i_lim == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 229, __pyx_L3_error)</span>
    __pyx_v_j_lim = __Pyx_PyInt_As_npy_int64(values[6]); if (unlikely((__pyx_v_j_lim == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L3_error)</span>
    __pyx_v_k_lim = __Pyx_PyInt_As_npy_int64(values[7]); if (unlikely((__pyx_v_k_lim == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 231, __pyx_L3_error)</span>
    __pyx_v_cell_ID_dict = ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *)values[8]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fill_ijk", 1, 9, 9, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.fill_ijk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_cell_ID_dict), __pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict, 1, "cell_ID_dict", 0))) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4vast_10voidfinder_18_voidfinder_cython_2fill_ijk(__pyx_self, __pyx_v_i_j_k_array, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_batch_size, __pyx_v_i_lim, __pyx_v_j_lim, __pyx_v_k_lim, __pyx_v_cell_ID_dict);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_18_voidfinder_cython_2fill_ijk(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_i_j_k_array, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_batch_size, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_i_lim, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_j_lim, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t __pyx_v_k_lim, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *__pyx_v_cell_ID_dict) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fill_ijk", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_i_j_k_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("i_j_k_array"); <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_PyInt_From_npy_int64(__pyx_f_4vast_10voidfinder_18_voidfinder_cython_fill_ijk(__pyx_v_i_j_k_array, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_batch_size, __pyx_v_i_lim, __pyx_v_j_lim, __pyx_v_k_lim, __pyx_v_cell_ID_dict, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.fill_ijk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_i_j_k_array, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0225</span>:                              <span class="n">DTYPE_INT64_t</span> <span class="n">i</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0226</span>:                              <span class="n">DTYPE_INT64_t</span> <span class="n">j</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0227</span>:                              <span class="n">DTYPE_INT64_t</span> <span class="n">k</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0228</span>:                              <span class="n">DTYPE_INT64_t</span> <span class="n">batch_size</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0229</span>:                              <span class="n">DTYPE_INT64_t</span> <span class="n">i_lim</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0230</span>:                              <span class="n">DTYPE_INT64_t</span> <span class="n">j_lim</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0231</span>:                              <span class="n">DTYPE_INT64_t</span> <span class="n">k_lim</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0232</span>:                              <span class="n">HoleGridCustomDict</span> <span class="n">cell_ID_dict</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0233</span>:                              <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0235</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0236</span>: <span class="sd">    POSSIBLE PROBLEM - SEE DOCSTRING FOR fill_ijk_zig_zag</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0237</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0238</span>: <span class="sd">    This fill_ijk goes in natural grid order, not zig-zag order.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0239</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0240</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0241</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0242</span>:     <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">i_lim</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">j_lim</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="n">k_lim</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_i &gt;= __pyx_v_i_lim) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_j &gt;= __pyx_v_j_lim) != 0);
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_k &gt;= __pyx_v_k_lim) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0243</span>:         <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0244</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0245</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">num_attempt</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_attempt = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0246</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0247</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span> <span class="nf">num_out</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_out = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0248</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0249</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">inc_j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0250</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0251</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">inc_i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0252</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0253</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">skip_this_index</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0254</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0255</span>:     <span class="c">#while num_attempt &lt; batch_size:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0256</span>:     <span class="k">for</span> <span class="n">num_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_batch_size;
  __pyx_t_4 = __pyx_t_3;
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_num_attempt = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">0257</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0258</span>:         <span class="n">skip_this_index</span> <span class="o">=</span> <span class="n">cell_ID_dict</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_skip_this_index = ((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_HoleGridCustomDict *)__pyx_v_cell_ID_dict-&gt;__pyx_vtab)-&gt;contains(__pyx_v_cell_ID_dict, __pyx_v_i, __pyx_v_j, __pyx_v_k, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">0259</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0260</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_this_index</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((!(__pyx_v_skip_this_index != 0)) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0261</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0262</span>:             <span class="n">i_j_k_array</span><span class="p">[</span><span class="n">num_out</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = __pyx_v_num_out;
      __pyx_t_7 = 0;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_j_k_array.data + __pyx_t_6 * __pyx_v_i_j_k_array.strides[0]) ) + __pyx_t_7 * __pyx_v_i_j_k_array.strides[1]) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0263</span>:             <span class="n">i_j_k_array</span><span class="p">[</span><span class="n">num_out</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = __pyx_v_num_out;
      __pyx_t_7 = 1;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_j_k_array.data + __pyx_t_6 * __pyx_v_i_j_k_array.strides[0]) ) + __pyx_t_7 * __pyx_v_i_j_k_array.strides[1]) )) = __pyx_v_j;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0264</span>:             <span class="n">i_j_k_array</span><span class="p">[</span><span class="n">num_out</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = __pyx_v_num_out;
      __pyx_t_7 = 2;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_j_k_array.data + __pyx_t_6 * __pyx_v_i_j_k_array.strides[0]) ) + __pyx_t_7 * __pyx_v_i_j_k_array.strides[1]) )) = __pyx_v_k;
</pre><pre class="cython line score-0">&#xA0;<span class="">0265</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0266</span>:             <span class="n">num_out</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_num_out = (__pyx_v_num_out + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0267</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0268</span>:         <span class="n">inc_j</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_v_inc_j = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0269</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0270</span>:         <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">k_lim</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_k &gt;= (__pyx_v_k_lim - 1)) != 0);
    if (!__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L11_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_k &lt; 0) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L11_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0271</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0272</span>:             <span class="n">inc_j</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>      __pyx_v_inc_j = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0273</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0274</span>:         <span class="n">inc_i</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_v_inc_i = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0275</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0276</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">inc_j</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">j_lim</span> <span class="o">-</span> <span class="mf">1</span><span class="p">))</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_v_inc_j != 0);
    if (!__pyx_t_2) {
      goto __pyx_L15_next_or;
    } else {
    }
    __pyx_t_2 = ((__pyx_v_j &gt;= (__pyx_v_j_lim - 1)) != 0);
    if (!__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_L15_next_or:;
    __pyx_t_2 = ((__pyx_v_j &lt; 0) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L14_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0277</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0278</span>:             <span class="n">inc_i</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>      __pyx_v_inc_i = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0279</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0280</span>:         <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">k_lim</span></pre>
<pre class='cython code score-0 '>    __pyx_v_k = ((__pyx_v_k + 1) % __pyx_v_k_lim);
</pre><pre class="cython line score-0">&#xA0;<span class="">0281</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0282</span>:         <span class="k">if</span> <span class="n">inc_j</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_inc_j != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0283</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0284</span>:             <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">j_lim</span></pre>
<pre class='cython code score-0 '>      __pyx_v_j = ((__pyx_v_j + 1) % __pyx_v_j_lim);
</pre><pre class="cython line score-0">&#xA0;<span class="">0285</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0286</span>:         <span class="k">if</span> <span class="n">inc_i</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = (__pyx_v_inc_i != 0);
    if (__pyx_t_1) {
/* … */
    }
  }
  __pyx_L8_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0287</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0288</span>:             <span class="n">i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0289</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0290</span>:             <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">i_lim</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_i &gt;= __pyx_v_i_lim) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0291</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0292</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L8_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0293</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0294</span>:         <span class="c">#num_attempt += 1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0295</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:     <span class="k">return</span> <span class="n">num_out</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_num_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0297</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0299</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0300</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0302</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0303</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0304</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0306</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0308</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-129" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0310</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">main_algorithm</span><span class="p">(</span><span class="n">DTYPE_INT64_t</span><span class="p">[:,:]</span> <span class="n">i_j_k_array</span><span class="p">,</span></pre>
<pre class='cython code score-129 '>static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_5main_algorithm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_4vast_10voidfinder_18_voidfinder_cython_main_algorithm(__Pyx_memviewslice __pyx_v_i_j_k_array, PyObject *__pyx_v_galaxy_tree, __Pyx_memviewslice __pyx_v_w_coord, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dl, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dr, __Pyx_memviewslice __pyx_v_coord_min, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker *__pyx_v_mask_checker, __Pyx_memviewslice __pyx_v_return_array, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory *__pyx_v_cell_ID_mem, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_NeighborMemory *__pyx_v_neighbor_mem, CYTHON_UNUSED int __pyx_v_verbose, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_working_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_idx;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_temp_f64_accum;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_temp_f64_accum2;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_temp_f64_val;
  __Pyx_memviewslice __pyx_v_hole_center_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_hole_center_2_3_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_hole_center_41_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_hole_center_42_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_nearest_gal_index_list = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_vector_modulus;
  __Pyx_memviewslice __pyx_v_unit_vector_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_v3_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_hole_radius;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_in_mask_2;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_in_mask_3;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_in_mask_41;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_in_mask_42;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_k1g;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_k2g;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_k3g;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_k4g1;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_k4g2;
  CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_k4g;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_minx3;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_minx41;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_minx42;
  __Pyx_memviewslice __pyx_v_midpoint_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_AB_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_BC_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Bcenter_memview = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_t_4vast_10voidfinder_28_voidfinder_cython_find_next_DistIdxPair __pyx_v_query_vals;
  __pyx_t_4vast_10voidfinder_8typedefs_ITYPE_t __pyx_v_num_cells;
  struct __pyx_t_4vast_10voidfinder_28_voidfinder_cython_find_next_FindNextReturnVal __pyx_v_find_next_retval;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_not_in_mask_41;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("main_algorithm", 0);
  <span class='trace'>__Pyx_TraceCall</span>("main_algorithm", __pyx_f[0], 310, 0, <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_22, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("vast.voidfinder._voidfinder_cython.main_algorithm", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_hole_center_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_hole_center_2_3_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_hole_center_41_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_hole_center_42_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nearest_gal_index_list, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_unit_vector_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_v3_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_midpoint_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_AB_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_BC_memview, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Bcenter_memview, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_5main_algorithm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4vast_10voidfinder_18_voidfinder_cython_4main_algorithm[] = "\n    Description\n    ===========\n    \n    Given a potential void cell center denoted by i,j,k, find the 4 bounding \n    galaxies that maximize the interior dimensions of the hole sphere at this \n    location.\n    \n    There are some really weird particulars to this algorithm that need to be \n    laid out in better detail.\n\n    The code below will utilize the naming scheme galaxy A, B, C, and D to \n    denote the 1st, 2nd, 3rd, and 4th \"neighbor\" bounding galaxies found during \n    the running of this algorithm.  I tried to use 1/A, 2/B, 3/C and 4/D to be \n    clear on the numbers and letters are together.\n    \n    The distance metrics are somewhat special.  Galaxy A is found by normal \n    minimzation of euclidean distance between the cell center and itself and the \n    other neighbors.  Galaxies B, C, and D are found by propogating a hole \n    center in specific directions and minimizing a ratio of two other \n    distance-metric-like values.  This needs more detail on how and why.\n    \n    \n    Parameters:\n    ===========\n    \n    i_j_k_array : memoryview of (N,3) numpy array\n        a batch of N cell IDs on which to run the VoidFinder hole-growing \n        algorithm\n      \n    galaxy_tree : python object\n        a glorified wrapper around a couple of the data structures used by \n        VoidFinder\n        \n    w_coord : memoryview to (K,3) numpy array\n        xyz space galaxy coordinates\n        \n    dl : float\n        edge length in Mpc/h of the hole grid cell size\n        \n    dr : float\n        Step-size for moving the hole center used while searching for the next \n        nearest galaxy. \n        \n    coord_min : memoryview to (1,3) numpy array\n        xyz-space coordinates of the (0,0,0) origin location of the hole grid \n        and galaxy map grids \n    \n    mask : memoryview into (?,?) numpy array\n        True when a location is inside the survey, False when a location is \n        outside the survey\n     ""   \n    mask_resolution : int\n        The length of the mask binning used to generate the survey mask, in \n        units of degrees. \n        \n    min_dist : float\n        Minimum distance of the galaxy distribution.\n        \n    max_dist : float\n        Maximum distance of the galaxy distribution.\n        \n    DEPRECATED hole_radial_mask_check_dist : float\n        fraction of hole radius at which to check the 6 directions +/- x,y,z to see\n        if too much of the hole is outside the mask, and if so, discard the hole\n        \n    return_array : memoryview into (N,4) numpy array\n        memory for results, each row is (x,y,z,r)\n        \n    cell_ID_mem : _voidfinder_cython_find_next.Cell_ID_Memory\n        object which coordinates access to cell ID grid locations when seaching \n        for neighbor galaxies\n        \n    neighbor_mem : _voidfinder_cython_find_next.NeighborMemory\n        object which coordinates access to a handful of arrays which may need to \n        be dynamically resized during nearest neighbor calculations\n        \n    verbose : int\n        values &gt;= 1 indicate to make a lot more print statements\n    \n    Returns:\n    ========\n    \n    NAN or (x,y,z,r) rows filled into the return_array parameter.\n    \n    ";
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_5main_algorithm(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_i_j_k_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_galaxy_tree = 0;
  __Pyx_memviewslice __pyx_v_w_coord = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dl;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dr;
  __Pyx_memviewslice __pyx_v_coord_min = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker *__pyx_v_mask_checker = 0;
  __Pyx_memviewslice __pyx_v_return_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory *__pyx_v_cell_ID_mem = 0;
  struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_NeighborMemory *__pyx_v_neighbor_mem = 0;
  int __pyx_v_verbose;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("main_algorithm (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_i_j_k_array,&amp;__pyx_n_s_galaxy_tree,&amp;__pyx_n_s_w_coord,&amp;__pyx_n_s_dl,&amp;__pyx_n_s_dr,&amp;__pyx_n_s_coord_min,&amp;__pyx_n_s_mask_checker,&amp;__pyx_n_s_return_array,&amp;__pyx_n_s_cell_ID_mem,&amp;__pyx_n_s_neighbor_mem,&amp;__pyx_n_s_verbose,0};
    PyObject* values[11] = {0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_i_j_k_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_galaxy_tree)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 1); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_w_coord)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 2); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dl)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 3); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 4); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_coord_min)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 5); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mask_checker)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 6); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_return_array)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 7); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cell_ID_mem)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 8); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_neighbor_mem)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 9); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (likely((values[10] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_verbose)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, 10); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "main_algorithm") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 11) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
    }
    __pyx_v_i_j_k_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_i_j_k_array.memview)) __PYX_ERR(0, 310, __pyx_L3_error)</span>
    __pyx_v_galaxy_tree = values[1];
    __pyx_v_w_coord = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_w_coord.memview)) __PYX_ERR(0, 312, __pyx_L3_error)</span>
    __pyx_v_dl = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_dl == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 313, __pyx_L3_error)</span>
    __pyx_v_dr = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_dr == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
    __pyx_v_coord_min = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_coord_min.memview)) __PYX_ERR(0, 315, __pyx_L3_error)</span>
    __pyx_v_mask_checker = ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker *)values[6]);
    __pyx_v_return_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_return_array.memview)) __PYX_ERR(0, 322, __pyx_L3_error)</span>
    __pyx_v_cell_ID_mem = ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory *)values[8]);
    __pyx_v_neighbor_mem = ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_NeighborMemory *)values[9]);
    __pyx_v_verbose = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[10]); if (unlikely((__pyx_v_verbose == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm", 1, 11, 11, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.main_algorithm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mask_checker), __pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker, 1, "mask_checker", 0))) <span class='error_goto'>__PYX_ERR(0, 316, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_cell_ID_mem), __pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory, 1, "cell_ID_mem", 0))) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_neighbor_mem), __pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_NeighborMemory, 1, "neighbor_mem", 0))) <span class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4vast_10voidfinder_18_voidfinder_cython_4main_algorithm(__pyx_self, __pyx_v_i_j_k_array, __pyx_v_galaxy_tree, __pyx_v_w_coord, __pyx_v_dl, __pyx_v_dr, __pyx_v_coord_min, __pyx_v_mask_checker, __pyx_v_return_array, __pyx_v_cell_ID_mem, __pyx_v_neighbor_mem, __pyx_v_verbose);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_18_voidfinder_cython_4main_algorithm(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_i_j_k_array, PyObject *__pyx_v_galaxy_tree, __Pyx_memviewslice __pyx_v_w_coord, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dl, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dr, __Pyx_memviewslice __pyx_v_coord_min, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker *__pyx_v_mask_checker, __Pyx_memviewslice __pyx_v_return_array, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_Cell_ID_Memory *__pyx_v_cell_ID_mem, struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_NeighborMemory *__pyx_v_neighbor_mem, int __pyx_v_verbose) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("main_algorithm", 0);
  <span class='trace'>__Pyx_TraceCall</span>("main_algorithm (wrapper)", __pyx_f[0], 310, 0, <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_i_j_k_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("i_j_k_array"); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_w_coord.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("w_coord"); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_coord_min.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("coord_min"); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_return_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("return_array"); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_4vast_10voidfinder_18_voidfinder_cython_main_algorithm(__pyx_v_i_j_k_array, __pyx_v_galaxy_tree, __pyx_v_w_coord, __pyx_v_dl, __pyx_v_dr, __pyx_v_coord_min, __pyx_v_mask_checker, __pyx_v_return_array, __pyx_v_cell_ID_mem, __pyx_v_neighbor_mem, __pyx_v_verbose, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.main_algorithm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_i_j_k_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_w_coord, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_coord_min, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_return_array, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0311</span>:                           <span class="n">galaxy_tree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0312</span>:                           <span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">w_coord</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>:                           <span class="n">DTYPE_F64_t</span> <span class="n">dl</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>:                           <span class="n">DTYPE_F64_t</span> <span class="n">dr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0315</span>:                           <span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">coord_min</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0316</span>:                           <span class="n">MaskChecker</span> <span class="n">mask_checker</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0317</span>:                           <span class="c">#DTYPE_B_t[:,:] mask,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0318</span>:                           <span class="c">#DTYPE_INT32_t mask_resolution,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0319</span>:                           <span class="c">#DTYPE_F64_t min_dist,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0320</span>:                           <span class="c">#DTYPE_F64_t max_dist,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0321</span>:                           <span class="c">#DTYPE_F64_t hole_radial_mask_check_dist,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0322</span>:                           <span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">return_array</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0323</span>:                           <span class="n">Cell_ID_Memory</span> <span class="n">cell_ID_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0324</span>:                           <span class="n">NeighborMemory</span> <span class="n">neighbor_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0325</span>:                           <span class="nb">int</span> <span class="n">verbose</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0326</span>:                           <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>:     <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>: <span class="sd">    Description</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0329</span>: <span class="sd">    ===========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0330</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0331</span>: <span class="sd">    Given a potential void cell center denoted by i,j,k, find the 4 bounding </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0332</span>: <span class="sd">    galaxies that maximize the interior dimensions of the hole sphere at this </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0333</span>: <span class="sd">    location.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0334</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>: <span class="sd">    There are some really weird particulars to this algorithm that need to be </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0336</span>: <span class="sd">    laid out in better detail.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0337</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0338</span>: <span class="sd">    The code below will utilize the naming scheme galaxy A, B, C, and D to </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>: <span class="sd">    denote the 1st, 2nd, 3rd, and 4th &quot;neighbor&quot; bounding galaxies found during </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0340</span>: <span class="sd">    the running of this algorithm.  I tried to use 1/A, 2/B, 3/C and 4/D to be </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0341</span>: <span class="sd">    clear on the numbers and letters are together.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0342</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0343</span>: <span class="sd">    The distance metrics are somewhat special.  Galaxy A is found by normal </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>: <span class="sd">    minimzation of euclidean distance between the cell center and itself and the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0345</span>: <span class="sd">    other neighbors.  Galaxies B, C, and D are found by propogating a hole </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0346</span>: <span class="sd">    center in specific directions and minimizing a ratio of two other </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0347</span>: <span class="sd">    distance-metric-like values.  This needs more detail on how and why.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0348</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0349</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0350</span>: <span class="sd">    Parameters:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0351</span>: <span class="sd">    ===========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0352</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0353</span>: <span class="sd">    i_j_k_array : memoryview of (N,3) numpy array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0354</span>: <span class="sd">        a batch of N cell IDs on which to run the VoidFinder hole-growing </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0355</span>: <span class="sd">        algorithm</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0356</span>: <span class="sd">      </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>: <span class="sd">    galaxy_tree : python object</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0358</span>: <span class="sd">        a glorified wrapper around a couple of the data structures used by </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0359</span>: <span class="sd">        VoidFinder</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0360</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0361</span>: <span class="sd">    w_coord : memoryview to (K,3) numpy array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0362</span>: <span class="sd">        xyz space galaxy coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0363</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0364</span>: <span class="sd">    dl : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0365</span>: <span class="sd">        edge length in Mpc/h of the hole grid cell size</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0366</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0367</span>: <span class="sd">    dr : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0368</span>: <span class="sd">        Step-size for moving the hole center used while searching for the next </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0369</span>: <span class="sd">        nearest galaxy. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0370</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0371</span>: <span class="sd">    coord_min : memoryview to (1,3) numpy array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0372</span>: <span class="sd">        xyz-space coordinates of the (0,0,0) origin location of the hole grid </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0373</span>: <span class="sd">        and galaxy map grids </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0374</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0375</span>: <span class="sd">    mask : memoryview into (?,?) numpy array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0376</span>: <span class="sd">        True when a location is inside the survey, False when a location is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0377</span>: <span class="sd">        outside the survey</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0378</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0379</span>: <span class="sd">    mask_resolution : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0380</span>: <span class="sd">        The length of the mask binning used to generate the survey mask, in </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0381</span>: <span class="sd">        units of degrees. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0382</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0383</span>: <span class="sd">    min_dist : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0384</span>: <span class="sd">        Minimum distance of the galaxy distribution.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0385</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0386</span>: <span class="sd">    max_dist : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0387</span>: <span class="sd">        Maximum distance of the galaxy distribution.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0388</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0389</span>: <span class="sd">    DEPRECATED hole_radial_mask_check_dist : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0390</span>: <span class="sd">        fraction of hole radius at which to check the 6 directions +/- x,y,z to see</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0391</span>: <span class="sd">        if too much of the hole is outside the mask, and if so, discard the hole</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0392</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0393</span>: <span class="sd">    return_array : memoryview into (N,4) numpy array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0394</span>: <span class="sd">        memory for results, each row is (x,y,z,r)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0395</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0396</span>: <span class="sd">    cell_ID_mem : _voidfinder_cython_find_next.Cell_ID_Memory</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0397</span>: <span class="sd">        object which coordinates access to cell ID grid locations when seaching </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0398</span>: <span class="sd">        for neighbor galaxies</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0399</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0400</span>: <span class="sd">    neighbor_mem : _voidfinder_cython_find_next.NeighborMemory</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0401</span>: <span class="sd">        object which coordinates access to a handful of arrays which may need to </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0402</span>: <span class="sd">        be dynamically resized during nearest neighbor calculations</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0403</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0404</span>: <span class="sd">    verbose : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0405</span>: <span class="sd">        values &gt;= 1 indicate to make a lot more print statements</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0406</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0407</span>: <span class="sd">    Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0408</span>: <span class="sd">    ========</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0410</span>: <span class="sd">    NAN or (x,y,z,r) rows filled into the return_array parameter.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>: <span class="sd">    &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0414</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0415</span>:     <span class="c">#cdef MASK_CHECK_FUNCTION_t mask_check_function = not_in_mask</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0416</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0417</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>:     <span class="c"># re-used helper index variables</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>:     <span class="c"># re-used helper computation variables</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0421</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0422</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0423</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>:     <span class="c">#DEBUG_OUTFILE = open(&quot;VF_DEBUG.txt&quot;, &#39;a&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">working_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">jdx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0432</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">temp_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0434</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0435</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0436</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">temp_f64_accum</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0437</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0438</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">temp_f64_accum2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0440</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">temp_f64_val</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0441</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0442</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0443</span>:     <span class="c"># Hole center vector and propogate hole center memory.  We can re-use the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0444</span>:     <span class="c"># same memory for finding galaxies 2/B and 3/C but not for galaxy 4/D</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0445</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0446</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:,:]</span> <span class="n">hole_center_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 446, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_hole_center_memview = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple_);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0447</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0448</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:,:]</span> <span class="n">hole_center_2_3_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 448, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 448, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 448, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_hole_center_2_3_memview = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0449</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:,:]</span> <span class="n">hole_center_41_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_hole_center_41_memview = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0451</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:,:]</span> <span class="n">hole_center_42_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">1</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 452, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 452, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__2, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_hole_center_42_memview = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0453</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0454</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0455</span>:     <span class="c"># The nearest_gal_index_list variable stores 2 things - the sentinel value </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0456</span>:     <span class="c"># -1 meaning &#39;no value here&#39; or the index of the found galaxies A,B,C (but </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0457</span>:     <span class="c"># not D since it is the last one)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0459</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_INT64_t</span>[<span class="p">:]</span> <span class="n">nearest_gal_index_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_nearest_gal_index_list = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0">&#xA0;<span class="">0460</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0461</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>:     <span class="c"># vector_modulus is re-used each time the new unit vector is calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>:     <span class="c"># unit_vector_memview is re-used each time the new unit vector is calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>:     <span class="c"># v3_memview is used in calculating the cross product for galaxy 4/D</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0466</span>:     <span class="c"># hole_radius is used in some hole update calculations</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0467</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0468</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">vector_modulus</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0470</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:]</span> <span class="n">unit_vector_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 470, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_unit_vector_memview = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0471</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0472</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:]</span> <span class="n">v3_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__3, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 472, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_v3_memview = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0473</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0474</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">hole_radius</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0475</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0476</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0477</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0478</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0479</span>:     <span class="c"># Variables for the 4 galaxy seaarches whether the hole center is in the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0480</span>:     <span class="c"># mask</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0481</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0482</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">in_mask_2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0483</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0484</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">in_mask_3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0485</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0486</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">in_mask_41</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">in_mask_42</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">discard_mask_overlap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>:     <span class="c"># variables for the 4 bounding galaxies (gal 4/D gets 3 variables because it </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>:     <span class="c"># uses 2 searches and then picks one of the two based on some criteria)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">k1g</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">k2g</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0500</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0501</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">k3g</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">k4g1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">k4g2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0507</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">k4g</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0508</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0509</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0510</span>:     <span class="c"># minx3 is used in updating a hole center and minx41-42 are used in </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0511</span>:     <span class="c"># comparing to find galaxy 4/D</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0512</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">minx3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">minx41</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0516</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0517</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">minx42</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0520</span>:     <span class="c"># These are used in calcuating the unit vector for galaxy 4/D</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0521</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0522</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:]</span> <span class="n">midpoint_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_midpoint_memview = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0523</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0524</span>:     <span class="c">#cdef DTYPE_F64_t[:] Acenter_memview = np.empty(3, dtype=np.float64, order=&#39;C&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0525</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0526</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:]</span> <span class="n">AB_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 526, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_AB_memview = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0527</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0528</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:]</span> <span class="n">BC_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_BC_memview = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0529</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0530</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0531</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0532</span>:     <span class="c"># Computation memory to pass into find_next_galaxy()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0533</span>:     <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0534</span>:     <span class="c"># NOTE: This memory is currently unused because I need to figure out how to </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>:     <span class="c">#       reallocate it if it is not big enough without leaking memory and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>:     <span class="c">#       causing a segfault</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0538</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span>[<span class="p">:]</span> <span class="n">Bcenter_memview</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;C&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 538, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 538, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__3, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 538, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_Bcenter_memview = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0539</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>:     <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>:     <span class="k">cdef</span> <span class="kt">DistIdxPair</span> <span class="nf">query_vals</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0546</span>:     <span class="k">cdef</span> <span class="kt">ITYPE_t</span> <span class="nf">num_cells</span> <span class="o">=</span> <span class="n">i_j_k_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_cells = (__pyx_v_i_j_k_array.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0547</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>:     <span class="k">cdef</span> <span class="kt">FindNextReturnVal</span> <span class="nf">find_next_retval</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0551</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0552</span>:     <span class="c"># Main Loop - grow a hole in each of the N hole grid cell locations</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0553</span>:     <span class="c">############################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0554</span>:     <span class="k">for</span> <span class="n">working_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_cells</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_num_cells;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_working_idx = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0555</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0556</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0557</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0558</span>:         <span class="c"># Re-init nearest gal index list on new cell</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0559</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0560</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0561</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0562</span>:             <span class="n">nearest_gal_index_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_nearest_gal_index_list.data + __pyx_t_12 * __pyx_v_nearest_gal_index_list.strides[0]) )) = -1LL;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0563</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0566</span>:         <span class="c"># Initialize the starting hole center based on the given i,j,k and grid </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>:         <span class="c"># spacing parameters, and then check to make sure it is in the survey</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0569</span>:         <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i_j_k_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_working_idx;
    __pyx_t_13 = 0;
    __pyx_t_14 = 0;
    __pyx_t_15 = 0;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_14 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_15 * __pyx_v_hole_center_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_j_k_array.data + __pyx_t_12 * __pyx_v_i_j_k_array.strides[0]) ) + __pyx_t_13 * __pyx_v_i_j_k_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0570</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0571</span>:         <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">i_j_k_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_working_idx;
    __pyx_t_12 = 1;
    __pyx_t_15 = 0;
    __pyx_t_14 = 1;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_15 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_14 * __pyx_v_hole_center_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_j_k_array.data + __pyx_t_13 * __pyx_v_i_j_k_array.strides[0]) ) + __pyx_t_12 * __pyx_v_i_j_k_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0572</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:         <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">i_j_k_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_working_idx;
    __pyx_t_13 = 2;
    __pyx_t_14 = 0;
    __pyx_t_15 = 2;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_14 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_15 * __pyx_v_hole_center_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_i_j_k_array.data + __pyx_t_12 * __pyx_v_i_j_k_array.strides[0]) ) + __pyx_t_13 * __pyx_v_i_j_k_array.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">0574</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0575</span>:         <span class="c">#print(&quot;Working ijk: &quot;+str(i_j_k_array[working_idx, 0])+&quot;,&quot;+str(i_j_k_array[working_idx, 1])+&quot;,&quot;+str(i_j_k_array[working_idx, 2]), flush=True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0576</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0577</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0578</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0579</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0580</span>:             <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dl</span> <span class="o">+</span> <span class="n">coord_min</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 0;
      __pyx_t_12 = __pyx_v_idx;
      __pyx_t_15 = 0;
      __pyx_t_14 = __pyx_v_idx;
      __pyx_t_16 = 0;
      __pyx_t_17 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_16 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_17 * __pyx_v_hole_center_memview.strides[1]) )) = ((((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_13 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_12 * __pyx_v_hole_center_memview.strides[1]) ))) + 0.5) * __pyx_v_dl) + (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coord_min.data + __pyx_t_15 * __pyx_v_coord_min.strides[0]) ) + __pyx_t_14 * __pyx_v_coord_min.strides[1]) ))));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0581</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0582</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>:         <span class="c">#if not_in_mask(hole_center_memview, mask, mask_resolution, min_dist, max_dist):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>:         <span class="c">#if mask_check_function(hole_center_memview, mask, mask_resolution, min_dist, max_dist):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0585</span>:         <span class="k">if</span> <span class="n">mask_checker</span><span class="o">.</span><span class="n">not_in_mask</span><span class="p">(</span><span class="n">hole_center_memview</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = (((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker *)__pyx_v_mask_checker-&gt;__pyx_vtab)-&gt;not_in_mask(__pyx_v_mask_checker, __pyx_v_hole_center_memview) != 0);
    if (__pyx_t_18) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0586</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>:             <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>: <span class="sd">            out_str = &quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>: <span class="sd">            out_str += &quot; &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>: <span class="sd">            out_str += &quot;nim1&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>: <span class="sd">            out_str += &quot;\n&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0597</span>: <span class="sd">            DEBUG_OUTFILE.write(out_str)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0598</span>: <span class="sd">            &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0599</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0600</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_working_idx;
      __pyx_t_15 = 0;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_14 * __pyx_v_return_array.strides[0]) ) + __pyx_t_15 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0601</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0602</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_working_idx;
      __pyx_t_14 = 1;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_15 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0603</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0604</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_working_idx;
      __pyx_t_15 = 2;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_14 * __pyx_v_return_array.strides[0]) ) + __pyx_t_15 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0605</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0606</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_working_idx;
      __pyx_t_14 = 3;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_15 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0607</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0608</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">0609</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0610</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0611</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>:         <span class="c"># Find Galaxy 1/A - super easy using _query_first</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0614</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0615</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0616</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0617</span>:         <span class="n">query_vals</span> <span class="o">=</span> <span class="n">_query_first</span><span class="p">(</span><span class="n">galaxy_tree</span><span class="o">.</span><span class="n">reference_point_ijk</span><span class="p">,</span></pre>
<pre class='cython code score-4 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_galaxy_tree, __pyx_n_s_reference_point_ijk);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 617, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_CELL_ID_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 617, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
    __pyx_v_query_vals = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next__query_first(__pyx_t_19, __pyx_t_5, __pyx_t_20, __pyx_t_21, __pyx_t_22, ((struct __pyx_obj_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict *)__pyx_t_2), __pyx_t_6, __pyx_t_23, __pyx_v_cell_ID_mem, __pyx_v_hole_center_memview);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
    __pyx_t_19.memview = NULL;
    __pyx_t_19.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
    __pyx_t_21.memview = NULL;
    __pyx_t_21.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_22, 1);
    __pyx_t_22.memview = NULL;
    __pyx_t_22.data = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
    __pyx_t_6.memview = NULL;
    __pyx_t_6.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
    __pyx_t_23.memview = NULL;
    __pyx_t_23.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0618</span>:                                   <span class="n">galaxy_tree</span><span class="o">.</span><span class="n">coord_min</span><span class="p">,</span></pre>
<pre class='cython code score-3 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_galaxy_tree, __pyx_n_s_coord_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0619</span>:                                   <span class="n">galaxy_tree</span><span class="o">.</span><span class="n">dl</span><span class="p">,</span></pre>
<pre class='cython code score-13 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_galaxy_tree, __pyx_n_s_dl);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_20 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_20 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0620</span>:                                   <span class="n">galaxy_tree</span><span class="o">.</span><span class="n">shell_boundaries_xyz</span><span class="p">,</span></pre>
<pre class='cython code score-3 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_galaxy_tree, __pyx_n_s_shell_boundaries_xyz);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 620, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 620, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0621</span>:                                   <span class="n">galaxy_tree</span><span class="o">.</span><span class="n">cell_center_xyz</span><span class="p">,</span></pre>
<pre class='cython code score-3 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_galaxy_tree, __pyx_n_s_cell_center_xyz);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_22 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_22.memview)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0622</span>:                                   <span class="n">galaxy_tree</span><span class="o">.</span><span class="n">galaxy_map</span><span class="p">,</span></pre>
<pre class='cython code score-4 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_galaxy_tree, __pyx_n_s_galaxy_map);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_4vast_10voidfinder_28_voidfinder_cython_find_next_GalaxyMapCustomDict))))) <span class='error_goto'>__PYX_ERR(0, 622, __pyx_L1_error)</span>
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0623</span>:                                   <span class="n">galaxy_tree</span><span class="o">.</span><span class="n">galaxy_map_array</span><span class="p">,</span></pre>
<pre class='cython code score-3 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_galaxy_tree, __pyx_n_s_galaxy_map_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0624</span>:                                   <span class="n">galaxy_tree</span><span class="o">.</span><span class="n">w_coord</span><span class="p">,</span></pre>
<pre class='cython code score-3 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_galaxy_tree, __pyx_n_s_w_coord);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_23 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_23.memview)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0625</span>:                                   <span class="n">cell_ID_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0626</span>:                                   <span class="n">hole_center_memview</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0627</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>:         <span class="n">k1g</span> <span class="o">=</span> <span class="n">query_vals</span><span class="o">.</span><span class="n">idx</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_query_vals.idx;
    __pyx_v_k1g = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0629</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0630</span>:         <span class="n">vector_modulus</span> <span class="o">=</span> <span class="n">query_vals</span><span class="o">.</span><span class="n">dist</span></pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_query_vals.dist;
    __pyx_v_vector_modulus = __pyx_t_20;
</pre><pre class="cython line score-0">&#xA0;<span class="">0631</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0632</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0633</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0634</span>:         <span class="c"># Start Galaxy 2/B</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0635</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0636</span>:         <span class="c"># unit_vector_memview - unit vector hole propagation direction.  It </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0637</span>:         <span class="c">#     actually points TOWARDS the k1g galaxy right now since we are </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0638</span>:         <span class="c">#     doing k1g - hole_center in the calculation below</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0639</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0640</span>:         <span class="c"># modv1 - l2 norm modulus of v1_unit</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0641</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0642</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0643</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0644</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0645</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0646</span>:             <span class="n">unit_vector_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">w_coord</span><span class="p">[</span><span class="n">k1g</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">])</span><span class="o">/</span><span class="n">vector_modulus</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_k1g;
      __pyx_t_15 = __pyx_v_idx;
      __pyx_t_12 = 0;
      __pyx_t_13 = __pyx_v_idx;
      __pyx_t_17 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_unit_vector_memview.data + __pyx_t_17 * __pyx_v_unit_vector_memview.strides[0]) )) = (((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_14 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_15 * __pyx_v_w_coord.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_12 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_13 * __pyx_v_hole_center_memview.strides[1]) )))) / __pyx_v_vector_modulus);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0647</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0648</span>:         <span class="n">hole_radius</span> <span class="o">=</span> <span class="n">vector_modulus</span></pre>
<pre class='cython code score-0 '>    __pyx_v_hole_radius = __pyx_v_vector_modulus;
</pre><pre class="cython line score-0">&#xA0;<span class="">0649</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0650</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0651</span>:         <span class="c"># Make a copy of the hole center for propagation during the galaxy </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0652</span>:         <span class="c"># finding set the nearest_gal_index_list first neighbor index since we </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0653</span>:         <span class="c"># have a neighbor now</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0654</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>:         <span class="c"># Also fill in neighbor 1/A into the existing neighbor idx list</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0656</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0657</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0658</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0659</span>:             <span class="n">hole_center_2_3_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 0;
      __pyx_t_12 = __pyx_v_idx;
      __pyx_t_15 = 0;
      __pyx_t_14 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_2_3_memview.data + __pyx_t_15 * __pyx_v_hole_center_2_3_memview.strides[0]) ) + __pyx_t_14 * __pyx_v_hole_center_2_3_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_13 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_12 * __pyx_v_hole_center_memview.strides[1]) )));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0660</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0661</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0662</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0663</span>:         <span class="c"># Find galaxy 2/B</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0664</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0665</span>:         <span class="c"># Set the nearest neighbor 1 index in the list and init the in_mask to 1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0666</span>:         <span class="c"># Using direction_mod = -1.0 since the unit_vector points TOWARDS k1g</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0667</span>:         <span class="c"># as per the above calculation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0668</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0669</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>:         <span class="n">nearest_gal_index_list</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">k1g</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = 0;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_nearest_gal_index_list.data + __pyx_t_12 * __pyx_v_nearest_gal_index_list.strides[0]) )) = __pyx_v_k1g;
</pre><pre class="cython line score-0">&#xA0;<span class="">0671</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0672</span>:         <span class="n">find_next_retval</span> <span class="o">=</span> <span class="n">find_next_galaxy</span><span class="p">(</span><span class="n">hole_center_memview</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    __pyx_v_find_next_retval = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_find_next_galaxy(__pyx_v_hole_center_memview, __pyx_v_hole_center_2_3_memview, __pyx_v_hole_radius, __pyx_v_dr, -1.0, __pyx_v_unit_vector_memview, __pyx_v_galaxy_tree, __pyx_v_nearest_gal_index_list, 1, __pyx_v_w_coord, __pyx_v_mask_checker, __pyx_v_Bcenter_memview, __pyx_v_cell_ID_mem, __pyx_v_neighbor_mem);
</pre><pre class="cython line score-0">&#xA0;<span class="">0673</span>:                                              <span class="n">hole_center_2_3_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0674</span>:                                              <span class="n">hole_radius</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>:                                              <span class="n">dr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>:                                              <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0677</span>:                                              <span class="n">unit_vector_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0678</span>:                                              <span class="n">galaxy_tree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0679</span>:                                              <span class="n">nearest_gal_index_list</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0680</span>:                                              <span class="mf">1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0681</span>:                                              <span class="n">w_coord</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0682</span>:                                              <span class="n">mask_checker</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0683</span>:                                              <span class="c">#mask, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0684</span>:                                              <span class="c">#mask_resolution,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0685</span>:                                              <span class="c">#min_dist, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0686</span>:                                              <span class="c">#max_dist,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0687</span>:                                              <span class="n">Bcenter_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0688</span>:                                              <span class="n">cell_ID_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>:                                              <span class="n">neighbor_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0690</span>:                                              <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0691</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0692</span>:         <span class="n">k2g</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">nearest_neighbor_index</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_find_next_retval.nearest_neighbor_index;
    __pyx_v_k2g = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0693</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0694</span>:         <span class="n">in_mask_2</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">in_mask</span></pre>
<pre class='cython code score-0 '>    __pyx_t_24 = __pyx_v_find_next_retval.in_mask;
    __pyx_v_in_mask_2 = __pyx_t_24;
</pre><pre class="cython line score-0">&#xA0;<span class="">0695</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">in_mask_2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = ((!(__pyx_v_in_mask_2 != 0)) != 0);
    if (__pyx_t_18) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0697</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0698</span>:             <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0699</span>: <span class="sd">            out_str = &quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0700</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0701</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0702</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0703</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0704</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0705</span>: <span class="sd">            out_str += &quot; &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>: <span class="sd">            out_str += &quot;nim2&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>: <span class="sd">            out_str += &quot;\n&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0708</span>: <span class="sd">            DEBUG_OUTFILE.write(out_str)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0709</span>: <span class="sd">            &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0710</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0711</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0712</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_working_idx;
      __pyx_t_13 = 0;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_12 * __pyx_v_return_array.strides[0]) ) + __pyx_t_13 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0713</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0714</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_working_idx;
      __pyx_t_12 = 1;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_13 * __pyx_v_return_array.strides[0]) ) + __pyx_t_12 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0715</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0716</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_working_idx;
      __pyx_t_13 = 2;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_12 * __pyx_v_return_array.strides[0]) ) + __pyx_t_13 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0717</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0718</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_working_idx;
      __pyx_t_12 = 3;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_13 * __pyx_v_return_array.strides[0]) ) + __pyx_t_12 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0719</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0720</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">0721</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>:         <span class="c"># Start Galaxy 3/C</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>:         <span class="c"># When we found Galaxy 2/B, we only found the next closest neighbor as </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>:         <span class="c"># we iterated away from Galaxy 1/A.  Since we iterated by jumps of dr, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0729</span>:         <span class="c"># we may not have found the exact center of the circle formed by the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0730</span>:         <span class="c"># points k1g, k2g and the unit_vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0731</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>:         <span class="c"># Before finding Galaxy 3/C, we need to reinitialize our hole center by </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0733</span>:         <span class="c"># calculating the exact position of the center of the circle, and then </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0734</span>:         <span class="c"># check that that location is still within the mask.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0735</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0736</span>:         <span class="c"># Since we know k1g and k2g are both distance R from the center of this </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0737</span>:         <span class="c"># circle, we can use the triangle formed by k1g, k2g and the center C of </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0738</span>:         <span class="c"># the circle, to first determine the value of R.  Then, we know the hole </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0739</span>:         <span class="c"># center C is going to be along the unit_vector direction a distance of </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0740</span>:         <span class="c"># R plus the k1g location (it is actually going to be </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0741</span>:         <span class="c"># k1g - R*unit_vector below because unit_vector is pointing in the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0742</span>:         <span class="c"># opposite direction than we want).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0743</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0744</span>:         <span class="c"># The triangle formed by k1g, k2g and C has sides, R, R, and |k1g-k2g|.  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0745</span>:         <span class="c"># If we allow the side of length R formed by k1g and C to be divided </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0746</span>:         <span class="c"># into 2 parts, we end up with 2 triangles:  (k1g, k2g, x) and (C,k2g,x) </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0747</span>:         <span class="c"># who share the edge (k2g, x) which is perpendicular to the line </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0748</span>:         <span class="c"># (k1g, C).  In triangle 1, call the line (k1g,x) to have length b, and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0749</span>:         <span class="c"># b = the projection of k1g-k2g in the unit vector direction, or </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0750</span>:         <span class="c"># b = dot((k1g-k2g), unit_vector)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0751</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0752</span>:         <span class="c">#          k2g</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0753</span>:         <span class="c">#          /|-__</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0754</span>:         <span class="c"># k1g-k2g / |   -__R</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0755</span>:         <span class="c">#        /  |      -__</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0756</span>:         <span class="c">#       /___|_________-_ C</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0757</span>:         <span class="c">#   k1g   b</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0758</span>:         <span class="c">#             R</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0759</span>:         <span class="c"># By pythagorean theorem:  |k1g-k2g|^2 - b^2 = R^2 - (R-b)^2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0760</span>:         <span class="c"># We get:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0761</span>:         <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0762</span>:         <span class="c">#     R = (|k1g-k2g|^2)/(2b) = (|k1g-k2g|^2)/(2(k1g-k2g).u)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0763</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0764</span>:         <span class="c"># temp_f64_accum calculates |k1g-k2g|^2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0765</span>:         <span class="c"># temp_f64_accum2 calculates dot((k1g-k2g), unit_vector)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0766</span>:         <span class="c">#########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0767</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0768</span>:         <span class="n">temp_f64_accum</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_temp_f64_accum = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0769</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0770</span>:         <span class="n">temp_f64_accum2</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_temp_f64_accum2 = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0771</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0772</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0773</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>:             <span class="n">temp_f64_val</span> <span class="o">=</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k1g</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k2g</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_k1g;
      __pyx_t_13 = __pyx_v_idx;
      __pyx_t_14 = __pyx_v_k2g;
      __pyx_t_15 = __pyx_v_idx;
      __pyx_v_temp_f64_val = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_12 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_13 * __pyx_v_w_coord.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_14 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_15 * __pyx_v_w_coord.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0775</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0776</span>:             <span class="n">temp_f64_accum</span> <span class="o">+=</span> <span class="n">temp_f64_val</span><span class="o">*</span><span class="n">temp_f64_val</span></pre>
<pre class='cython code score-0 '>      __pyx_v_temp_f64_accum = (__pyx_v_temp_f64_accum + (__pyx_v_temp_f64_val * __pyx_v_temp_f64_val));
</pre><pre class="cython line score-0">&#xA0;<span class="">0777</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0778</span>:             <span class="n">temp_f64_accum2</span> <span class="o">+=</span> <span class="n">temp_f64_val</span><span class="o">*</span><span class="n">unit_vector_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_idx;
      __pyx_v_temp_f64_accum2 = (__pyx_v_temp_f64_accum2 + (__pyx_v_temp_f64_val * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_unit_vector_memview.data + __pyx_t_15 * __pyx_v_unit_vector_memview.strides[0]) )))));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0779</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0780</span>:         <span class="n">hole_radius</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">temp_f64_accum</span><span class="o">/</span><span class="n">temp_f64_accum2</span></pre>
<pre class='cython code score-0 '>    __pyx_v_hole_radius = ((0.5 * __pyx_v_temp_f64_accum) / __pyx_v_temp_f64_accum2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0781</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0782</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0783</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0784</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0785</span>:             <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k1g</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">hole_radius</span><span class="o">*</span><span class="n">unit_vector_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_k1g;
      __pyx_t_14 = __pyx_v_idx;
      __pyx_t_13 = __pyx_v_idx;
      __pyx_t_12 = 0;
      __pyx_t_17 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_12 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_17 * __pyx_v_hole_center_memview.strides[1]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_15 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_14 * __pyx_v_w_coord.strides[1]) ))) - (__pyx_v_hole_radius * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_unit_vector_memview.data + __pyx_t_13 * __pyx_v_unit_vector_memview.strides[0]) )))));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0786</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0788</span>:         <span class="c">#if not_in_mask(hole_center_memview, mask, mask_resolution, min_dist, max_dist):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0789</span>:         <span class="c">#if mask_check_function(hole_center_memview, mask, mask_resolution, min_dist, max_dist):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0790</span>:         <span class="k">if</span> <span class="n">mask_checker</span><span class="o">.</span><span class="n">not_in_mask</span><span class="p">(</span><span class="n">hole_center_memview</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = (((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker *)__pyx_v_mask_checker-&gt;__pyx_vtab)-&gt;not_in_mask(__pyx_v_mask_checker, __pyx_v_hole_center_memview) != 0);
    if (__pyx_t_18) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0791</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0792</span>:             <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0793</span>: <span class="sd">            out_str = &quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0794</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0795</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0796</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0797</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0798</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0799</span>: <span class="sd">            out_str += &quot; &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0800</span>: <span class="sd">            out_str += &quot;nim3&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0801</span>: <span class="sd">            out_str += &quot;\n&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0802</span>: <span class="sd">            DEBUG_OUTFILE.write(out_str)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0803</span>: <span class="sd">            &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0804</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0805</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0806</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0807</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_working_idx;
      __pyx_t_14 = 0;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_13 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0808</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0809</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_working_idx;
      __pyx_t_13 = 1;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_14 * __pyx_v_return_array.strides[0]) ) + __pyx_t_13 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0810</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0811</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_working_idx;
      __pyx_t_14 = 2;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_13 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0812</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0813</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_working_idx;
      __pyx_t_13 = 3;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_14 * __pyx_v_return_array.strides[0]) ) + __pyx_t_13 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0814</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0815</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">0816</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>:         <span class="c"># Define the new unit vector along which to move the hole center</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>:         <span class="c"># Use the line which runs through the midpoint of k1g and k2g, and the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>:         <span class="c"># center of the new circle we defined to define the new unit vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>:         <span class="c"># direction.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0824</span>:         <span class="c"># This time, the unit vector is pointing AWAY from the existing </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0825</span>:         <span class="c"># neighbors.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0828</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0829</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0830</span>:             <span class="n">midpoint_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">w_coord</span><span class="p">[</span><span class="n">k1g</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k2g</span><span class="p">,</span><span class="n">idx</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_k1g;
      __pyx_t_14 = __pyx_v_idx;
      __pyx_t_15 = __pyx_v_k2g;
      __pyx_t_17 = __pyx_v_idx;
      __pyx_t_12 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_midpoint_memview.data + __pyx_t_12 * __pyx_v_midpoint_memview.strides[0]) )) = (0.5 * ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_13 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_14 * __pyx_v_w_coord.strides[1]) ))) + (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_15 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_17 * __pyx_v_w_coord.strides[1]) )))));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0831</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0832</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0833</span>:         <span class="n">temp_f64_accum</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_temp_f64_accum = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0834</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0835</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0836</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0837</span>:             <span class="n">temp_f64_val</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">midpoint_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = 0;
      __pyx_t_15 = __pyx_v_idx;
      __pyx_t_14 = __pyx_v_idx;
      __pyx_v_temp_f64_val = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_17 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_15 * __pyx_v_hole_center_memview.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_midpoint_memview.data + __pyx_t_14 * __pyx_v_midpoint_memview.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0838</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0839</span>:             <span class="n">temp_f64_accum</span> <span class="o">+=</span> <span class="n">temp_f64_val</span><span class="o">*</span><span class="n">temp_f64_val</span></pre>
<pre class='cython code score-0 '>      __pyx_v_temp_f64_accum = (__pyx_v_temp_f64_accum + (__pyx_v_temp_f64_val * __pyx_v_temp_f64_val));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0840</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0841</span>:         <span class="n">vector_modulus</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">temp_f64_accum</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_vector_modulus = sqrt(__pyx_v_temp_f64_accum);
</pre><pre class="cython line score-0">&#xA0;<span class="">0842</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0843</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0844</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0845</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0846</span>:             <span class="n">unit_vector_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">midpoint_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span><span class="o">/</span><span class="n">vector_modulus</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = 0;
      __pyx_t_15 = __pyx_v_idx;
      __pyx_t_17 = __pyx_v_idx;
      __pyx_t_13 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_unit_vector_memview.data + __pyx_t_13 * __pyx_v_unit_vector_memview.strides[0]) )) = (((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_14 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_15 * __pyx_v_hole_center_memview.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_midpoint_memview.data + __pyx_t_17 * __pyx_v_midpoint_memview.strides[0]) )))) / __pyx_v_vector_modulus);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0847</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0848</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0849</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0850</span>:         <span class="c"># Copy the center of the circle formed by k1g and k2g that we found just </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0851</span>:         <span class="c"># a bit ago into the other memory, this will be our starting location </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0852</span>:         <span class="c"># for finding galaxy 3/C</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0853</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0854</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0855</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0856</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0857</span>:             <span class="n">hole_center_2_3_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = 0;
      __pyx_t_15 = __pyx_v_idx;
      __pyx_t_14 = 0;
      __pyx_t_13 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_2_3_memview.data + __pyx_t_14 * __pyx_v_hole_center_2_3_memview.strides[0]) ) + __pyx_t_13 * __pyx_v_hole_center_2_3_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_17 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_15 * __pyx_v_hole_center_memview.strides[1]) )));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0858</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0859</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>:         <span class="c"># Find galaxy 3/C</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>:         <span class="c"># Set neighbors 1 and 2 in the list</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0865</span>:         <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0867</span>:         <span class="n">nearest_gal_index_list</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">k1g</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = 0;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_nearest_gal_index_list.data + __pyx_t_15 * __pyx_v_nearest_gal_index_list.strides[0]) )) = __pyx_v_k1g;
</pre><pre class="cython line score-0">&#xA0;<span class="">0868</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0869</span>:         <span class="n">nearest_gal_index_list</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">k2g</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = 1;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_nearest_gal_index_list.data + __pyx_t_15 * __pyx_v_nearest_gal_index_list.strides[0]) )) = __pyx_v_k2g;
</pre><pre class="cython line score-0">&#xA0;<span class="">0870</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0871</span>:         <span class="n">find_next_retval</span> <span class="o">=</span> <span class="n">find_next_galaxy</span><span class="p">(</span><span class="n">hole_center_memview</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    __pyx_v_find_next_retval = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_find_next_galaxy(__pyx_v_hole_center_memview, __pyx_v_hole_center_2_3_memview, __pyx_v_hole_radius, __pyx_v_dr, 1.0, __pyx_v_unit_vector_memview, __pyx_v_galaxy_tree, __pyx_v_nearest_gal_index_list, 2, __pyx_v_w_coord, __pyx_v_mask_checker, __pyx_v_Bcenter_memview, __pyx_v_cell_ID_mem, __pyx_v_neighbor_mem);
</pre><pre class="cython line score-0">&#xA0;<span class="">0872</span>:                                              <span class="n">hole_center_2_3_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0873</span>:                                              <span class="n">hole_radius</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0874</span>:                                              <span class="n">dr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0875</span>:                                              <span class="mf">1.0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0876</span>:                                              <span class="n">unit_vector_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>:                                              <span class="n">galaxy_tree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>:                                              <span class="n">nearest_gal_index_list</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0879</span>:                                              <span class="mf">2</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0880</span>:                                              <span class="n">w_coord</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>:                                              <span class="n">mask_checker</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>:                                              <span class="c">#mask, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0883</span>:                                              <span class="c">#mask_resolution, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0884</span>:                                              <span class="c">#min_dist, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0885</span>:                                              <span class="c">#max_dist,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0886</span>:                                              <span class="n">Bcenter_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0887</span>:                                              <span class="n">cell_ID_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0888</span>:                                              <span class="n">neighbor_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0889</span>:                                              <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0890</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0891</span>:         <span class="n">k3g</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">nearest_neighbor_index</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_find_next_retval.nearest_neighbor_index;
    __pyx_v_k3g = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0892</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0893</span>:         <span class="n">minx3</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">min_x_ratio</span></pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_find_next_retval.min_x_ratio;
    __pyx_v_minx3 = __pyx_t_20;
</pre><pre class="cython line score-0">&#xA0;<span class="">0894</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0895</span>:         <span class="n">in_mask_3</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">in_mask</span></pre>
<pre class='cython code score-0 '>    __pyx_t_24 = __pyx_v_find_next_retval.in_mask;
    __pyx_v_in_mask_3 = __pyx_t_24;
</pre><pre class="cython line score-0">&#xA0;<span class="">0896</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0897</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">in_mask_3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = ((!(__pyx_v_in_mask_3 != 0)) != 0);
    if (__pyx_t_18) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0898</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>:             <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>: <span class="sd">            out_str = &quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0903</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0904</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0905</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0906</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0907</span>: <span class="sd">            out_str += &quot; &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0908</span>: <span class="sd">            out_str += &quot;nim4&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0909</span>: <span class="sd">            out_str += &quot;\n&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0910</span>: <span class="sd">            DEBUG_OUTFILE.write(out_str)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0911</span>: <span class="sd">            &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0912</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0913</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0914</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_working_idx;
      __pyx_t_17 = 0;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_15 * __pyx_v_return_array.strides[0]) ) + __pyx_t_17 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0915</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0916</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_working_idx;
      __pyx_t_15 = 1;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_17 * __pyx_v_return_array.strides[0]) ) + __pyx_t_15 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0917</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0918</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_working_idx;
      __pyx_t_17 = 2;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_15 * __pyx_v_return_array.strides[0]) ) + __pyx_t_17 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0919</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0920</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_working_idx;
      __pyx_t_15 = 3;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_17 * __pyx_v_return_array.strides[0]) ) + __pyx_t_15 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0921</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0922</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">0923</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0925</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0926</span>:         <span class="c"># Start Galaxy 4/D-1 (galaxy 4/D takes 2 attempts)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0927</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0928</span>:         <span class="c"># Process is very similar as before, except we do not know if we have to </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>:         <span class="c"># move above or below the plane.  Therefore, we will find the next </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>:         <span class="c"># closest if we move above the plane, and the next closest if we move </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>:         <span class="c"># below the plane.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>:         <span class="c"># Update hole center</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>:         <span class="c"># update hole radius</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0937</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0938</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0939</span>:             <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">minx3</span><span class="o">*</span><span class="n">unit_vector_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_idx;
      __pyx_t_17 = 0;
      __pyx_t_13 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_17 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_13 * __pyx_v_hole_center_memview.strides[1]) )) += (__pyx_v_minx3 * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_unit_vector_memview.data + __pyx_t_15 * __pyx_v_unit_vector_memview.strides[0]) ))));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0940</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0941</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0942</span>:         <span class="n">temp_f64_accum</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_temp_f64_accum = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0943</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0944</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0945</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0946</span>:             <span class="n">temp_f64_val</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k1g</span><span class="p">,</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = 0;
      __pyx_t_13 = __pyx_v_idx;
      __pyx_t_17 = __pyx_v_k1g;
      __pyx_t_14 = __pyx_v_idx;
      __pyx_v_temp_f64_val = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_15 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_13 * __pyx_v_hole_center_memview.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_17 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_14 * __pyx_v_w_coord.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0947</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0948</span>:             <span class="n">temp_f64_accum</span> <span class="o">+=</span> <span class="n">temp_f64_val</span><span class="o">*</span><span class="n">temp_f64_val</span></pre>
<pre class='cython code score-0 '>      __pyx_v_temp_f64_accum = (__pyx_v_temp_f64_accum + (__pyx_v_temp_f64_val * __pyx_v_temp_f64_val));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0949</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0950</span>:         <span class="n">hole_radius</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">temp_f64_accum</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_hole_radius = sqrt(__pyx_v_temp_f64_accum);
</pre><pre class="cython line score-0">&#xA0;<span class="">0951</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>:         <span class="c">#if not_in_mask(hole_center_memview, mask, mask_resolution, min_dist, max_dist):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0954</span>:         <span class="k">if</span> <span class="n">mask_checker</span><span class="o">.</span><span class="n">not_in_mask</span><span class="p">(</span><span class="n">hole_center_memview</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = (((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker *)__pyx_v_mask_checker-&gt;__pyx_vtab)-&gt;not_in_mask(__pyx_v_mask_checker, __pyx_v_hole_center_memview) != 0);
    if (__pyx_t_18) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0955</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>:             <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: <span class="sd">            out_str = &quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>: <span class="sd">            out_str += &quot; &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>: <span class="sd">            out_str += &quot;nim5&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>: <span class="sd">            out_str += &quot;\n&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>: <span class="sd">            DEBUG_OUTFILE.write(out_str)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0967</span>: <span class="sd">            &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0968</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0971</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_working_idx;
      __pyx_t_17 = 0;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_14 * __pyx_v_return_array.strides[0]) ) + __pyx_t_17 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0972</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0973</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_working_idx;
      __pyx_t_14 = 1;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_17 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0974</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0975</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_working_idx;
      __pyx_t_17 = 2;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_14 * __pyx_v_return_array.strides[0]) ) + __pyx_t_17 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0976</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0977</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_working_idx;
      __pyx_t_14 = 3;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_17 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">0978</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0979</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">0980</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0981</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0982</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0983</span>:         <span class="c"># The vector along which to move the hole center is defined by the cross </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>:         <span class="c"># product of the vectors pointing between the three nearest galaxies.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>:         <span class="c"># Calculate the cross product of the difference vectors, calculate the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>:         <span class="c"># modulus of that vector and normalize to a unit vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>:         <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0990</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0991</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0992</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0993</span>:             <span class="n">AB_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k1g</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k2g</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_k1g;
      __pyx_t_17 = __pyx_v_idx;
      __pyx_t_13 = __pyx_v_k2g;
      __pyx_t_15 = __pyx_v_idx;
      __pyx_t_12 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_AB_memview.data + __pyx_t_12 * __pyx_v_AB_memview.strides[0]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_14 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_17 * __pyx_v_w_coord.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_13 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_15 * __pyx_v_w_coord.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0994</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0995</span>:             <span class="n">BC_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k3g</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k2g</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_k3g;
      __pyx_t_13 = __pyx_v_idx;
      __pyx_t_17 = __pyx_v_k2g;
      __pyx_t_14 = __pyx_v_idx;
      __pyx_t_12 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_BC_memview.data + __pyx_t_12 * __pyx_v_BC_memview.strides[0]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_15 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_13 * __pyx_v_w_coord.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_17 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_14 * __pyx_v_w_coord.strides[1]) ))));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0996</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0998</span>:         <span class="n">v3_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">AB_memview</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">BC_memview</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">AB_memview</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">BC_memview</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = 1;
    __pyx_t_17 = 2;
    __pyx_t_13 = 2;
    __pyx_t_15 = 1;
    __pyx_t_12 = 0;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_v3_memview.data + __pyx_t_12 * __pyx_v_v3_memview.strides[0]) )) = (((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_AB_memview.data + __pyx_t_14 * __pyx_v_AB_memview.strides[0]) ))) * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_BC_memview.data + __pyx_t_17 * __pyx_v_BC_memview.strides[0]) )))) - ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_AB_memview.data + __pyx_t_13 * __pyx_v_AB_memview.strides[0]) ))) * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_BC_memview.data + __pyx_t_15 * __pyx_v_BC_memview.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0999</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1000</span>:         <span class="n">v3_memview</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">AB_memview</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="o">*</span><span class="n">BC_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">AB_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">BC_memview</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = 2;
    __pyx_t_13 = 0;
    __pyx_t_17 = 0;
    __pyx_t_14 = 2;
    __pyx_t_12 = 1;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_v3_memview.data + __pyx_t_12 * __pyx_v_v3_memview.strides[0]) )) = (((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_AB_memview.data + __pyx_t_15 * __pyx_v_AB_memview.strides[0]) ))) * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_BC_memview.data + __pyx_t_13 * __pyx_v_BC_memview.strides[0]) )))) - ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_AB_memview.data + __pyx_t_17 * __pyx_v_AB_memview.strides[0]) ))) * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_BC_memview.data + __pyx_t_14 * __pyx_v_BC_memview.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1001</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1002</span>:         <span class="n">v3_memview</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">AB_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">*</span><span class="n">BC_memview</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">AB_memview</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="o">*</span><span class="n">BC_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = 0;
    __pyx_t_17 = 1;
    __pyx_t_13 = 1;
    __pyx_t_15 = 0;
    __pyx_t_12 = 2;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_v3_memview.data + __pyx_t_12 * __pyx_v_v3_memview.strides[0]) )) = (((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_AB_memview.data + __pyx_t_14 * __pyx_v_AB_memview.strides[0]) ))) * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_BC_memview.data + __pyx_t_17 * __pyx_v_BC_memview.strides[0]) )))) - ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_AB_memview.data + __pyx_t_13 * __pyx_v_AB_memview.strides[0]) ))) * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_BC_memview.data + __pyx_t_15 * __pyx_v_BC_memview.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1003</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1004</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1005</span>:         <span class="n">temp_f64_accum</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_temp_f64_accum = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1006</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1007</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1008</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1009</span>:             <span class="n">temp_f64_accum</span> <span class="o">+=</span> <span class="n">v3_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">*</span><span class="n">v3_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_idx;
      __pyx_t_13 = __pyx_v_idx;
      __pyx_v_temp_f64_accum = (__pyx_v_temp_f64_accum + ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_v3_memview.data + __pyx_t_15 * __pyx_v_v3_memview.strides[0]) ))) * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_v3_memview.data + __pyx_t_13 * __pyx_v_v3_memview.strides[0]) )))));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1010</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1011</span>:         <span class="n">vector_modulus</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">temp_f64_accum</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_vector_modulus = sqrt(__pyx_v_temp_f64_accum);
</pre><pre class="cython line score-0">&#xA0;<span class="">1012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1013</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1014</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1015</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1016</span>:             <span class="n">unit_vector_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">v3_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">vector_modulus</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_idx;
      __pyx_t_15 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_unit_vector_memview.data + __pyx_t_15 * __pyx_v_unit_vector_memview.strides[0]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_v3_memview.data + __pyx_t_13 * __pyx_v_v3_memview.strides[0]) ))) / __pyx_v_vector_modulus);
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1018</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>:         <span class="c"># Calculate vector pointing from the hole center to the neighbor 1/A</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1020</span>:         <span class="c"># Calculate vector pointing from the hole center to the neighbor 2/B</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1021</span>:         <span class="c"># Update new hole center for propagation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1022</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1023</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1024</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1025</span>:             <span class="n">hole_center_41_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 0;
      __pyx_t_15 = __pyx_v_idx;
      __pyx_t_17 = 0;
      __pyx_t_14 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_41_memview.data + __pyx_t_17 * __pyx_v_hole_center_41_memview.strides[0]) ) + __pyx_t_14 * __pyx_v_hole_center_41_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_13 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_15 * __pyx_v_hole_center_memview.strides[1]) )));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1027</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1028</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1029</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1030</span>:         <span class="c"># Find galaxy 4/D-1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1031</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1032</span>:         <span class="c"># update the exiting neighbors 1/A, 2/B and 3/C in the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1033</span>:         <span class="c"># nearest_gal_index_list</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1034</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1035</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1036</span>:         <span class="n">nearest_gal_index_list</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">k1g</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = 0;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_nearest_gal_index_list.data + __pyx_t_15 * __pyx_v_nearest_gal_index_list.strides[0]) )) = __pyx_v_k1g;
</pre><pre class="cython line score-0">&#xA0;<span class="">1037</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1038</span>:         <span class="n">nearest_gal_index_list</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">k2g</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = 1;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_nearest_gal_index_list.data + __pyx_t_15 * __pyx_v_nearest_gal_index_list.strides[0]) )) = __pyx_v_k2g;
</pre><pre class="cython line score-0">&#xA0;<span class="">1039</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1040</span>:         <span class="n">nearest_gal_index_list</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">k3g</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = 2;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t *) ( /* dim=0 */ (__pyx_v_nearest_gal_index_list.data + __pyx_t_15 * __pyx_v_nearest_gal_index_list.strides[0]) )) = __pyx_v_k3g;
</pre><pre class="cython line score-0">&#xA0;<span class="">1041</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1042</span>:         <span class="n">find_next_retval</span> <span class="o">=</span> <span class="n">find_next_galaxy</span><span class="p">(</span><span class="n">hole_center_memview</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    __pyx_v_find_next_retval = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_find_next_galaxy(__pyx_v_hole_center_memview, __pyx_v_hole_center_41_memview, __pyx_v_hole_radius, __pyx_v_dr, 1.0, __pyx_v_unit_vector_memview, __pyx_v_galaxy_tree, __pyx_v_nearest_gal_index_list, 3, __pyx_v_w_coord, __pyx_v_mask_checker, __pyx_v_Bcenter_memview, __pyx_v_cell_ID_mem, __pyx_v_neighbor_mem);
</pre><pre class="cython line score-0">&#xA0;<span class="">1043</span>:                                              <span class="n">hole_center_41_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1044</span>:                                              <span class="n">hole_radius</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1045</span>:                                              <span class="n">dr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1046</span>:                                              <span class="mf">1.0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1047</span>:                                              <span class="n">unit_vector_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1048</span>:                                              <span class="n">galaxy_tree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1049</span>:                                              <span class="n">nearest_gal_index_list</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1050</span>:                                              <span class="mf">3</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1051</span>:                                              <span class="n">w_coord</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1052</span>:                                              <span class="n">mask_checker</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1053</span>:                                              <span class="c">#mask, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1054</span>:                                              <span class="c">#mask_resolution,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1055</span>:                                              <span class="c">#min_dist, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1056</span>:                                              <span class="c">#max_dist,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1057</span>:                                              <span class="n">Bcenter_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1058</span>:                                              <span class="n">cell_ID_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1059</span>:                                              <span class="n">neighbor_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1060</span>:                                              <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1061</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1062</span>:         <span class="n">k4g1</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">nearest_neighbor_index</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_find_next_retval.nearest_neighbor_index;
    __pyx_v_k4g1 = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1063</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1064</span>:         <span class="n">minx41</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">min_x_ratio</span></pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_find_next_retval.min_x_ratio;
    __pyx_v_minx41 = __pyx_t_20;
</pre><pre class="cython line score-0">&#xA0;<span class="">1065</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1066</span>:         <span class="n">in_mask_41</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">in_mask</span></pre>
<pre class='cython code score-0 '>    __pyx_t_24 = __pyx_v_find_next_retval.in_mask;
    __pyx_v_in_mask_41 = __pyx_t_24;
</pre><pre class="cython line score-0">&#xA0;<span class="">1067</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1068</span>:         <span class="c"># Calculate potential new hole center</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1069</span>:         <span class="k">if</span> <span class="n">in_mask_41</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = (__pyx_v_in_mask_41 != 0);
    if (__pyx_t_18) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1070</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1071</span>:             <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
        __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1072</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1073</span>:                 <span class="n">hole_center_41_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">minx41</span><span class="o">*</span><span class="n">unit_vector_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = 0;
        __pyx_t_13 = __pyx_v_idx;
        __pyx_t_14 = __pyx_v_idx;
        __pyx_t_17 = 0;
        __pyx_t_12 = __pyx_v_idx;
        *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_41_memview.data + __pyx_t_17 * __pyx_v_hole_center_41_memview.strides[0]) ) + __pyx_t_12 * __pyx_v_hole_center_41_memview.strides[1]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_15 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_13 * __pyx_v_hole_center_memview.strides[1]) ))) + (__pyx_v_minx41 * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_unit_vector_memview.data + __pyx_t_14 * __pyx_v_unit_vector_memview.strides[0]) )))));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1074</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1075</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1076</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1077</span>:         <span class="c"># Start galaxy 4/D-2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1078</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1079</span>:         <span class="c"># Repeat same search, but shift the hole center in the other direction </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1080</span>:         <span class="c"># this time, so flip the v3_unit_memview in other direction.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1081</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1082</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1083</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1084</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1085</span>:             <span class="n">unit_vector_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">1.0</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_unit_vector_memview.data + __pyx_t_14 * __pyx_v_unit_vector_memview.strides[0]) )) *= -1.0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1086</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1087</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1088</span>:         <span class="n">minx42</span> <span class="o">=</span> <span class="n">INFINITY</span></pre>
<pre class='cython code score-0 '>    __pyx_v_minx42 = NPY_INFINITY;
</pre><pre class="cython line score-0">&#xA0;<span class="">1089</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1090</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1091</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1092</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1093</span>:             <span class="n">hole_center_42_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = 0;
      __pyx_t_13 = __pyx_v_idx;
      __pyx_t_15 = 0;
      __pyx_t_12 = __pyx_v_idx;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_42_memview.data + __pyx_t_15 * __pyx_v_hole_center_42_memview.strides[0]) ) + __pyx_t_12 * __pyx_v_hole_center_42_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_14 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_13 * __pyx_v_hole_center_memview.strides[1]) )));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1094</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1095</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1096</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1097</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1098</span>:         <span class="c"># Find galaxy 4/D-2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1099</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1100</span>:         <span class="c"># nearest_neighbor_gal_list already updated from galaxy 4/D-1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1101</span>:         <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1102</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1103</span>:         <span class="n">find_next_retval</span> <span class="o">=</span> <span class="n">find_next_galaxy</span><span class="p">(</span><span class="n">hole_center_memview</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    __pyx_v_find_next_retval = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_find_next_galaxy(__pyx_v_hole_center_memview, __pyx_v_hole_center_42_memview, __pyx_v_hole_radius, __pyx_v_dr, 1.0, __pyx_v_unit_vector_memview, __pyx_v_galaxy_tree, __pyx_v_nearest_gal_index_list, 3, __pyx_v_w_coord, __pyx_v_mask_checker, __pyx_v_Bcenter_memview, __pyx_v_cell_ID_mem, __pyx_v_neighbor_mem);
</pre><pre class="cython line score-0">&#xA0;<span class="">1104</span>:                                              <span class="n">hole_center_42_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1105</span>:                                              <span class="n">hole_radius</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1106</span>:                                              <span class="n">dr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1107</span>:                                              <span class="mf">1.0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1108</span>:                                              <span class="n">unit_vector_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1109</span>:                                              <span class="n">galaxy_tree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1110</span>:                                              <span class="n">nearest_gal_index_list</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1111</span>:                                              <span class="mf">3</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1112</span>:                                              <span class="n">w_coord</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1113</span>:                                              <span class="n">mask_checker</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1114</span>:                                              <span class="c">#mask, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1115</span>:                                              <span class="c">#mask_resolution,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1116</span>:                                              <span class="c">#min_dist, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1117</span>:                                              <span class="c">#max_dist,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1118</span>:                                              <span class="n">Bcenter_memview</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1119</span>:                                              <span class="n">cell_ID_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1120</span>:                                              <span class="n">neighbor_mem</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1121</span>:                                              <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1122</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1123</span>:         <span class="n">k4g2</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">nearest_neighbor_index</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_find_next_retval.nearest_neighbor_index;
    __pyx_v_k4g2 = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1124</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1125</span>:         <span class="n">minx42</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">min_x_ratio</span></pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_find_next_retval.min_x_ratio;
    __pyx_v_minx42 = __pyx_t_20;
</pre><pre class="cython line score-0">&#xA0;<span class="">1126</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1127</span>:         <span class="n">in_mask_42</span> <span class="o">=</span> <span class="n">find_next_retval</span><span class="o">.</span><span class="n">in_mask</span></pre>
<pre class='cython code score-0 '>    __pyx_t_24 = __pyx_v_find_next_retval.in_mask;
    __pyx_v_in_mask_42 = __pyx_t_24;
</pre><pre class="cython line score-0">&#xA0;<span class="">1128</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1129</span>:         <span class="c"># Calculate potential new hole center</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1130</span>:         <span class="k">if</span> <span class="n">in_mask_42</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = (__pyx_v_in_mask_42 != 0);
    if (__pyx_t_18) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1131</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1132</span>:             <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
        __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1133</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1134</span>:                 <span class="n">hole_center_42_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">minx42</span><span class="o">*</span><span class="n">unit_vector_memview</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_13 = 0;
        __pyx_t_14 = __pyx_v_idx;
        __pyx_t_12 = __pyx_v_idx;
        __pyx_t_15 = 0;
        __pyx_t_17 = __pyx_v_idx;
        *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_42_memview.data + __pyx_t_15 * __pyx_v_hole_center_42_memview.strides[0]) ) + __pyx_t_17 * __pyx_v_hole_center_42_memview.strides[1]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_13 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_14 * __pyx_v_hole_center_memview.strides[1]) ))) + (__pyx_v_minx42 * (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=0 */ (__pyx_v_unit_vector_memview.data + __pyx_t_12 * __pyx_v_unit_vector_memview.strides[0]) )))));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1135</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1136</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1137</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1138</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1139</span>:         <span class="c"># Figure out whether galaxy 4/D is 4/D-1 or 4/D-2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1140</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1141</span>:         <span class="c"># Use the minx41 and minx42 variables to figure out which one is closer?</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1142</span>:         <span class="c"># Then set the 4th galaxy index based on that and update the output hole </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1143</span>:         <span class="c"># center based on that.  Or, if the conditions are not filled because we </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1144</span>:         <span class="c"># left the survey, return NAN output</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1145</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1146</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1147</span>:         <span class="c">#not_in_mask_41 = not_in_mask(hole_center_41_memview, mask, mask_resolution, min_dist, max_dist)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1148</span>:         <span class="n">not_in_mask_41</span> <span class="o">=</span> <span class="n">mask_checker</span><span class="o">.</span><span class="n">not_in_mask</span><span class="p">(</span><span class="n">hole_center_41_memview</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_not_in_mask_41 = ((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker *)__pyx_v_mask_checker-&gt;__pyx_vtab)-&gt;not_in_mask(__pyx_v_mask_checker, __pyx_v_hole_center_41_memview);
</pre><pre class="cython line score-0">&#xA0;<span class="">1149</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1150</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">not_in_mask_41</span> <span class="ow">and</span> <span class="n">minx41</span> <span class="o">&lt;=</span> <span class="n">minx42</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_25 = ((!(__pyx_v_not_in_mask_41 != 0)) != 0);
    if (__pyx_t_25) {
    } else {
      __pyx_t_18 = __pyx_t_25;
      goto __pyx_L53_bool_binop_done;
    }
    __pyx_t_25 = ((__pyx_v_minx41 &lt;= __pyx_v_minx42) != 0);
    __pyx_t_18 = __pyx_t_25;
    __pyx_L53_bool_binop_done:;
    if (__pyx_t_18) {
/* … */
      goto __pyx_L52;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1151</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1152</span>:             <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
        __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1153</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1154</span>:                 <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_41_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_12 = 0;
        __pyx_t_14 = __pyx_v_idx;
        __pyx_t_13 = 0;
        __pyx_t_17 = __pyx_v_idx;
        *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_13 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_17 * __pyx_v_hole_center_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_41_memview.data + __pyx_t_12 * __pyx_v_hole_center_41_memview.strides[0]) ) + __pyx_t_14 * __pyx_v_hole_center_41_memview.strides[1]) )));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1155</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1156</span>:             <span class="n">k4g</span> <span class="o">=</span> <span class="n">k4g1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_k4g = __pyx_v_k4g1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1157</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1158</span>:         <span class="c">#elif not not_in_mask(hole_center_42_memview, mask, mask_resolution, min_dist, max_dist):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1159</span>:         <span class="k">elif</span> <span class="ow">not</span> <span class="n">mask_checker</span><span class="o">.</span><span class="n">not_in_mask</span><span class="p">(</span><span class="n">hole_center_42_memview</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = ((!(((struct __pyx_vtabstruct_4vast_10voidfinder_28_voidfinder_cython_find_next_MaskChecker *)__pyx_v_mask_checker-&gt;__pyx_vtab)-&gt;not_in_mask(__pyx_v_mask_checker, __pyx_v_hole_center_42_memview) != 0)) != 0);
    if (__pyx_t_18) {
/* … */
      goto __pyx_L52;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1160</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1161</span>:             <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
        __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1162</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1163</span>:                 <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_42_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_14 = 0;
        __pyx_t_12 = __pyx_v_idx;
        __pyx_t_17 = 0;
        __pyx_t_13 = __pyx_v_idx;
        *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_17 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_13 * __pyx_v_hole_center_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_42_memview.data + __pyx_t_14 * __pyx_v_hole_center_42_memview.strides[0]) ) + __pyx_t_12 * __pyx_v_hole_center_42_memview.strides[1]) )));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1164</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1165</span>:             <span class="n">k4g</span> <span class="o">=</span> <span class="n">k4g2</span></pre>
<pre class='cython code score-0 '>      __pyx_v_k4g = __pyx_v_k4g2;
</pre><pre class="cython line score-0">&#xA0;<span class="">1166</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1167</span>:         <span class="k">elif</span> <span class="ow">not</span> <span class="n">not_in_mask_41</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_18 = ((!(__pyx_v_not_in_mask_41 != 0)) != 0);
    if (__pyx_t_18) {
/* … */
      goto __pyx_L52;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1168</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1169</span>:             <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
        __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1170</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1171</span>:                 <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_41_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_12 = 0;
        __pyx_t_14 = __pyx_v_idx;
        __pyx_t_13 = 0;
        __pyx_t_17 = __pyx_v_idx;
        *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_13 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_17 * __pyx_v_hole_center_memview.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_41_memview.data + __pyx_t_12 * __pyx_v_hole_center_41_memview.strides[0]) ) + __pyx_t_14 * __pyx_v_hole_center_41_memview.strides[1]) )));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1172</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1173</span>:             <span class="n">k4g</span> <span class="o">=</span> <span class="n">k4g1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_k4g = __pyx_v_k4g1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1174</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1175</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1176</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1177</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1178</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1179</span>:             <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
</pre><pre class="cython line score-0">&#xA0;<span class="">1180</span>: <span class="sd">            out_str = &quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1181</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1182</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1183</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1184</span>: <span class="sd">            out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1185</span>: <span class="sd">            out_str += str(i_j_k_array[working_idx, 2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1186</span>: <span class="sd">            out_str += &quot; &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1187</span>: <span class="sd">            out_str += &quot;nim6&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1188</span>: <span class="sd">            out_str += &quot;\n&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1189</span>: <span class="sd">            DEBUG_OUTFILE.write(out_str)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1190</span>: <span class="sd">            &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1192</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1193</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1194</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_working_idx;
      __pyx_t_12 = 0;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_14 * __pyx_v_return_array.strides[0]) ) + __pyx_t_12 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">1195</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1196</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_working_idx;
      __pyx_t_14 = 1;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_12 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">1197</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1198</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_working_idx;
      __pyx_t_12 = 2;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_14 * __pyx_v_return_array.strides[0]) ) + __pyx_t_12 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">1199</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1200</span>:             <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">NAN</span></pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_working_idx;
      __pyx_t_14 = 3;
      *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_12 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = NPY_NAN;
</pre><pre class="cython line score-0">&#xA0;<span class="">1201</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1202</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
    }
    __pyx_L52:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1203</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1204</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1205</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1206</span>:         <span class="c"># Now that we have all 4 bounding galaxies, calculate the hole radius</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1207</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1208</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1209</span>:         <span class="n">temp_f64_accum</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_temp_f64_accum = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1210</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1211</span>:         <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
      __pyx_v_idx = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1212</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1213</span>:             <span class="n">temp_f64_val</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">w_coord</span><span class="p">[</span><span class="n">k1g</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = 0;
      __pyx_t_12 = __pyx_v_idx;
      __pyx_t_17 = __pyx_v_k1g;
      __pyx_t_13 = __pyx_v_idx;
      __pyx_v_temp_f64_val = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_14 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_12 * __pyx_v_hole_center_memview.strides[1]) ))) - (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w_coord.data + __pyx_t_17 * __pyx_v_w_coord.strides[0]) ) + __pyx_t_13 * __pyx_v_w_coord.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1214</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1215</span>:             <span class="n">temp_f64_accum</span> <span class="o">+=</span> <span class="n">temp_f64_val</span><span class="o">*</span><span class="n">temp_f64_val</span></pre>
<pre class='cython code score-0 '>      __pyx_v_temp_f64_accum = (__pyx_v_temp_f64_accum + (__pyx_v_temp_f64_val * __pyx_v_temp_f64_val));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1216</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1217</span>:         <span class="n">hole_radius</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">temp_f64_accum</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_hole_radius = sqrt(__pyx_v_temp_f64_accum);
</pre><pre class="cython line score-0">&#xA0;<span class="">1218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1219</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1220</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1223</span>:         <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1224</span>:         <span class="c"># DEPRECATED</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1225</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1226</span>:         <span class="c"># Finally, check 6 directions: +/- x,y,z with a proportion of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1227</span>:         <span class="c"># radius to see if too much of this hole falls outside the mask</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1228</span>:         <span class="c"># (This implements the &quot;If 10% falls outside the mask, discard hole&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1229</span>:         <span class="c"># check)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1230</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1231</span>:         <span class="c"># re-using hole_center_42_memview as empty memory</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1232</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1233</span>:         <span class="c"># We are removing this function and making a new implementation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1234</span>:         <span class="c"># outside of the _voidfinder_cython.main_algorithm </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1235</span>:         <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1236</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1237</span>:         <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1238</span>: <span class="sd">        discard_mask_overlap = check_mask_overlap(hole_center_memview,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1239</span>: <span class="sd">                                                  hole_center_42_memview,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>: <span class="sd">                                                   hole_radial_mask_check_dist,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1241</span>: <span class="sd">                                                   hole_radius,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>: <span class="sd">                                                   mask, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1243</span>: <span class="sd">                                                   mask_resolution, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>: <span class="sd">                                                   min_dist, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>: <span class="sd">                                                   max_dist)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1246</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>: <span class="sd">        if discard_mask_overlap:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1248</span>: <span class="sd">            </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1249</span>: <span class="sd">            return_array[working_idx, 0] = NAN</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1250</span>: <span class="sd">            </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1251</span>: <span class="sd">            return_array[working_idx, 1] = NAN</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1252</span>: <span class="sd">            </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1253</span>: <span class="sd">            return_array[working_idx, 2] = NAN</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1254</span>: <span class="sd">            </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1255</span>: <span class="sd">            return_array[working_idx, 3] = NAN</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1256</span>: <span class="sd">            </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1257</span>: <span class="sd">            continue</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1258</span>: <span class="sd">        &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1259</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1260</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1261</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1262</span>:         <span class="c"># Passed all checks, write the valid (x,y,z,r) values!</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1263</span>:         <span class="c">########################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1264</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1265</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1266</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1267</span>:         <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = 0;
    __pyx_t_17 = 0;
    __pyx_t_12 = __pyx_v_working_idx;
    __pyx_t_14 = 0;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_12 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_13 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_17 * __pyx_v_hole_center_memview.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1268</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1269</span>:         <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = 0;
    __pyx_t_13 = 1;
    __pyx_t_14 = __pyx_v_working_idx;
    __pyx_t_12 = 1;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_14 * __pyx_v_return_array.strides[0]) ) + __pyx_t_12 * __pyx_v_return_array.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_17 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_13 * __pyx_v_hole_center_memview.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1270</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1271</span>:         <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_center_memview</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = 0;
    __pyx_t_17 = 2;
    __pyx_t_12 = __pyx_v_working_idx;
    __pyx_t_14 = 2;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_12 * __pyx_v_return_array.strides[0]) ) + __pyx_t_14 * __pyx_v_return_array.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hole_center_memview.data + __pyx_t_13 * __pyx_v_hole_center_memview.strides[0]) ) + __pyx_t_17 * __pyx_v_hole_center_memview.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1272</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1273</span>:         <span class="n">return_array</span><span class="p">[</span><span class="n">working_idx</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">hole_radius</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_working_idx;
    __pyx_t_13 = 3;
    *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_return_array.data + __pyx_t_17 * __pyx_v_return_array.strides[0]) ) + __pyx_t_13 * __pyx_v_return_array.strides[1]) )) = __pyx_v_hole_radius;
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1274</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1275</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1276</span>:         <span class="sd">&#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1277</span>: <span class="sd">        out_str = &quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1278</span>: <span class="sd">        out_str += str(i_j_k_array[working_idx, 0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1279</span>: <span class="sd">        out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1280</span>: <span class="sd">        out_str += str(i_j_k_array[working_idx, 1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1281</span>: <span class="sd">        out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1282</span>: <span class="sd">        out_str += str(i_j_k_array[working_idx, 2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1283</span>: <span class="sd">        out_str += &quot; &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1284</span>: <span class="sd">        out_str += &quot;hole&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1285</span>: <span class="sd">        out_str += &quot; &quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1286</span>: <span class="sd">        out_str += str(hole_center_memview[0, 0])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1287</span>: <span class="sd">        out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1288</span>: <span class="sd">        out_str += str(hole_center_memview[0, 1])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1289</span>: <span class="sd">        out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1290</span>: <span class="sd">        out_str += str(hole_center_memview[0, 2])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1291</span>: <span class="sd">        out_str += &quot;,&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1292</span>: <span class="sd">        out_str += str(hole_radius)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1293</span>: <span class="sd">        out_str += &quot;\n&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1294</span>: <span class="sd">        DEBUG_OUTFILE.write(out_str)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1295</span>: <span class="sd">        &#39;&#39;&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1296</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1297</span>:     <span class="c">#DEBUG_OUTFILE.close()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1298</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1299</span>:     <span class="k">return</span></pre>
<pre class='cython code score-0 '>  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1300</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1302</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1303</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1304</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1305</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1306</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1307</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-117" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1308</span>: <span class="k">cpdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">check_mask_overlap</span><span class="p">(</span><span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">coordinates</span><span class="p">,</span></pre>
<pre class='cython code score-117 '>static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_7check_mask_overlap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_f_4vast_10voidfinder_18_voidfinder_cython_check_mask_overlap(__Pyx_memviewslice __pyx_v_coordinates, __Pyx_memviewslice __pyx_v_temp_coordinates, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_hole_radial_mask_check_dist, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_hole_radius, __Pyx_memviewslice __pyx_v_mask, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT32_t __pyx_v_mask_resolution, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_dist, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_max_dist, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_v_discard;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_check_dist;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_mask_overlap", 0);
  <span class='trace'>__Pyx_TraceCall</span>("check_mask_overlap", __pyx_f[0], 1308, 0, <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("vast.voidfinder._voidfinder_cython.check_mask_overlap", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_7check_mask_overlap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_7check_mask_overlap(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_coordinates = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_temp_coordinates = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_hole_radial_mask_check_dist;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_hole_radius;
  __Pyx_memviewslice __pyx_v_mask = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT32_t __pyx_v_mask_resolution;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_dist;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_max_dist;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_mask_overlap (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_coordinates,&amp;__pyx_n_s_temp_coordinates,&amp;__pyx_n_s_hole_radial_mask_check_dist,&amp;__pyx_n_s_hole_radius,&amp;__pyx_n_s_mask,&amp;__pyx_n_s_mask_resolution,&amp;__pyx_n_s_min_dist,&amp;__pyx_n_s_max_dist,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_coordinates)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_temp_coordinates)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("check_mask_overlap", 1, 8, 8, 1); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_hole_radial_mask_check_dist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("check_mask_overlap", 1, 8, 8, 2); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_hole_radius)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("check_mask_overlap", 1, 8, 8, 3); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mask)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("check_mask_overlap", 1, 8, 8, 4); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mask_resolution)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("check_mask_overlap", 1, 8, 8, 5); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_dist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("check_mask_overlap", 1, 8, 8, 6); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_dist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("check_mask_overlap", 1, 8, 8, 7); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "check_mask_overlap") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_coordinates = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_coordinates.memview)) __PYX_ERR(0, 1308, __pyx_L3_error)</span>
    __pyx_v_temp_coordinates = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_temp_coordinates.memview)) __PYX_ERR(0, 1309, __pyx_L3_error)</span>
    __pyx_v_hole_radial_mask_check_dist = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_hole_radial_mask_check_dist == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1310, __pyx_L3_error)</span>
    __pyx_v_hole_radius = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_hole_radius == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L3_error)</span>
    __pyx_v_mask = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_mask.memview)) __PYX_ERR(0, 1312, __pyx_L3_error)</span>
    __pyx_v_mask_resolution = __Pyx_PyInt_As_npy_int32(values[5]); if (unlikely((__pyx_v_mask_resolution == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1313, __pyx_L3_error)</span>
    __pyx_v_min_dist = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]); if (unlikely((__pyx_v_min_dist == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1314, __pyx_L3_error)</span>
    __pyx_v_max_dist = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[7]); if (unlikely((__pyx_v_max_dist == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1315, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("check_mask_overlap", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.check_mask_overlap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4vast_10voidfinder_18_voidfinder_cython_6check_mask_overlap(__pyx_self, __pyx_v_coordinates, __pyx_v_temp_coordinates, __pyx_v_hole_radial_mask_check_dist, __pyx_v_hole_radius, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_18_voidfinder_cython_6check_mask_overlap(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_coordinates, __Pyx_memviewslice __pyx_v_temp_coordinates, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_hole_radial_mask_check_dist, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_hole_radius, __Pyx_memviewslice __pyx_v_mask, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT32_t __pyx_v_mask_resolution, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_dist, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_max_dist) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_mask_overlap", 0);
  <span class='trace'>__Pyx_TraceCall</span>("check_mask_overlap (wrapper)", __pyx_f[0], 1308, 0, <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_coordinates.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("coordinates"); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_temp_coordinates.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("temp_coordinates"); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_mask.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("mask"); <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_PyInt_From_npy_uint8(__pyx_f_4vast_10voidfinder_18_voidfinder_cython_check_mask_overlap(__pyx_v_coordinates, __pyx_v_temp_coordinates, __pyx_v_hole_radial_mask_check_dist, __pyx_v_hole_radius, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.check_mask_overlap", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_coordinates, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_temp_coordinates, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mask, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1309</span>:                                   <span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">temp_coordinates</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1310</span>:                                   <span class="n">DTYPE_F64_t</span> <span class="n">hole_radial_mask_check_dist</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1311</span>:                                   <span class="n">DTYPE_F64_t</span> <span class="n">hole_radius</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1312</span>:                                   <span class="n">DTYPE_B_t</span><span class="p">[:,:]</span> <span class="n">mask</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1313</span>:                                   <span class="n">DTYPE_INT32_t</span> <span class="n">mask_resolution</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1314</span>:                                   <span class="n">DTYPE_F64_t</span> <span class="n">min_dist</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1315</span>:                                   <span class="n">DTYPE_F64_t</span> <span class="n">max_dist</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1316</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1317</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_B_t</span> <span class="nf">discard</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1318</span>:     <span class="k">cdef</span> <span class="kt">DTYPE_F64_t</span> <span class="nf">check_dist</span> <span class="o">=</span> <span class="n">hole_radius</span><span class="o">*</span><span class="n">hole_radial_mask_check_dist</span></pre>
<pre class='cython code score-0 '>  __pyx_v_check_dist = (__pyx_v_hole_radius * __pyx_v_hole_radial_mask_check_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1319</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1320</span>:     <span class="c">#Positive X direction</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1321</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">check_dist</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_3 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_4 * __pyx_v_temp_coordinates.strides[1]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_1 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_2 * __pyx_v_coordinates.strides[1]) ))) + __pyx_v_check_dist);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1322</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  __pyx_t_1 = 1;
  __pyx_t_4 = 0;
  __pyx_t_3 = 1;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_4 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_3 * __pyx_v_temp_coordinates.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_2 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_1 * __pyx_v_coordinates.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1323</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 2;
  __pyx_t_3 = 0;
  __pyx_t_4 = 2;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_3 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_4 * __pyx_v_temp_coordinates.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_1 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_2 * __pyx_v_coordinates.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1324</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1325</span>:     <span class="n">discard</span> <span class="o">=</span> <span class="n">not_in_mask</span><span class="p">(</span><span class="n">temp_coordinates</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">mask_resolution</span><span class="p">,</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_discard = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_not_in_mask(__pyx_v_temp_coordinates, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1326</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1327</span>:     <span class="k">if</span> <span class="n">discard</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_discard != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1328</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1329</span>:         <span class="k">return</span> <span class="n">discard</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_discard;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1330</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1331</span>:     <span class="c">#Negative X direction</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1332</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">check_dist</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_4 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_3 * __pyx_v_temp_coordinates.strides[1]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_2 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_1 * __pyx_v_coordinates.strides[1]) ))) - __pyx_v_check_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1333</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1334</span>:     <span class="n">discard</span> <span class="o">=</span> <span class="n">not_in_mask</span><span class="p">(</span><span class="n">temp_coordinates</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">mask_resolution</span><span class="p">,</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_discard = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_not_in_mask(__pyx_v_temp_coordinates, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1335</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1336</span>:     <span class="k">if</span> <span class="n">discard</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_discard != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1337</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1338</span>:         <span class="k">return</span> <span class="n">discard</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_discard;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1339</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1340</span>:     <span class="c">#Positive Y direction</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1341</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">0</span><span class="p">]</span> <span class="c">#reset X</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_3 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_4 * __pyx_v_temp_coordinates.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_1 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_2 * __pyx_v_coordinates.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1342</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">check_dist</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  __pyx_t_1 = 1;
  __pyx_t_4 = 0;
  __pyx_t_3 = 1;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_4 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_3 * __pyx_v_temp_coordinates.strides[1]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_2 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_1 * __pyx_v_coordinates.strides[1]) ))) + __pyx_v_check_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1343</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1344</span>:     <span class="n">discard</span> <span class="o">=</span> <span class="n">not_in_mask</span><span class="p">(</span><span class="n">temp_coordinates</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">mask_resolution</span><span class="p">,</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_discard = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_not_in_mask(__pyx_v_temp_coordinates, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1345</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1346</span>:     <span class="k">if</span> <span class="n">discard</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_discard != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1347</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1348</span>:         <span class="k">return</span> <span class="n">discard</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_discard;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1349</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1350</span>:     <span class="c">#Negative Y direction</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1351</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">check_dist</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 1;
  __pyx_t_3 = 0;
  __pyx_t_4 = 1;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_3 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_4 * __pyx_v_temp_coordinates.strides[1]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_1 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_2 * __pyx_v_coordinates.strides[1]) ))) - __pyx_v_check_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1352</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1353</span>:     <span class="n">discard</span> <span class="o">=</span> <span class="n">not_in_mask</span><span class="p">(</span><span class="n">temp_coordinates</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">mask_resolution</span><span class="p">,</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_discard = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_not_in_mask(__pyx_v_temp_coordinates, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1354</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1355</span>:     <span class="k">if</span> <span class="n">discard</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_discard != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1356</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1357</span>:         <span class="k">return</span> <span class="n">discard</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_discard;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1358</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1359</span>:     <span class="c">#Positive Z direction</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1360</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">1</span><span class="p">]</span> <span class="c">#reset Y</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  __pyx_t_1 = 1;
  __pyx_t_4 = 0;
  __pyx_t_3 = 1;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_4 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_3 * __pyx_v_temp_coordinates.strides[1]) )) = (*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_2 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_1 * __pyx_v_coordinates.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1361</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">check_dist</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_t_2 = 2;
  __pyx_t_3 = 0;
  __pyx_t_4 = 2;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_3 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_4 * __pyx_v_temp_coordinates.strides[1]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_1 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_2 * __pyx_v_coordinates.strides[1]) ))) + __pyx_v_check_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1362</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1363</span>:     <span class="n">discard</span> <span class="o">=</span> <span class="n">not_in_mask</span><span class="p">(</span><span class="n">temp_coordinates</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">mask_resolution</span><span class="p">,</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_discard = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_not_in_mask(__pyx_v_temp_coordinates, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1364</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1365</span>:     <span class="k">if</span> <span class="n">discard</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_discard != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1366</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1367</span>:         <span class="k">return</span> <span class="n">discard</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_discard;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1368</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1369</span>:     <span class="c">#Negative Z direction</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1370</span>:     <span class="n">temp_coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">check_dist</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = 0;
  __pyx_t_1 = 2;
  __pyx_t_4 = 0;
  __pyx_t_3 = 2;
  *((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_temp_coordinates.data + __pyx_t_4 * __pyx_v_temp_coordinates.strides[0]) ) + __pyx_t_3 * __pyx_v_temp_coordinates.strides[1]) )) = ((*((__pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coordinates.data + __pyx_t_2 * __pyx_v_coordinates.strides[0]) ) + __pyx_t_1 * __pyx_v_coordinates.strides[1]) ))) - __pyx_v_check_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1371</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1372</span>:     <span class="n">discard</span> <span class="o">=</span> <span class="n">not_in_mask</span><span class="p">(</span><span class="n">temp_coordinates</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">mask_resolution</span><span class="p">,</span> <span class="n">min_dist</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_discard = __pyx_f_4vast_10voidfinder_28_voidfinder_cython_find_next_not_in_mask(__pyx_v_temp_coordinates, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist);
</pre><pre class="cython line score-0">&#xA0;<span class="">1373</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1374</span>:     <span class="k">if</span> <span class="n">discard</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_discard != 0);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1375</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1376</span>:         <span class="k">return</span> <span class="n">discard</span></pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_discard;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1377</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1378</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1379</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1380</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1381</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1382</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1383</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1384</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1385</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1386</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1387</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-158" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1388</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">main_algorithm_geometric</span><span class="p">(</span><span class="n">DTYPE_INT64_t</span><span class="p">[:,:]</span> <span class="n">i_j_k_array</span><span class="p">,</span></pre>
<pre class='cython code score-158 '>static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_9main_algorithm_geometric(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_4vast_10voidfinder_18_voidfinder_cython_main_algorithm_geometric(CYTHON_UNUSED __Pyx_memviewslice __pyx_v_i_j_k_array, CYTHON_UNUSED PyObject *__pyx_v_galaxy_tree, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_w_coord, CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dl, CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dr, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_coord_min, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_mask, CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT32_t __pyx_v_mask_resolution, CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_dist, CYTHON_UNUSED __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_max_dist, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_return_array, CYTHON_UNUSED int __pyx_v_verbose, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_PROFILE_ARRAY, CYTHON_UNUSED int __pyx_skip_dispatch) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("main_algorithm_geometric", 0);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_9main_algorithm_geometric(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_4vast_10voidfinder_18_voidfinder_cython_8main_algorithm_geometric[] = "\n    Like to attempt writing a new main_algorithm which is based around finding\n    the neighbors without a bunch of successive radius queries\n    \n    Find neighbor 1 same way - nearest neighbor query.  Now you have a\n    Line of Motion from neighbor 1, through the cell center with an orientation\n    \n    Find 2 arbitrary vectors in the plane to define the plane, then find the first\n    neighbor on the cell center's side of the the plane (hard part, maybe a bunch of k=50 queries)\n     now do 1 radius query using the calculated center on line of motion so that the sphere\n     passes through both the Line of Motion and the neighbor 1 and the new potential neighbor 2\n     to verify that it actually is neighbor 2, and repeat the plane-search process to finde neighbor 3 and 4\n     \n    One way to find which side of a plane a point is on is here:\n    https://math.stackexchange.com/questions/214187/point-on-the-left-or-right-side-of-a-plane-in-3d-space\n    ";
static PyObject *__pyx_pw_4vast_10voidfinder_18_voidfinder_cython_9main_algorithm_geometric(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_i_j_k_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_galaxy_tree = 0;
  __Pyx_memviewslice __pyx_v_w_coord = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dl;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dr;
  __Pyx_memviewslice __pyx_v_coord_min = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_mask = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT32_t __pyx_v_mask_resolution;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_dist;
  __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_max_dist;
  __Pyx_memviewslice __pyx_v_return_array = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_verbose;
  __Pyx_memviewslice __pyx_v_PROFILE_ARRAY = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("main_algorithm_geometric (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_i_j_k_array,&amp;__pyx_n_s_galaxy_tree,&amp;__pyx_n_s_w_coord,&amp;__pyx_n_s_dl,&amp;__pyx_n_s_dr,&amp;__pyx_n_s_coord_min,&amp;__pyx_n_s_mask,&amp;__pyx_n_s_mask_resolution,&amp;__pyx_n_s_min_dist,&amp;__pyx_n_s_max_dist,&amp;__pyx_n_s_return_array,&amp;__pyx_n_s_verbose,&amp;__pyx_n_s_PROFILE_ARRAY,0};
    PyObject* values[13] = {0,0,0,0,0,0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_i_j_k_array)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_galaxy_tree)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 1); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_w_coord)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 2); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dl)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 3); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dr)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 4); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_coord_min)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 5); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mask)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 6); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mask_resolution)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 7); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_dist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 8); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_dist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 9); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (likely((values[10] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_return_array)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 10); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (likely((values[11] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_verbose)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 11); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (likely((values[12] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_PROFILE_ARRAY)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, 12); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "main_algorithm_geometric") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 13) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
      values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
      values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
      values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
      values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
      values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
    }
    __pyx_v_i_j_k_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT64_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_i_j_k_array.memview)) __PYX_ERR(0, 1388, __pyx_L3_error)</span>
    __pyx_v_galaxy_tree = values[1];
    __pyx_v_w_coord = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_w_coord.memview)) __PYX_ERR(0, 1390, __pyx_L3_error)</span>
    __pyx_v_dl = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_dl == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1391, __pyx_L3_error)</span>
    __pyx_v_dr = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_dr == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1392, __pyx_L3_error)</span>
    __pyx_v_coord_min = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_coord_min.memview)) __PYX_ERR(0, 1393, __pyx_L3_error)</span>
    __pyx_v_mask = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_B_t(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_mask.memview)) __PYX_ERR(0, 1394, __pyx_L3_error)</span>
    __pyx_v_mask_resolution = __Pyx_PyInt_As_npy_int32(values[7]); if (unlikely((__pyx_v_mask_resolution == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1395, __pyx_L3_error)</span>
    __pyx_v_min_dist = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[8]); if (unlikely((__pyx_v_min_dist == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1396, __pyx_L3_error)</span>
    __pyx_v_max_dist = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[9]); if (unlikely((__pyx_v_max_dist == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1397, __pyx_L3_error)</span>
    __pyx_v_return_array = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t(values[10], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_return_array.memview)) __PYX_ERR(0, 1398, __pyx_L3_error)</span>
    __pyx_v_verbose = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[11]); if (unlikely((__pyx_v_verbose == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1399, __pyx_L3_error)</span>
    __pyx_v_PROFILE_ARRAY = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F32_t(values[12], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_PROFILE_ARRAY.memview)) __PYX_ERR(0, 1400, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("main_algorithm_geometric", 1, 13, 13, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.main_algorithm_geometric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4vast_10voidfinder_18_voidfinder_cython_8main_algorithm_geometric(__pyx_self, __pyx_v_i_j_k_array, __pyx_v_galaxy_tree, __pyx_v_w_coord, __pyx_v_dl, __pyx_v_dr, __pyx_v_coord_min, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist, __pyx_v_return_array, __pyx_v_verbose, __pyx_v_PROFILE_ARRAY);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4vast_10voidfinder_18_voidfinder_cython_8main_algorithm_geometric(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_i_j_k_array, PyObject *__pyx_v_galaxy_tree, __Pyx_memviewslice __pyx_v_w_coord, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dl, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_dr, __Pyx_memviewslice __pyx_v_coord_min, __Pyx_memviewslice __pyx_v_mask, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_INT32_t __pyx_v_mask_resolution, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_min_dist, __pyx_t_4vast_10voidfinder_8typedefs_DTYPE_F64_t __pyx_v_max_dist, __Pyx_memviewslice __pyx_v_return_array, int __pyx_v_verbose, __Pyx_memviewslice __pyx_v_PROFILE_ARRAY) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("main_algorithm_geometric", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_i_j_k_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("i_j_k_array"); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_w_coord.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("w_coord"); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_coord_min.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("coord_min"); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_mask.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("mask"); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_return_array.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("return_array"); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_PROFILE_ARRAY.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("PROFILE_ARRAY"); <span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_4vast_10voidfinder_18_voidfinder_cython_main_algorithm_geometric(__pyx_v_i_j_k_array, __pyx_v_galaxy_tree, __pyx_v_w_coord, __pyx_v_dl, __pyx_v_dr, __pyx_v_coord_min, __pyx_v_mask, __pyx_v_mask_resolution, __pyx_v_min_dist, __pyx_v_max_dist, __pyx_v_return_array, __pyx_v_verbose, __pyx_v_PROFILE_ARRAY, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("vast.voidfinder._voidfinder_cython.main_algorithm_geometric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_i_j_k_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_w_coord, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_coord_min, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mask, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_return_array, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_PROFILE_ARRAY, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1389</span>:                                     <span class="n">galaxy_tree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1390</span>:                                     <span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">w_coord</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1391</span>:                                     <span class="n">DTYPE_F64_t</span> <span class="n">dl</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1392</span>:                                     <span class="n">DTYPE_F64_t</span> <span class="n">dr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1393</span>:                                     <span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">coord_min</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1394</span>:                                     <span class="n">DTYPE_B_t</span><span class="p">[:,:]</span> <span class="n">mask</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1395</span>:                                     <span class="n">DTYPE_INT32_t</span> <span class="n">mask_resolution</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1396</span>:                                     <span class="n">DTYPE_F64_t</span> <span class="n">min_dist</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1397</span>:                                     <span class="n">DTYPE_F64_t</span> <span class="n">max_dist</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1398</span>:                                     <span class="n">DTYPE_F64_t</span><span class="p">[:,:]</span> <span class="n">return_array</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1399</span>:                                     <span class="nb">int</span> <span class="n">verbose</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1400</span>:                                     <span class="n">DTYPE_F32_t</span><span class="p">[:,:]</span> <span class="n">PROFILE_ARRAY</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1401</span>:                                     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1402</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1403</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1404</span>: <span class="sd">    Like to attempt writing a new main_algorithm which is based around finding</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1405</span>: <span class="sd">    the neighbors without a bunch of successive radius queries</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1406</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1407</span>: <span class="sd">    Find neighbor 1 same way - nearest neighbor query.  Now you have a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1408</span>: <span class="sd">    Line of Motion from neighbor 1, through the cell center with an orientation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1409</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>: <span class="sd">    Find 2 arbitrary vectors in the plane to define the plane, then find the first</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1411</span>: <span class="sd">    neighbor on the cell center&#39;s side of the the plane (hard part, maybe a bunch of k=50 queries)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1412</span>: <span class="sd">     now do 1 radius query using the calculated center on line of motion so that the sphere</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>: <span class="sd">     passes through both the Line of Motion and the neighbor 1 and the new potential neighbor 2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1414</span>: <span class="sd">     to verify that it actually is neighbor 2, and repeat the plane-search process to finde neighbor 3 and 4</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1415</span>: <span class="sd">     </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1416</span>: <span class="sd">    One way to find which side of a plane a point is on is here:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1417</span>: <span class="sd">    https://math.stackexchange.com/questions/214187/point-on-the-left-or-right-side-of-a-plane-in-3d-space</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1418</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1419</span>:     <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1421</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1422</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1423</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1424</span>: </pre>
</div></body></html>
